<!-- build time:Fri Jul 21 2023 15:15:39 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://sirliu.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://sirliu.github.io/atom.xml"><link rel="alternate" type="application/json" href="https://sirliu.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CMicrosoft%20YaHei:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://sirliu.github.io/2022/10/NaiveProxy%E6%90%AD%E5%BB%BA/"><title>NaiveProxy搭建 | Black Elk = = 潛龍勿用</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">NaiveProxy搭建</h1><div class="meta"><span class="item" title="创建时间：2022-10-29 10:53:31"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-10-29T10:53:31+08:00">2022-10-29</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>15k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>14 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Black Elk</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/170567/6/22466/1714395/614f2db3E33406bd3/9a01b2539eaf7357.jpg"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/207533/4/2248/10415466/614f2394E02548777/5d0429f1fb4916fc.png"></li><li class="item" data-background-image="https://images.pexels.com/photos/414144/pexels-photo-414144.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/93411/7/18821/6665960/614f24c8Ed09e207b/ecb39c9fa82231a3.jpg"></li><li class="item" data-background-image="https://images.pexels.com/photos/416676/pexels-photo-416676.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/120827/19/19122/5213873/614f2151E77f4c342/18fd67a0c5a0df61.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://sirliu.github.io/2022/10/NaiveProxy%E6%90%AD%E5%BB%BA/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="黑麋鹿"><meta itemprop="description" content="潛龍勿用, 折腾之路"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><p>一键脚本地址：<br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ltYWplYXNvbi9uYXNfdG9vbHMvYmxvYi9tYWluL05haXZlUHJveHkvaW5zdGFsbC5zaA==">https://github.com/imajeason/nas_tools/blob/main/NaiveProxy/install.sh</span><br>防走失备份如下：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token shebang important">#!/bin/bash</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">red</span><span class="token operator">=</span><span class="token string">'\e[91m'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">green</span><span class="token operator">=</span><span class="token string">'\e[92m'</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">yellow</span><span class="token operator">=</span><span class="token string">'\e[93m'</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token assign-left variable">magenta</span><span class="token operator">=</span><span class="token string">'\e[95m'</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token assign-left variable">cyan</span><span class="token operator">=</span><span class="token string">'\e[96m'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token assign-left variable">none</span><span class="token operator">=</span><span class="token string">'\e[0m'</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token function-name function">_red</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin class-name">echo</span> -e <span class="token variable">$&#123;red&#125;</span><span class="token variable">$*</span><span class="token variable">$&#123;none&#125;</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token function-name function">_green</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin class-name">echo</span> -e <span class="token variable">$&#123;green&#125;</span><span class="token variable">$*</span><span class="token variable">$&#123;none&#125;</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token function-name function">_yellow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin class-name">echo</span> -e <span class="token variable">$&#123;yellow&#125;</span><span class="token variable">$*</span><span class="token variable">$&#123;none&#125;</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token function-name function">_magenta</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin class-name">echo</span> -e <span class="token variable">$&#123;magenta&#125;</span><span class="token variable">$*</span><span class="token variable">$&#123;none&#125;</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function-name function">_cyan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin class-name">echo</span> -e <span class="token variable">$&#123;cyan&#125;</span><span class="token variable">$*</span><span class="token variable">$&#123;none&#125;</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># Root</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token entity" title="\n">\n</span> 哎呀……请使用 <span class="token variable">$&#123;red&#125;</span>root <span class="token variable">$&#123;none&#125;</span>用户运行 <span class="token variable">$&#123;yellow&#125;</span>~(^_^) <span class="token variable">$&#123;none&#125;</span><span class="token entity" title="\n">\n</span>"</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"apt-get"</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token assign-left variable">sys_bit</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">uname</span> -m<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">case</span> <span class="token variable">$sys_bit</span> <span class="token keyword">in</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment"># i[36]86)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment">#     v2ray_bit="32"</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">#     caddy_arch="386"</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">#     ;;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token string">'amd64'</span> <span class="token operator">|</span> x86_64<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token assign-left variable">v2ray_bit</span><span class="token operator">=</span><span class="token string">"64"</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token assign-left variable">caddy_arch</span><span class="token operator">=</span><span class="token string">"amd64"</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment"># *armv6*)</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">#     v2ray_bit="arm32-v6"</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">#     caddy_arch="arm6"</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">#     ;;</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment"># *armv7*)</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">#     v2ray_bit="arm32-v7a"</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment">#     caddy_arch="arm7"</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">#     ;;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>*aarch64* <span class="token operator">|</span> *armv8*<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token assign-left variable">v2ray_bit</span><span class="token operator">=</span><span class="token string">"arm64-v8a"</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token assign-left variable">caddy_arch</span><span class="token operator">=</span><span class="token string">"arm64"</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>*<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">" </span></pre></td></tr><tr><td data-num="45"></td><td><pre>    哈哈……这个 <span class="token variable">$&#123;red&#125;</span>辣鸡脚本<span class="token variable">$&#123;none&#125;</span> 不支持你的系统。 <span class="token variable">$&#123;yellow&#125;</span>(-_-) <span class="token variable">$&#123;none&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>    备注: 仅支持 Ubuntu 16+ / Debian 8+ / CentOS 7+ 系统</pre></td></tr><tr><td data-num="48"></td><td><pre>    " <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">esac</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token comment"># 笨笨的检测方法</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v <span class="token function">apt-get</span><span class="token variable">)</span></span> <span class="token operator">||</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v yum<span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v systemctl<span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v yum<span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token assign-left variable">cmd</span><span class="token operator">=</span><span class="token string">"yum"</span></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v <span class="token function">apt-get</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token function">apt-get</span> update -y</pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">curl</span> -y</pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token keyword">else</span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">" </span></pre></td></tr><tr><td data-num="70"></td><td><pre>    哈哈……这个 <span class="token variable">$&#123;red&#125;</span>辣鸡脚本<span class="token variable">$&#123;none&#125;</span> 不支持你的系统。 <span class="token variable">$&#123;yellow&#125;</span>(-_-) <span class="token variable">$&#123;none&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre></pre></td></tr><tr><td data-num="72"></td><td><pre>    备注: 仅支持 Ubuntu 16+ / Debian 8+ / CentOS 7+ 系统</pre></td></tr><tr><td data-num="73"></td><td><pre>    " <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token keyword">fi</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token assign-left variable">uuid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /proc/sys/kernel/random/uuid<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token assign-left variable">systemd</span><span class="token operator">=</span>true</pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token comment"># _test=true</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token function-name function">_sys_timezone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token assign-left variable">IS_OPENVZ</span><span class="token operator">=</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token keyword">if</span> hostnamectl status <span class="token operator">|</span> <span class="token function">grep</span> -q openvz<span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        <span class="token assign-left variable">IS_OPENVZ</span><span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="85"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="86"></td><td><pre></pre></td></tr><tr><td data-num="87"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    timedatectl set-timezone Asia/Shanghai</pre></td></tr><tr><td data-num="89"></td><td><pre>    timedatectl set-ntp <span class="token boolean">true</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"已将你的主机设置为Asia/Shanghai时区并通过systemd-timesyncd自动同步时间。"</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="92"></td><td><pre></pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$IS_OPENVZ</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"你的主机环境为 <span class="token variable">$&#123;yellow&#125;</span>Openvz<span class="token variable">$&#123;none&#125;</span> ，建议使用<span class="token variable">$&#123;yellow&#125;</span>v2ray mkcp<span class="token variable">$&#123;none&#125;</span>系列协议。"</span></pre></td></tr><tr><td data-num="96"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"注意：<span class="token variable">$&#123;yellow&#125;</span>Openvz<span class="token variable">$&#123;none&#125;</span> 系统时间无法由虚拟机内程序控制同步。"</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"如果主机时间跟实际相差<span class="token variable">$&#123;yellow&#125;</span>超过90秒<span class="token variable">$&#123;none&#125;</span>，v2ray将无法正常通信，请发ticket联系vps主机商调整。"</span></pre></td></tr><tr><td data-num="98"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="100"></td><td><pre></pre></td></tr><tr><td data-num="101"></td><td><pre><span class="token function-name function">_sys_time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token entity" title="\n">\n</span>主机时间：<span class="token variable">$&#123;yellow&#125;</span>"</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    timedatectl status <span class="token operator">|</span> <span class="token function">sed</span> -n <span class="token string">'1p;4p'</span></pre></td></tr><tr><td data-num="104"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token variable">$&#123;none&#125;</span>"</span></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$IS_OPENV</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> pause</pre></td></tr><tr><td data-num="106"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="107"></td><td><pre></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token function-name function">naive_config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="109"></td><td><pre></pre></td></tr><tr><td data-num="110"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="111"></td><td><pre></pre></td></tr><tr><td data-num="112"></td><td><pre>    <span class="token keyword">while</span> <span class="token builtin class-name">:</span><span class="token punctuation">;</span> <span class="token keyword">do</span></pre></td></tr><tr><td data-num="113"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"请输入 "</span><span class="token variable">$yellow</span><span class="token string">"NaiveProxy"</span><span class="token variable">$none</span><span class="token string">" 端口 ["</span><span class="token variable">$magenta</span><span class="token string">"1-65535"</span><span class="token variable">$none</span><span class="token string">"]，不能选择 "</span><span class="token variable">$magenta</span><span class="token string">"80"</span><span class="token variable">$none</span><span class="token string">"端口"</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token builtin class-name">read</span> -p <span class="token string">"$(echo -e "(默认端口: <span class="token variable">$&#123;cyan&#125;</span>443<span class="token variable">$none</span>):"</span><span class="token punctuation">)</span><span class="token string">" naive_port</span></pre></td></tr><tr><td data-num="115"></td><td><pre>        [ -z "<span class="token variable">$naive_port</span><span class="token string">" ] &amp;&amp; naive_port=443</span></pre></td></tr><tr><td data-num="116"></td><td><pre>        case <span class="token variable">$naive_port</span> in</pre></td></tr><tr><td data-num="117"></td><td><pre>        80)</pre></td></tr><tr><td data-num="118"></td><td><pre>            echo</pre></td></tr><tr><td data-num="119"></td><td><pre>            echo " <span class="token punctuation">..</span>.都说了不能选择 <span class="token number">80</span> 端口了咯<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token string">"</span></pre></td></tr><tr><td data-num="120"></td><td><pre>            error</pre></td></tr><tr><td data-num="121"></td><td><pre>            ;;</pre></td></tr><tr><td data-num="122"></td><td><pre>        [1-9] | [1-9][0-9] | [1-9][0-9][0-9] | [1-9][0-9][0-9][0-9] | [1-5][0-9][0-9][0-9][0-9] | 6[0-4][0-9][0-9][0-9] | 65[0-4][0-9][0-9] | 655[0-3][0-5])</pre></td></tr><tr><td data-num="123"></td><td><pre>            echo</pre></td></tr><tr><td data-num="124"></td><td><pre>            echo</pre></td></tr><tr><td data-num="125"></td><td><pre>            echo -e "<span class="token variable">$yellow</span> naive_port 端口 <span class="token operator">=</span> <span class="token variable">$cyan</span><span class="token variable">$naive_port</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="126"></td><td><pre>            echo "----------------------------------------------------------------<span class="token string">"</span></pre></td></tr><tr><td data-num="127"></td><td><pre>            echo</pre></td></tr><tr><td data-num="128"></td><td><pre>            break</pre></td></tr><tr><td data-num="129"></td><td><pre>            ;;</pre></td></tr><tr><td data-num="130"></td><td><pre>        *)</pre></td></tr><tr><td data-num="131"></td><td><pre>            error</pre></td></tr><tr><td data-num="132"></td><td><pre>            ;;</pre></td></tr><tr><td data-num="133"></td><td><pre>        esac</pre></td></tr><tr><td data-num="134"></td><td><pre>    done</pre></td></tr><tr><td data-num="135"></td><td><pre></pre></td></tr><tr><td data-num="136"></td><td><pre>    while :; do</pre></td></tr><tr><td data-num="137"></td><td><pre>        echo</pre></td></tr><tr><td data-num="138"></td><td><pre>        echo -e "请输入一个 <span class="token variable">$&#123;magenta&#125;</span>正确的域名<span class="token variable">$&#123;none&#125;</span>，一定一定一定要正确，不！能！出！错！<span class="token string">"</span></pre></td></tr><tr><td data-num="139"></td><td><pre>        read -p "<span class="token punctuation">(</span>例如：n.abc.com<span class="token punctuation">)</span>: <span class="token string">" domain</span></pre></td></tr><tr><td data-num="140"></td><td><pre>        [ -z "<span class="token variable">$domain</span><span class="token string">" ] &amp;&amp; error &amp;&amp; continue</span></pre></td></tr><tr><td data-num="141"></td><td><pre>        echo</pre></td></tr><tr><td data-num="142"></td><td><pre>        echo</pre></td></tr><tr><td data-num="143"></td><td><pre>        echo -e "<span class="token variable">$yellow</span> 你的域名 <span class="token operator">=</span> <span class="token variable">$cyan</span><span class="token variable">$domain</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="144"></td><td><pre>        echo "----------------------------------------------------------------<span class="token string">"</span></pre></td></tr><tr><td data-num="145"></td><td><pre>        break</pre></td></tr><tr><td data-num="146"></td><td><pre>    done</pre></td></tr><tr><td data-num="147"></td><td><pre>    </pre></td></tr><tr><td data-num="148"></td><td><pre>    while :; do</pre></td></tr><tr><td data-num="149"></td><td><pre>        echo</pre></td></tr><tr><td data-num="150"></td><td><pre>        echo -e "请输入一个 <span class="token variable">$&#123;magenta&#125;</span>邮箱<span class="token variable">$&#123;none&#125;</span>，邮箱不能乱输，格式要对。<span class="token string">"</span></pre></td></tr><tr><td data-num="151"></td><td><pre>        read -p "<span class="token punctuation">(</span>例如：name@abc.com<span class="token punctuation">)</span>: <span class="token string">" email</span></pre></td></tr><tr><td data-num="152"></td><td><pre>        [ -z "<span class="token variable">$email</span><span class="token string">" ] &amp;&amp; error &amp;&amp; continue</span></pre></td></tr><tr><td data-num="153"></td><td><pre>        echo</pre></td></tr><tr><td data-num="154"></td><td><pre>        echo</pre></td></tr><tr><td data-num="155"></td><td><pre>        echo -e "<span class="token variable">$yellow</span> 你的邮箱 <span class="token operator">=</span> <span class="token variable">$cyan</span><span class="token variable">$email</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        echo "----------------------------------------------------------------<span class="token string">"</span></pre></td></tr><tr><td data-num="157"></td><td><pre>        break</pre></td></tr><tr><td data-num="158"></td><td><pre>    done</pre></td></tr><tr><td data-num="159"></td><td><pre>    get_ip</pre></td></tr><tr><td data-num="160"></td><td><pre>    echo</pre></td></tr><tr><td data-num="161"></td><td><pre>    echo</pre></td></tr><tr><td data-num="162"></td><td><pre>    echo -e "<span class="token variable">$yellow</span> 请将 <span class="token variable">$magenta</span><span class="token variable">$domain</span><span class="token variable">$none</span> <span class="token variable">$yellow</span> 解析到: <span class="token variable">$cyan</span><span class="token variable">$ip</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="163"></td><td><pre>    echo</pre></td></tr><tr><td data-num="164"></td><td><pre>    echo -e "<span class="token variable">$yellow</span> 请将 <span class="token variable">$magenta</span><span class="token variable">$domain</span><span class="token variable">$none</span> <span class="token variable">$yellow</span> 解析到: <span class="token variable">$cyan</span><span class="token variable">$ip</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="165"></td><td><pre>    echo</pre></td></tr><tr><td data-num="166"></td><td><pre>    echo -e "<span class="token variable">$yellow</span> 请将 <span class="token variable">$magenta</span><span class="token variable">$domain</span><span class="token variable">$none</span> <span class="token variable">$yellow</span> 解析到: <span class="token variable">$cyan</span><span class="token variable">$ip</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="167"></td><td><pre>    echo "----------------------------------------------------------------<span class="token string">"</span></pre></td></tr><tr><td data-num="168"></td><td><pre>    echo</pre></td></tr><tr><td data-num="169"></td><td><pre></pre></td></tr><tr><td data-num="170"></td><td><pre>    while :; do</pre></td></tr><tr><td data-num="171"></td><td><pre></pre></td></tr><tr><td data-num="172"></td><td><pre>        read -p "<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -e <span class="token string">"(是否已经正确解析: [<span class="token variable">$&#123;magenta&#125;</span>Y<span class="token variable">$none</span>]):"</span><span class="token variable">)</span></span> <span class="token string">" record</span></pre></td></tr><tr><td data-num="173"></td><td><pre>        if [[ -z "<span class="token variable">$record</span><span class="token string">" ]]; then</span></pre></td></tr><tr><td data-num="174"></td><td><pre>            error</pre></td></tr><tr><td data-num="175"></td><td><pre>        else</pre></td></tr><tr><td data-num="176"></td><td><pre>            if [[ "<span class="token variable">$record</span><span class="token string">" == [Yy] ]]; then</span></pre></td></tr><tr><td data-num="177"></td><td><pre>                domain_check</pre></td></tr><tr><td data-num="178"></td><td><pre>                echo</pre></td></tr><tr><td data-num="179"></td><td><pre>                echo</pre></td></tr><tr><td data-num="180"></td><td><pre>                echo -e "<span class="token variable">$yellow</span> 域名解析 <span class="token operator">=</span> <span class="token variable">$&#123;cyan&#125;</span>我确定已经有解析了<span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="181"></td><td><pre>                echo "----------------------------------------------------------------<span class="token string">"</span></pre></td></tr><tr><td data-num="182"></td><td><pre>                echo</pre></td></tr><tr><td data-num="183"></td><td><pre>                break</pre></td></tr><tr><td data-num="184"></td><td><pre>            else</pre></td></tr><tr><td data-num="185"></td><td><pre>                error</pre></td></tr><tr><td data-num="186"></td><td><pre>            fi</pre></td></tr><tr><td data-num="187"></td><td><pre>        fi</pre></td></tr><tr><td data-num="188"></td><td><pre></pre></td></tr><tr><td data-num="189"></td><td><pre>    done</pre></td></tr><tr><td data-num="190"></td><td><pre></pre></td></tr><tr><td data-num="191"></td><td><pre>&#125;</pre></td></tr><tr><td data-num="192"></td><td><pre></pre></td></tr><tr><td data-num="193"></td><td><pre></pre></td></tr><tr><td data-num="194"></td><td><pre>install_info() &#123;</pre></td></tr><tr><td data-num="195"></td><td><pre>    clear</pre></td></tr><tr><td data-num="196"></td><td><pre>    echo</pre></td></tr><tr><td data-num="197"></td><td><pre>    echo " <span class="token punctuation">..</span><span class="token punctuation">..</span>准备安装了咯<span class="token punctuation">..</span>看看有毛有配置正确了<span class="token punctuation">..</span>.<span class="token string">"</span></pre></td></tr><tr><td data-num="198"></td><td><pre>    echo</pre></td></tr><tr><td data-num="199"></td><td><pre>    echo "---------- 安装信息 -------------<span class="token string">"</span></pre></td></tr><tr><td data-num="200"></td><td><pre>    echo</pre></td></tr><tr><td data-num="201"></td><td><pre>    echo -e "<span class="token variable">$yellow</span> NaiveProxy 端口 <span class="token operator">=</span> <span class="token variable">$cyan</span><span class="token variable">$naive_port</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="202"></td><td><pre>    echo</pre></td></tr><tr><td data-num="203"></td><td><pre>    echo -e "<span class="token variable">$yellow</span> 你的域名 <span class="token operator">=</span> <span class="token variable">$cyan</span><span class="token variable">$domain</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="204"></td><td><pre>    echo</pre></td></tr><tr><td data-num="205"></td><td><pre>    echo -e "<span class="token variable">$yellow</span> 域名解析 <span class="token operator">=</span> <span class="token variable">$&#123;cyan&#125;</span>我确定已经有解析了<span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="206"></td><td><pre>    echo</pre></td></tr><tr><td data-num="207"></td><td><pre>    echo -e "<span class="token variable">$yellow</span> 自动配置 TLS <span class="token operator">=</span> <span class="token variable">$cyan</span><span class="token variable">$install_caddy_info</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="208"></td><td><pre></pre></td></tr><tr><td data-num="209"></td><td><pre>    echo</pre></td></tr><tr><td data-num="210"></td><td><pre>    echo "---------- END -------------<span class="token string">"</span></pre></td></tr><tr><td data-num="211"></td><td><pre>    echo</pre></td></tr><tr><td data-num="212"></td><td><pre>    pause</pre></td></tr><tr><td data-num="213"></td><td><pre>    echo</pre></td></tr><tr><td data-num="214"></td><td><pre>&#125;</pre></td></tr><tr><td data-num="215"></td><td><pre></pre></td></tr><tr><td data-num="216"></td><td><pre>domain_check() &#123;</pre></td></tr><tr><td data-num="217"></td><td><pre>    # if [[ <span class="token variable">$cmd</span> == "yum<span class="token string">" ]]; then</span></pre></td></tr><tr><td data-num="218"></td><td><pre>    #     yum install bind-utils -y</pre></td></tr><tr><td data-num="219"></td><td><pre>    # else</pre></td></tr><tr><td data-num="220"></td><td><pre>    #     <span class="token variable">$cmd</span> install dnsutils -y</pre></td></tr><tr><td data-num="221"></td><td><pre>    # fi</pre></td></tr><tr><td data-num="222"></td><td><pre>    # test_domain=<span class="token variable"><span class="token variable">$(</span><span class="token function">dig</span> $domain +short<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="223"></td><td><pre>    # test_domain=$(ping <span class="token variable">$domain</span> -c 1 -4 | grep -oE -m1 "([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;"<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="224"></td><td><pre>    <span class="token comment"># test_domain=$(wget -qO- --header='accept: application/dns-json' "https://cloudflare-dns.com/dns-query?name=$domain&amp;type=A" | grep -oE "([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;" | head -1)</span></pre></td></tr><tr><td data-num="225"></td><td><pre>    <span class="token assign-left variable">test_domain</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -sH <span class="token string">'accept: application/dns-json'</span> <span class="token string">"https://cloudflare-dns.com/dns-query?name=<span class="token variable">$domain</span>&amp;type=A"</span> <span class="token operator">|</span> <span class="token function">grep</span> -oE <span class="token string">"([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;"</span> <span class="token operator">|</span> <span class="token function">head</span> -1<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="226"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$test_domain</span> <span class="token operator">!=</span> <span class="token variable">$ip</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="227"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="228"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token variable">$red</span> 检测域名解析错误....<span class="token variable">$none</span>"</span></pre></td></tr><tr><td data-num="229"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="230"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">" 你的域名: <span class="token variable">$yellow</span><span class="token variable">$domain</span><span class="token variable">$none</span> 未解析到: <span class="token variable">$cyan</span><span class="token variable">$ip</span><span class="token variable">$none</span>"</span></pre></td></tr><tr><td data-num="231"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="232"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">" 你的域名当前解析到: <span class="token variable">$cyan</span><span class="token variable">$test_domain</span><span class="token variable">$none</span>"</span></pre></td></tr><tr><td data-num="233"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="234"></td><td><pre>        <span class="token builtin class-name">echo</span> <span class="token string">"备注...如果你的域名是使用 Cloudflare 解析的话..在 Status 那里点一下那图标..让它变灰"</span></pre></td></tr><tr><td data-num="235"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="236"></td><td><pre>        <span class="token builtin class-name">exit</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="237"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="238"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="239"></td><td><pre></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token function-name function">install_go</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="241"></td><td><pre>    <span class="token builtin class-name">cd</span> /opt</pre></td></tr><tr><td data-num="242"></td><td><pre>    <span class="token function">rm</span> /opt/go1.19.linux-amd64.tar.gz -rf</pre></td></tr><tr><td data-num="243"></td><td><pre>    <span class="token function">wget</span> https://go.dev/dl/go1.19.linux-amd64.tar.gz</pre></td></tr><tr><td data-num="244"></td><td><pre>    <span class="token function">tar</span> -zxf go1.19.linux-amd64.tar.gz -C /usr/local/</pre></td></tr><tr><td data-num="245"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token builtin class-name">export</span> <span class="token assign-left variable">GOROOT</span><span class="token operator">=</span>/usr/local/go <span class="token operator">>></span> /etc/profile</pre></td></tr><tr><td data-num="246"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$GOROOT</span>/bin:<span class="token environment constant">$PATH</span> <span class="token operator">>></span> /etc/profile</pre></td></tr><tr><td data-num="247"></td><td><pre>    <span class="token builtin class-name">source</span> /etc/profile</pre></td></tr><tr><td data-num="248"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">GOROOT</span><span class="token operator">=</span>/usr/local/go</pre></td></tr><tr><td data-num="249"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$GOROOT</span>/bin:<span class="token environment constant">$PATH</span></pre></td></tr><tr><td data-num="250"></td><td><pre>    go version</pre></td></tr><tr><td data-num="251"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="252"></td><td><pre></pre></td></tr><tr><td data-num="253"></td><td><pre><span class="token function-name function">install_caddy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>    <span class="token comment"># download caddy file then install</span></pre></td></tr><tr><td data-num="255"></td><td><pre>    <span class="token function">mkdir</span> /root/src <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> /root/src/</pre></td></tr><tr><td data-num="256"></td><td><pre>    go <span class="token function">install</span> github.com/caddyserver/xcaddy/cmd/xcaddy@latest</pre></td></tr><tr><td data-num="257"></td><td><pre>    ~/go/bin/xcaddy build --with github.com/caddyserver/forwardproxy@caddy2<span class="token operator">=</span>github.com/klzgrad/forwardproxy@naive</pre></td></tr><tr><td data-num="258"></td><td><pre>    <span class="token function">cp</span> caddy /usr/bin/</pre></td></tr><tr><td data-num="259"></td><td><pre>    /usr/bin/caddy version        <span class="token comment"># 2022-4-8 23:09</span></pre></td></tr><tr><td data-num="260"></td><td><pre>    <span class="token comment">#v2.4.6 h1:HGkGICFGvyrodcqOOclHKfvJC0qTU7vny/7FhYp9hNw=  </span></pre></td></tr><tr><td data-num="261"></td><td><pre>    setcap <span class="token assign-left variable">cap_net_bind_service</span><span class="token operator">=</span>+ep /usr/bin/caddy  <span class="token comment"># 设置 bind 权限，可 443</span></pre></td></tr><tr><td data-num="262"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="263"></td><td><pre></pre></td></tr><tr><td data-num="264"></td><td><pre></pre></td></tr><tr><td data-num="265"></td><td><pre><span class="token function-name function">install_certbot</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="266"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$cmd</span> <span class="token operator">==</span> <span class="token string">"apt-get"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="267"></td><td><pre>        <span class="token variable">$cmd</span> <span class="token function">install</span> -y lrzsz <span class="token function">git</span> <span class="token function">zip</span> <span class="token function">unzip</span> <span class="token function">curl</span> <span class="token function">wget</span> qrencode libcap2-bin dbus <span class="token function">tar</span> </pre></td></tr><tr><td data-num="268"></td><td><pre>        <span class="token variable">$cmd</span> <span class="token function">install</span> -y certbot</pre></td></tr><tr><td data-num="269"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="270"></td><td><pre>        <span class="token comment"># $cmd install -y lrzsz git zip unzip curl wget qrencode libcap iptables-services</span></pre></td></tr><tr><td data-num="271"></td><td><pre>        <span class="token variable">$cmd</span> <span class="token function">install</span> -y lrzsz <span class="token function">git</span> <span class="token function">zip</span> <span class="token function">unzip</span> <span class="token function">curl</span> <span class="token function">wget</span> qrencode libcap epel-release <span class="token function">tar</span> openssl-devel ca-certificates</pre></td></tr><tr><td data-num="272"></td><td><pre>        <span class="token variable">$cmd</span> <span class="token function">install</span> -y certbot</pre></td></tr><tr><td data-num="273"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="274"></td><td><pre></pre></td></tr><tr><td data-num="275"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="276"></td><td><pre></pre></td></tr><tr><td data-num="277"></td><td><pre></pre></td></tr><tr><td data-num="278"></td><td><pre><span class="token function-name function">caddy_config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="279"></td><td><pre>    <span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token variable">$uuid</span></pre></td></tr><tr><td data-num="280"></td><td><pre></pre></td></tr><tr><td data-num="281"></td><td><pre>    <span class="token function">cat</span> <span class="token operator">></span> /etc/caddy/caddy_config.json <span class="token operator">&lt;&lt;</span> <span class="token string">EOF</span></pre></td></tr><tr><td data-num="282"></td><td><pre>&#123;</pre></td></tr><tr><td data-num="283"></td><td><pre>  "admin": &#123;</pre></td></tr><tr><td data-num="284"></td><td><pre>    "disabled": true</pre></td></tr><tr><td data-num="285"></td><td><pre>  &#125;,</pre></td></tr><tr><td data-num="286"></td><td><pre>  "apps": &#123;</pre></td></tr><tr><td data-num="287"></td><td><pre>    "http": &#123;</pre></td></tr><tr><td data-num="288"></td><td><pre>      "servers": &#123;</pre></td></tr><tr><td data-num="289"></td><td><pre>        "srv0": &#123;</pre></td></tr><tr><td data-num="290"></td><td><pre>          "listen": [</pre></td></tr><tr><td data-num="291"></td><td><pre>            ":<span class="token variable">$naive_port</span>"</pre></td></tr><tr><td data-num="292"></td><td><pre>          ],</pre></td></tr><tr><td data-num="293"></td><td><pre>          "routes": [</pre></td></tr><tr><td data-num="294"></td><td><pre>            &#123;</pre></td></tr><tr><td data-num="295"></td><td><pre>              "handle": [</pre></td></tr><tr><td data-num="296"></td><td><pre>                &#123;</pre></td></tr><tr><td data-num="297"></td><td><pre>                  "handler": "subroute",</pre></td></tr><tr><td data-num="298"></td><td><pre>                  "routes": [</pre></td></tr><tr><td data-num="299"></td><td><pre>                    &#123;</pre></td></tr><tr><td data-num="300"></td><td><pre>                      "handle": [</pre></td></tr><tr><td data-num="301"></td><td><pre>                        &#123;</pre></td></tr><tr><td data-num="302"></td><td><pre>                          "auth_user_deprecated": "User",</pre></td></tr><tr><td data-num="303"></td><td><pre>                          "auth_pass_deprecated": "<span class="token variable">$password</span>",</pre></td></tr><tr><td data-num="304"></td><td><pre>                          "handler": "forward_proxy",</pre></td></tr><tr><td data-num="305"></td><td><pre>                          "hide_ip": true,</pre></td></tr><tr><td data-num="306"></td><td><pre>                          "hide_via": true,</pre></td></tr><tr><td data-num="307"></td><td><pre>                          "probe_resistance": &#123;&#125;</pre></td></tr><tr><td data-num="308"></td><td><pre>                        &#125;</pre></td></tr><tr><td data-num="309"></td><td><pre>                      ]</pre></td></tr><tr><td data-num="310"></td><td><pre>                    &#125;,</pre></td></tr><tr><td data-num="311"></td><td><pre>                    &#123;</pre></td></tr><tr><td data-num="312"></td><td><pre>                      "match": [</pre></td></tr><tr><td data-num="313"></td><td><pre>                        &#123;</pre></td></tr><tr><td data-num="314"></td><td><pre>                          "host": [</pre></td></tr><tr><td data-num="315"></td><td><pre>                            "<span class="token variable">$domain</span>"</pre></td></tr><tr><td data-num="316"></td><td><pre>                          ]</pre></td></tr><tr><td data-num="317"></td><td><pre>                        &#125;</pre></td></tr><tr><td data-num="318"></td><td><pre>                      ],</pre></td></tr><tr><td data-num="319"></td><td><pre>                      "handle": [</pre></td></tr><tr><td data-num="320"></td><td><pre>                        &#123;</pre></td></tr><tr><td data-num="321"></td><td><pre>                          "handler": "file_server",</pre></td></tr><tr><td data-num="322"></td><td><pre>                          "root": "/var/www/html",</pre></td></tr><tr><td data-num="323"></td><td><pre>                          "index_names": [</pre></td></tr><tr><td data-num="324"></td><td><pre>                            "index.html"</pre></td></tr><tr><td data-num="325"></td><td><pre>                          ]</pre></td></tr><tr><td data-num="326"></td><td><pre>                        &#125;</pre></td></tr><tr><td data-num="327"></td><td><pre>                      ],</pre></td></tr><tr><td data-num="328"></td><td><pre>                      "terminal": true</pre></td></tr><tr><td data-num="329"></td><td><pre>                    &#125;</pre></td></tr><tr><td data-num="330"></td><td><pre>                  ]</pre></td></tr><tr><td data-num="331"></td><td><pre>                &#125;</pre></td></tr><tr><td data-num="332"></td><td><pre>              ]</pre></td></tr><tr><td data-num="333"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num="334"></td><td><pre>          ],</pre></td></tr><tr><td data-num="335"></td><td><pre>          "tls_connection_policies": [</pre></td></tr><tr><td data-num="336"></td><td><pre>            &#123;</pre></td></tr><tr><td data-num="337"></td><td><pre>              "match": &#123;</pre></td></tr><tr><td data-num="338"></td><td><pre>                "sni": [</pre></td></tr><tr><td data-num="339"></td><td><pre>                  "<span class="token variable">$domain</span>"</pre></td></tr><tr><td data-num="340"></td><td><pre>                ]</pre></td></tr><tr><td data-num="341"></td><td><pre>              &#125;</pre></td></tr><tr><td data-num="342"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num="343"></td><td><pre>          ],</pre></td></tr><tr><td data-num="344"></td><td><pre>          "automatic_https": &#123;</pre></td></tr><tr><td data-num="345"></td><td><pre>            "disable": true</pre></td></tr><tr><td data-num="346"></td><td><pre>          &#125;</pre></td></tr><tr><td data-num="347"></td><td><pre>        &#125;</pre></td></tr><tr><td data-num="348"></td><td><pre>      &#125;</pre></td></tr><tr><td data-num="349"></td><td><pre>    &#125;,</pre></td></tr><tr><td data-num="350"></td><td><pre>    "tls": &#123;</pre></td></tr><tr><td data-num="351"></td><td><pre>      "certificates": &#123;</pre></td></tr><tr><td data-num="352"></td><td><pre>        "load_files": [</pre></td></tr><tr><td data-num="353"></td><td><pre>          &#123;</pre></td></tr><tr><td data-num="354"></td><td><pre>            "certificate": "/etc/letsencrypt/live/<span class="token variable">$domain</span>/fullchain.pem",</pre></td></tr><tr><td data-num="355"></td><td><pre>            "key": "/etc/letsencrypt/live/<span class="token variable">$domain</span>/privkey.pem"</pre></td></tr><tr><td data-num="356"></td><td><pre>          &#125;</pre></td></tr><tr><td data-num="357"></td><td><pre>        ]</pre></td></tr><tr><td data-num="358"></td><td><pre>      &#125;</pre></td></tr><tr><td data-num="359"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num="360"></td><td><pre>  &#125;</pre></td></tr><tr><td data-num="361"></td><td><pre>&#125;</pre></td></tr><tr><td data-num="362"></td><td><pre>EOF</pre></td></tr><tr><td data-num="363"></td><td><pre></pre></td></tr><tr><td data-num="364"></td><td><pre><span class="token function">cat</span> <span class="token operator">></span> /etc/systemd/system/naive.service <span class="token operator">&lt;&lt;</span> <span class="token string">EOF</span></pre></td></tr><tr><td data-num="365"></td><td><pre>[Unit]</pre></td></tr><tr><td data-num="366"></td><td><pre>Description=Caddy</pre></td></tr><tr><td data-num="367"></td><td><pre>Documentation=https://caddyserver.com/docs/</pre></td></tr><tr><td data-num="368"></td><td><pre>After=network.target network-online.target</pre></td></tr><tr><td data-num="369"></td><td><pre>Requires=network-online.target</pre></td></tr><tr><td data-num="370"></td><td><pre></pre></td></tr><tr><td data-num="371"></td><td><pre>[Service]</pre></td></tr><tr><td data-num="372"></td><td><pre>Type=notify</pre></td></tr><tr><td data-num="373"></td><td><pre>User=root</pre></td></tr><tr><td data-num="374"></td><td><pre>Group=root</pre></td></tr><tr><td data-num="375"></td><td><pre>ExecStart=/usr/bin/caddy run --environ --config /etc/caddy/caddy_config.json</pre></td></tr><tr><td data-num="376"></td><td><pre>ExecReload=/usr/bin/caddy reload --config /etc/caddy/caddy_config.json</pre></td></tr><tr><td data-num="377"></td><td><pre>TimeoutStopSec=5s</pre></td></tr><tr><td data-num="378"></td><td><pre>LimitNOFILE=1048576</pre></td></tr><tr><td data-num="379"></td><td><pre>LimitNPROC=512</pre></td></tr><tr><td data-num="380"></td><td><pre>PrivateTmp=true</pre></td></tr><tr><td data-num="381"></td><td><pre>ProtectSystem=full</pre></td></tr><tr><td data-num="382"></td><td><pre>AmbientCapabilities=CAP_NET_BIND_SERVICE</pre></td></tr><tr><td data-num="383"></td><td><pre></pre></td></tr><tr><td data-num="384"></td><td><pre>[Install]</pre></td></tr><tr><td data-num="385"></td><td><pre>WantedBy=multi-user.target</pre></td></tr><tr><td data-num="386"></td><td><pre>EOF</pre></td></tr><tr><td data-num="387"></td><td><pre>    systemctl daemon-reload</pre></td></tr><tr><td data-num="388"></td><td><pre>    do_service restart naive</pre></td></tr><tr><td data-num="389"></td><td><pre>    <span class="token builtin class-name">echo</span> </pre></td></tr><tr><td data-num="390"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... NaiveProxy 已启动  .........."</span> </pre></td></tr><tr><td data-num="391"></td><td><pre>    do_service <span class="token builtin class-name">enable</span> naive</pre></td></tr><tr><td data-num="392"></td><td><pre>    <span class="token builtin class-name">echo</span> </pre></td></tr><tr><td data-num="393"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... NaiveProxy 设置自动启动完成 .........."</span> </pre></td></tr><tr><td data-num="394"></td><td><pre></pre></td></tr><tr><td data-num="395"></td><td><pre>    <span class="token builtin class-name">echo</span> </pre></td></tr><tr><td data-num="396"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... NaiveProxy 服务状态  .........."</span> </pre></td></tr><tr><td data-num="397"></td><td><pre></pre></td></tr><tr><td data-num="398"></td><td><pre>    do_service status naive --no-pager</pre></td></tr><tr><td data-num="399"></td><td><pre></pre></td></tr><tr><td data-num="400"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="401"></td><td><pre></pre></td></tr><tr><td data-num="402"></td><td><pre><span class="token function-name function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="403"></td><td><pre>    <span class="token function">mkdir</span> -p /etc/ssl/caddy</pre></td></tr><tr><td data-num="404"></td><td><pre>    <span class="token comment"># 存放 Caddyfile 的目录</span></pre></td></tr><tr><td data-num="405"></td><td><pre>    <span class="token function">mkdir</span> /etc/caddy/</pre></td></tr><tr><td data-num="406"></td><td><pre>    <span class="token function">mkdir</span> /var/www -p</pre></td></tr><tr><td data-num="407"></td><td><pre>    <span class="token builtin class-name">echo</span> index <span class="token operator">></span> /var/www/html </pre></td></tr><tr><td data-num="408"></td><td><pre>    <span class="token comment"># 生成密码</span></pre></td></tr><tr><td data-num="409"></td><td><pre>    <span class="token comment"># /etc/letsencrypt/live/x.dongvps.com/</span></pre></td></tr><tr><td data-num="410"></td><td><pre></pre></td></tr><tr><td data-num="411"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span> /etc/letsencrypt/live/ <span class="token operator">|</span> pgrep <span class="token string">"<span class="token variable">$domain</span>"</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token keyword">then</span></pre></td></tr><tr><td data-num="412"></td><td><pre>        certbot renew</pre></td></tr><tr><td data-num="413"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="414"></td><td><pre>        certbot certonly --standalone -d <span class="token variable">$domain</span> --agree-to --email <span class="token variable">$email</span></pre></td></tr><tr><td data-num="415"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="416"></td><td><pre>    <span class="token comment"># 生成 json</span></pre></td></tr><tr><td data-num="417"></td><td><pre></pre></td></tr><tr><td data-num="418"></td><td><pre>    <span class="token function">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</pre></td></tr><tr><td data-num="419"></td><td><pre>    _sys_timezone</pre></td></tr><tr><td data-num="420"></td><td><pre>    _sys_time</pre></td></tr><tr><td data-num="421"></td><td><pre></pre></td></tr><tr><td data-num="422"></td><td><pre>    </pre></td></tr><tr><td data-num="423"></td><td><pre></pre></td></tr><tr><td data-num="424"></td><td><pre>    </pre></td></tr><tr><td data-num="425"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="426"></td><td><pre></pre></td></tr><tr><td data-num="427"></td><td><pre></pre></td></tr><tr><td data-num="428"></td><td><pre><span class="token function-name function">edit_port</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="429"></td><td><pre>    <span class="token comment"># 修改端口</span></pre></td></tr><tr><td data-num="430"></td><td><pre>    get_ip</pre></td></tr><tr><td data-num="431"></td><td><pre>    <span class="token assign-left variable">domain</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">egrep</span> <span class="token string">'domain'</span> /etc/caddy/.autoconfig <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">'='</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="432"></td><td><pre>    <span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">egrep</span> <span class="token string">'user'</span> /etc/caddy/.autoconfig <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">'='</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="433"></td><td><pre>    <span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">egrep</span> <span class="token string">'password'</span> /etc/caddy/.autoconfig <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">'='</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="434"></td><td><pre>    <span class="token assign-left variable">naive_port</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">egrep</span> <span class="token string">'port'</span> /etc/caddy/.autoconfig <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">'='</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="435"></td><td><pre>    <span class="token assign-left variable">email</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">egrep</span> <span class="token string">'email'</span> /etc/caddy/.autoconfig <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">'='</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="436"></td><td><pre></pre></td></tr><tr><td data-num="437"></td><td><pre>    </pre></td></tr><tr><td data-num="438"></td><td><pre>    <span class="token keyword">while</span> <span class="token builtin class-name">:</span><span class="token punctuation">;</span> <span class="token keyword">do</span></pre></td></tr><tr><td data-num="439"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"请输入 "</span><span class="token variable">$yellow</span><span class="token string">"NaiveProxy"</span><span class="token variable">$none</span><span class="token string">" 端口 ["</span><span class="token variable">$magenta</span><span class="token string">"1-65535"</span><span class="token variable">$none</span><span class="token string">"]，不能选择 "</span><span class="token variable">$magenta</span><span class="token string">"80"</span><span class="token variable">$none</span><span class="token string">"端口"</span></pre></td></tr><tr><td data-num="440"></td><td><pre>        <span class="token builtin class-name">read</span> -p <span class="token string">"$(echo -e "(默认端口: <span class="token variable">$&#123;cyan&#125;</span>443<span class="token variable">$none</span>):"</span><span class="token punctuation">)</span><span class="token string">" naive_port</span></pre></td></tr><tr><td data-num="441"></td><td><pre>        [ -z "<span class="token variable">$naive_port</span><span class="token string">" ] &amp;&amp; naive_port=443</span></pre></td></tr><tr><td data-num="442"></td><td><pre>        case <span class="token variable">$naive_port</span> in</pre></td></tr><tr><td data-num="443"></td><td><pre>        80)</pre></td></tr><tr><td data-num="444"></td><td><pre>            echo</pre></td></tr><tr><td data-num="445"></td><td><pre>            echo " <span class="token punctuation">..</span>.都说了不能选择 <span class="token number">80</span> 端口了咯<span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token string">"</span></pre></td></tr><tr><td data-num="446"></td><td><pre>            error</pre></td></tr><tr><td data-num="447"></td><td><pre>            ;;</pre></td></tr><tr><td data-num="448"></td><td><pre>        [1-9] | [1-9][0-9] | [1-9][0-9][0-9] | [1-9][0-9][0-9][0-9] | [1-5][0-9][0-9][0-9][0-9] | 6[0-4][0-9][0-9][0-9] | 65[0-4][0-9][0-9] | 655[0-3][0-5])</pre></td></tr><tr><td data-num="449"></td><td><pre>            echo</pre></td></tr><tr><td data-num="450"></td><td><pre>            echo</pre></td></tr><tr><td data-num="451"></td><td><pre>            echo -e "<span class="token variable">$yellow</span> naive_port 端口 <span class="token operator">=</span> <span class="token variable">$cyan</span><span class="token variable">$naive_port</span><span class="token variable">$none</span><span class="token string">"</span></pre></td></tr><tr><td data-num="452"></td><td><pre>            echo "----------------------------------------------------------------<span class="token string">"</span></pre></td></tr><tr><td data-num="453"></td><td><pre>            echo</pre></td></tr><tr><td data-num="454"></td><td><pre>            break</pre></td></tr><tr><td data-num="455"></td><td><pre>            ;;</pre></td></tr><tr><td data-num="456"></td><td><pre>        *)</pre></td></tr><tr><td data-num="457"></td><td><pre>            error</pre></td></tr><tr><td data-num="458"></td><td><pre>            ;;</pre></td></tr><tr><td data-num="459"></td><td><pre>        esac</pre></td></tr><tr><td data-num="460"></td><td><pre>    done</pre></td></tr><tr><td data-num="461"></td><td><pre>    # 输入端口</pre></td></tr><tr><td data-num="462"></td><td><pre>    cat > /etc/caddy/caddy_config.json &lt;&lt; EOF</pre></td></tr><tr><td data-num="463"></td><td><pre>&#123;</pre></td></tr><tr><td data-num="464"></td><td><pre>  "admin<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="465"></td><td><pre>    "disabled<span class="token string">": true</span></pre></td></tr><tr><td data-num="466"></td><td><pre>  &#125;,</pre></td></tr><tr><td data-num="467"></td><td><pre>  "apps<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="468"></td><td><pre>    "http<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="469"></td><td><pre>      "servers<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="470"></td><td><pre>        "srv0<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="471"></td><td><pre>          "listen<span class="token string">": [</span></pre></td></tr><tr><td data-num="472"></td><td><pre>            "<span class="token builtin class-name">:</span><span class="token variable">$naive_port</span><span class="token string">"</span></pre></td></tr><tr><td data-num="473"></td><td><pre>          ],</pre></td></tr><tr><td data-num="474"></td><td><pre>          "routes<span class="token string">": [</span></pre></td></tr><tr><td data-num="475"></td><td><pre>            &#123;</pre></td></tr><tr><td data-num="476"></td><td><pre>              "handle<span class="token string">": [</span></pre></td></tr><tr><td data-num="477"></td><td><pre>                &#123;</pre></td></tr><tr><td data-num="478"></td><td><pre>                  "handler<span class="token string">": "</span>subroute<span class="token string">",</span></pre></td></tr><tr><td data-num="479"></td><td><pre>                  "routes<span class="token string">": [</span></pre></td></tr><tr><td data-num="480"></td><td><pre>                    &#123;</pre></td></tr><tr><td data-num="481"></td><td><pre>                      "handle<span class="token string">": [</span></pre></td></tr><tr><td data-num="482"></td><td><pre>                        &#123;</pre></td></tr><tr><td data-num="483"></td><td><pre>                          "auth_user_deprecated<span class="token string">": "</span>User<span class="token string">",</span></pre></td></tr><tr><td data-num="484"></td><td><pre>                          "auth_pass_deprecated<span class="token string">": "</span><span class="token variable">$password</span><span class="token string">",</span></pre></td></tr><tr><td data-num="485"></td><td><pre>                          "handler<span class="token string">": "</span>forward_proxy<span class="token string">",</span></pre></td></tr><tr><td data-num="486"></td><td><pre>                          "hide_ip<span class="token string">": true,</span></pre></td></tr><tr><td data-num="487"></td><td><pre>                          "hide_via<span class="token string">": true,</span></pre></td></tr><tr><td data-num="488"></td><td><pre>                          "probe_resistance<span class="token string">": &#123;&#125;</span></pre></td></tr><tr><td data-num="489"></td><td><pre>                        &#125;</pre></td></tr><tr><td data-num="490"></td><td><pre>                      ]</pre></td></tr><tr><td data-num="491"></td><td><pre>                    &#125;,</pre></td></tr><tr><td data-num="492"></td><td><pre>                    &#123;</pre></td></tr><tr><td data-num="493"></td><td><pre>                      "match<span class="token string">": [</span></pre></td></tr><tr><td data-num="494"></td><td><pre>                        &#123;</pre></td></tr><tr><td data-num="495"></td><td><pre>                          "<span class="token function">host</span><span class="token string">": [</span></pre></td></tr><tr><td data-num="496"></td><td><pre>                            "<span class="token variable">$domain</span><span class="token string">"</span></pre></td></tr><tr><td data-num="497"></td><td><pre>                          ]</pre></td></tr><tr><td data-num="498"></td><td><pre>                        &#125;</pre></td></tr><tr><td data-num="499"></td><td><pre>                      ],</pre></td></tr><tr><td data-num="500"></td><td><pre>                      "handle<span class="token string">": [</span></pre></td></tr><tr><td data-num="501"></td><td><pre>                        &#123;</pre></td></tr><tr><td data-num="502"></td><td><pre>                          "handler<span class="token string">": "</span>file_server<span class="token string">",</span></pre></td></tr><tr><td data-num="503"></td><td><pre>                          "root<span class="token string">": "</span>/var/www/html<span class="token string">",</span></pre></td></tr><tr><td data-num="504"></td><td><pre>                          "index_names<span class="token string">": [</span></pre></td></tr><tr><td data-num="505"></td><td><pre>                            "index.html<span class="token string">"</span></pre></td></tr><tr><td data-num="506"></td><td><pre>                          ]</pre></td></tr><tr><td data-num="507"></td><td><pre>                        &#125;</pre></td></tr><tr><td data-num="508"></td><td><pre>                      ],</pre></td></tr><tr><td data-num="509"></td><td><pre>                      "terminal<span class="token string">": true</span></pre></td></tr><tr><td data-num="510"></td><td><pre>                    &#125;</pre></td></tr><tr><td data-num="511"></td><td><pre>                  ]</pre></td></tr><tr><td data-num="512"></td><td><pre>                &#125;</pre></td></tr><tr><td data-num="513"></td><td><pre>              ]</pre></td></tr><tr><td data-num="514"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num="515"></td><td><pre>          ],</pre></td></tr><tr><td data-num="516"></td><td><pre>          "tls_connection_policies<span class="token string">": [</span></pre></td></tr><tr><td data-num="517"></td><td><pre>            &#123;</pre></td></tr><tr><td data-num="518"></td><td><pre>              "match<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="519"></td><td><pre>                "sni<span class="token string">": [</span></pre></td></tr><tr><td data-num="520"></td><td><pre>                  "<span class="token variable">$domain</span><span class="token string">"</span></pre></td></tr><tr><td data-num="521"></td><td><pre>                ]</pre></td></tr><tr><td data-num="522"></td><td><pre>              &#125;</pre></td></tr><tr><td data-num="523"></td><td><pre>            &#125;</pre></td></tr><tr><td data-num="524"></td><td><pre>          ],</pre></td></tr><tr><td data-num="525"></td><td><pre>          "automatic_https<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="526"></td><td><pre>            "disable<span class="token string">": true</span></pre></td></tr><tr><td data-num="527"></td><td><pre>          &#125;</pre></td></tr><tr><td data-num="528"></td><td><pre>        &#125;</pre></td></tr><tr><td data-num="529"></td><td><pre>      &#125;</pre></td></tr><tr><td data-num="530"></td><td><pre>    &#125;,</pre></td></tr><tr><td data-num="531"></td><td><pre>    "tls<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="532"></td><td><pre>      "certificates<span class="token string">": &#123;</span></pre></td></tr><tr><td data-num="533"></td><td><pre>        "load_files<span class="token string">": [</span></pre></td></tr><tr><td data-num="534"></td><td><pre>          &#123;</pre></td></tr><tr><td data-num="535"></td><td><pre>            "certificate<span class="token string">": "</span>/etc/letsencrypt/live/<span class="token variable">$domain</span>/fullchain.pem<span class="token string">",</span></pre></td></tr><tr><td data-num="536"></td><td><pre>            "key<span class="token string">": "</span>/etc/letsencrypt/live/<span class="token variable">$domain</span>/privkey.pem<span class="token string">"</span></pre></td></tr><tr><td data-num="537"></td><td><pre>          &#125;</pre></td></tr><tr><td data-num="538"></td><td><pre>        ]</pre></td></tr><tr><td data-num="539"></td><td><pre>      &#125;</pre></td></tr><tr><td data-num="540"></td><td><pre>    &#125;</pre></td></tr><tr><td data-num="541"></td><td><pre>  &#125;</pre></td></tr><tr><td data-num="542"></td><td><pre>&#125;</pre></td></tr><tr><td data-num="543"></td><td><pre>EOF</pre></td></tr><tr><td data-num="544"></td><td><pre>    do_service restart naive</pre></td></tr><tr><td data-num="545"></td><td><pre>    echo </pre></td></tr><tr><td data-num="546"></td><td><pre>    echo "<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. Naiveproxy 已重启  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">"</span></pre></td></tr><tr><td data-num="547"></td><td><pre>    </pre></td></tr><tr><td data-num="548"></td><td><pre>    do_service enable naive</pre></td></tr><tr><td data-num="549"></td><td><pre>    echo </pre></td></tr><tr><td data-num="550"></td><td><pre>    echo "<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. Naiveproxy 设置自动启动完成  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">"</span></pre></td></tr><tr><td data-num="551"></td><td><pre>    </pre></td></tr><tr><td data-num="552"></td><td><pre>    echo > /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="553"></td><td><pre>    echo -e "本机ip       <span class="token operator">=</span><span class="token variable">$ip</span><span class="token string">" >> /etc/caddy/.autoconfig</span></pre></td></tr><tr><td data-num="554"></td><td><pre>    echo -e "域名domain   <span class="token operator">=</span><span class="token variable">$domain</span><span class="token string">" >> /etc/caddy/.autoconfig</span></pre></td></tr><tr><td data-num="555"></td><td><pre>    echo -e "端口port     <span class="token operator">=</span><span class="token variable">$naive_port</span><span class="token string">" >> /etc/caddy/.autoconfig</span></pre></td></tr><tr><td data-num="556"></td><td><pre>    echo -e "用户名user   <span class="token operator">=</span>User<span class="token string">" >> /etc/caddy/.autoconfig</span></pre></td></tr><tr><td data-num="557"></td><td><pre>    echo -e "密码password <span class="token operator">=</span><span class="token variable">$password</span><span class="token string">" >> /etc/caddy/.autoconfig</span></pre></td></tr><tr><td data-num="558"></td><td><pre>    echo -e "邮箱email    <span class="token operator">=</span><span class="token variable">$email</span><span class="token string">" >> /etc/caddy/.autoconfig</span></pre></td></tr><tr><td data-num="559"></td><td><pre></pre></td></tr><tr><td data-num="560"></td><td><pre>    echo </pre></td></tr><tr><td data-num="561"></td><td><pre>    echo "<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>. NaiveProxy 服务状态  <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token string">" </span></pre></td></tr><tr><td data-num="562"></td><td><pre>    do_service status naive --no-pager</pre></td></tr><tr><td data-num="563"></td><td><pre></pre></td></tr><tr><td data-num="564"></td><td><pre>    cat /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="565"></td><td><pre></pre></td></tr><tr><td data-num="566"></td><td><pre></pre></td></tr><tr><td data-num="567"></td><td><pre>&#125;</pre></td></tr><tr><td data-num="568"></td><td><pre></pre></td></tr><tr><td data-num="569"></td><td><pre></pre></td></tr><tr><td data-num="570"></td><td><pre>get_ip() &#123;</pre></td></tr><tr><td data-num="571"></td><td><pre>    ip=<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s https://ipinfo.io/ip<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="572"></td><td><pre>    [[ -z <span class="token variable">$ip</span> ]] &amp;&amp; ip=<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s https://api.ip.sb/ip<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="573"></td><td><pre>    [[ -z <span class="token variable">$ip</span> ]] &amp;&amp; ip=<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s https://api.ipify.org<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="574"></td><td><pre>    [[ -z <span class="token variable">$ip</span> ]] &amp;&amp; ip=<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s https://ip.seeip.org<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="575"></td><td><pre>    [[ -z <span class="token variable">$ip</span> ]] &amp;&amp; ip=<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s https://ifconfig.co/ip<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="576"></td><td><pre>    [[ -z <span class="token variable">$ip</span> ]] &amp;&amp; ip=$(curl -s https://api.myip.com | grep -oE "([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;"<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="577"></td><td><pre>    <span class="token punctuation">[</span><span class="token punctuation">[</span> -z <span class="token variable">$ip</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s icanhazip.com<span class="token variable">)</span></span></pre></td></tr><tr><td data-num="578"></td><td><pre>    <span class="token punctuation">[</span><span class="token punctuation">[</span> -z <span class="token variable">$ip</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -s myip.ipip.net <span class="token operator">|</span> <span class="token function">grep</span> -oE <span class="token string">"([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;"</span><span class="token variable">)</span></span></pre></td></tr><tr><td data-num="579"></td><td><pre>    <span class="token punctuation">[</span><span class="token punctuation">[</span> -z <span class="token variable">$ip</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token variable">$red</span> 这垃圾小鸡扔了吧！<span class="token variable">$none</span><span class="token entity" title="\n">\n</span>"</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span></pre></td></tr><tr><td data-num="580"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="581"></td><td><pre></pre></td></tr><tr><td data-num="582"></td><td><pre><span class="token function-name function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="583"></td><td><pre></pre></td></tr><tr><td data-num="584"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token variable">$red</span> 输入错误！<span class="token variable">$none</span><span class="token entity" title="\n">\n</span>"</span></pre></td></tr><tr><td data-num="585"></td><td><pre></pre></td></tr><tr><td data-num="586"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="587"></td><td><pre></pre></td></tr><tr><td data-num="588"></td><td><pre><span class="token function-name function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="589"></td><td><pre></pre></td></tr><tr><td data-num="590"></td><td><pre>    <span class="token builtin class-name">read</span> -rsp <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -e <span class="token string">"按 <span class="token variable">$green</span> Enter 回车键 <span class="token variable">$none</span> 继续....或按 <span class="token variable">$red</span> Ctrl + C <span class="token variable">$none</span> 取消."</span><span class="token variable">)</span></span>"</span> -d <span class="token string">$'<span class="token entity" title="\n">\n</span>'</span></pre></td></tr><tr><td data-num="591"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="592"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="593"></td><td><pre><span class="token function-name function">do_service</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="594"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$systemd</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="595"></td><td><pre>        systemctl <span class="token variable">$1</span> <span class="token variable">$2</span></pre></td></tr><tr><td data-num="596"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="597"></td><td><pre>        <span class="token function">service</span> <span class="token variable">$2</span> <span class="token variable">$1</span></pre></td></tr><tr><td data-num="598"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="599"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="600"></td><td><pre><span class="token function-name function">show_config_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="601"></td><td><pre>    <span class="token function">clear</span></pre></td></tr><tr><td data-num="602"></td><td><pre>    <span class="token comment"># mkdir -p .local/share/caddy/config</span></pre></td></tr><tr><td data-num="603"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token operator">></span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="604"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"本机ip       =<span class="token variable">$ip</span>"</span> <span class="token operator">>></span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="605"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"域名domain   =<span class="token variable">$domain</span>"</span> <span class="token operator">>></span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="606"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"端口port     =<span class="token variable">$naive_port</span>"</span> <span class="token operator">>></span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="607"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"用户名user   =User"</span> <span class="token operator">>></span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="608"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"密码password =<span class="token variable">$password</span>"</span> <span class="token operator">>></span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="609"></td><td><pre>    <span class="token builtin class-name">echo</span> -e <span class="token string">"邮箱email    =<span class="token variable">$email</span>"</span> <span class="token operator">>></span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="610"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="611"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... Naiveproxy 配置信息  .........."</span></pre></td></tr><tr><td data-num="612"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="613"></td><td><pre>    <span class="token function">cat</span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="614"></td><td><pre></pre></td></tr><tr><td data-num="615"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="616"></td><td><pre></pre></td></tr><tr><td data-num="617"></td><td><pre><span class="token function-name function">install</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="618"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -f /usr/bin/caddy <span class="token operator">&amp;&amp;</span> -f /etc/caddy/caddy_config.json <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="619"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="620"></td><td><pre>        <span class="token builtin class-name">echo</span> <span class="token string">" 安装 NaiveProxy已存在..."</span></pre></td></tr><tr><td data-num="621"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="622"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"继续安装请输入1,退出请输入任意值"</span></pre></td></tr><tr><td data-num="623"></td><td><pre>        <span class="token builtin class-name">read</span> -p <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -e <span class="token string">"请选择 [<span class="token variable">$&#123;magenta&#125;</span>1-2<span class="token variable">$none</span>]:"</span><span class="token variable">)</span></span>"</span> choose2</pre></td></tr><tr><td data-num="624"></td><td><pre>        <span class="token keyword">case</span> <span class="token variable">$choose2</span> <span class="token keyword">in</span></pre></td></tr><tr><td data-num="625"></td><td><pre>        <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="626"></td><td><pre>            <span class="token builtin class-name">echo</span> <span class="token string">" 继续安装..."</span></pre></td></tr><tr><td data-num="627"></td><td><pre>            do_service stop naive</pre></td></tr><tr><td data-num="628"></td><td><pre>            <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="629"></td><td><pre>        *<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="630"></td><td><pre>            <span class="token builtin class-name">exit</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="631"></td><td><pre>            <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="632"></td><td><pre>        <span class="token keyword">esac</span></pre></td></tr><tr><td data-num="633"></td><td><pre>        </pre></td></tr><tr><td data-num="634"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="635"></td><td><pre>    <span class="token comment"># 安装依赖以及 certbot 命令</span></pre></td></tr><tr><td data-num="636"></td><td><pre>     </pre></td></tr><tr><td data-num="637"></td><td><pre>    </pre></td></tr><tr><td data-num="638"></td><td><pre>    <span class="token comment"># 配置代理信息，比如域名</span></pre></td></tr><tr><td data-num="639"></td><td><pre>    naive_config</pre></td></tr><tr><td data-num="640"></td><td><pre>    <span class="token comment"># blocked_hosts</span></pre></td></tr><tr><td data-num="641"></td><td><pre>    install_info</pre></td></tr><tr><td data-num="642"></td><td><pre>    <span class="token comment"># [[ $caddy ]] &amp;&amp; domain_check</span></pre></td></tr><tr><td data-num="643"></td><td><pre>    install_certbot</pre></td></tr><tr><td data-num="644"></td><td><pre>    install_go</pre></td></tr><tr><td data-num="645"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$caddy</span> <span class="token operator">||</span> <span class="token variable">$v2ray_port</span> <span class="token operator">==</span> <span class="token string">"443"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="646"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$cmd</span> <span class="token operator">==</span> <span class="token string">"yum"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="647"></td><td><pre>            <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span>pgrep <span class="token string">"nginx"</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> systemctl stop nginx</pre></td></tr><tr><td data-num="648"></td><td><pre>            <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v nginx<span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> yum remove nginx -y</pre></td></tr><tr><td data-num="649"></td><td><pre>            <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span>pgrep <span class="token string">"httpd"</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> systemctl stop httpd</pre></td></tr><tr><td data-num="650"></td><td><pre>            <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v httpd<span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> yum remove httpd -y</pre></td></tr><tr><td data-num="651"></td><td><pre>        <span class="token keyword">else</span></pre></td></tr><tr><td data-num="652"></td><td><pre>            <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span>pgrep <span class="token string">"apache2"</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">service</span> apache2 stop</pre></td></tr><tr><td data-num="653"></td><td><pre>            <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v apache2<span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">apt-get</span> remove apache2* -y</pre></td></tr><tr><td data-num="654"></td><td><pre>        <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="655"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="656"></td><td><pre>    install_caddy</pre></td></tr><tr><td data-num="657"></td><td><pre></pre></td></tr><tr><td data-num="658"></td><td><pre>    <span class="token comment">## bbr</span></pre></td></tr><tr><td data-num="659"></td><td><pre>    <span class="token comment"># _load bbr.sh</span></pre></td></tr><tr><td data-num="660"></td><td><pre>    <span class="token comment"># _try_enable_bbr</span></pre></td></tr><tr><td data-num="661"></td><td><pre></pre></td></tr><tr><td data-num="662"></td><td><pre></pre></td></tr><tr><td data-num="663"></td><td><pre>    config</pre></td></tr><tr><td data-num="664"></td><td><pre>    caddy_config</pre></td></tr><tr><td data-num="665"></td><td><pre></pre></td></tr><tr><td data-num="666"></td><td><pre></pre></td></tr><tr><td data-num="667"></td><td><pre>    get_ip</pre></td></tr><tr><td data-num="668"></td><td><pre>    add_cron</pre></td></tr><tr><td data-num="669"></td><td><pre>    allow_port</pre></td></tr><tr><td data-num="670"></td><td><pre>    show_config_info</pre></td></tr><tr><td data-num="671"></td><td><pre>    <span class="token comment"># do_service restart naive</span></pre></td></tr><tr><td data-num="672"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="673"></td><td><pre><span class="token function-name function">uninstall</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="674"></td><td><pre></pre></td></tr><tr><td data-num="675"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> -f /usr/bin/caddy <span class="token operator">&amp;&amp;</span> -f /etc/caddy/caddy_config.json <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="676"></td><td><pre>        do_service disable naive</pre></td></tr><tr><td data-num="677"></td><td><pre>        do_service stop naive</pre></td></tr><tr><td data-num="678"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"</span></pre></td></tr><tr><td data-num="679"></td><td><pre>        <span class="token variable">$red</span> 仅仅是停止服务了...<span class="token variable">$none</span></pre></td></tr><tr><td data-num="680"></td><td><pre>        " <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="681"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="682"></td><td><pre></pre></td></tr><tr><td data-num="683"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="684"></td><td><pre></pre></td></tr><tr><td data-num="685"></td><td><pre><span class="token function-name function">show_config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="686"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="687"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... Naiveproxy 配置信息  .........."</span></pre></td></tr><tr><td data-num="688"></td><td><pre>    <span class="token function">cat</span> /etc/caddy/.autoconfig</pre></td></tr><tr><td data-num="689"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="690"></td><td><pre></pre></td></tr><tr><td data-num="691"></td><td><pre><span class="token function-name function">add_cron</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="692"></td><td><pre>    <span class="token builtin class-name">echo</span> </pre></td></tr><tr><td data-num="693"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... 证书自动更新  .........."</span></pre></td></tr><tr><td data-num="694"></td><td><pre>    <span class="token function">cat</span> <span class="token operator">></span> /etc/caddy/.renew.sh <span class="token operator">&lt;&lt;</span> <span class="token string">EOF</span></pre></td></tr><tr><td data-num="695"></td><td><pre>    </pre></td></tr><tr><td data-num="696"></td><td><pre>#!/usr/bin/env bash</pre></td></tr><tr><td data-num="697"></td><td><pre>systemctl stop naive</pre></td></tr><tr><td data-num="698"></td><td><pre>certbot renew</pre></td></tr><tr><td data-num="699"></td><td><pre>systemctl start naive</pre></td></tr><tr><td data-num="700"></td><td><pre>EOF</pre></td></tr><tr><td data-num="701"></td><td><pre>    <span class="token function">chmod</span> +x /etc/caddy/.renew.sh</pre></td></tr><tr><td data-num="702"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">`</span><span class="token function">grep</span> -c <span class="token string">"caddy"</span> /var/spool/cron/root<span class="token variable">`</span></span> -lt <span class="token string">'1'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span></pre></td></tr><tr><td data-num="703"></td><td><pre>        <span class="token builtin class-name">echo</span> <span class="token string">"0 1 * * * /etc/caddy/.renew.sh"</span> <span class="token operator">>></span> /var/spool/cron/root</pre></td></tr><tr><td data-num="704"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="705"></td><td><pre>    <span class="token function">crontab</span> -l</pre></td></tr><tr><td data-num="706"></td><td><pre>    <span class="token comment"># crontab -l > /tmp/conf &amp;&amp; echo "0 1 * * * /etc/caddy/.renew.sh" >> /tmp/conf &amp;&amp; crontab /tmp/conf &amp;&amp; rm -f /tmp/conf</span></pre></td></tr><tr><td data-num="707"></td><td><pre>    <span class="token builtin class-name">echo</span> </pre></td></tr><tr><td data-num="708"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... 证书自动更新设置完成  .........."</span></pre></td></tr><tr><td data-num="709"></td><td><pre>    <span class="token function">crontab</span> -l</pre></td></tr><tr><td data-num="710"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="711"></td><td><pre></pre></td></tr><tr><td data-num="712"></td><td><pre><span class="token function-name function">allow_port</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="713"></td><td><pre></pre></td></tr><tr><td data-num="714"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v yum<span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="715"></td><td><pre></pre></td></tr><tr><td data-num="716"></td><td><pre>        firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token variable">$naive_port</span>/tcp --permanent</pre></td></tr><tr><td data-num="717"></td><td><pre>        firewall-cmd --zone<span class="token operator">=</span>public --add-port<span class="token operator">=</span><span class="token variable">$naive_port</span>/udp --permanent</pre></td></tr><tr><td data-num="718"></td><td><pre>        firewall-cmd --reload</pre></td></tr><tr><td data-num="719"></td><td><pre></pre></td></tr><tr><td data-num="720"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="721"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span> -v <span class="token function">apt-get</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="722"></td><td><pre></pre></td></tr><tr><td data-num="723"></td><td><pre>        iptables -I INPUT -p tcp --dport <span class="token variable">$naive_port</span> -j ACCEPT</pre></td></tr><tr><td data-num="724"></td><td><pre>        iptables -I INPUT -p udp --dport <span class="token variable">$naive_port</span> -j ACCEPT</pre></td></tr><tr><td data-num="725"></td><td><pre>        iptables-save</pre></td></tr><tr><td data-num="726"></td><td><pre></pre></td></tr><tr><td data-num="727"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="728"></td><td><pre>    <span class="token builtin class-name">echo</span> </pre></td></tr><tr><td data-num="729"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... 防火墙已开放端口<span class="token variable">$naive_port</span>  .........."</span></pre></td></tr><tr><td data-num="730"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="731"></td><td><pre></pre></td></tr><tr><td data-num="732"></td><td><pre></pre></td></tr><tr><td data-num="733"></td><td><pre><span class="token keyword">while</span> <span class="token builtin class-name">:</span><span class="token punctuation">;</span> <span class="token keyword">do</span></pre></td></tr><tr><td data-num="734"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="735"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">"........... Naiveproxy 一键安装脚本 &amp; 管理脚本  .........."</span></pre></td></tr><tr><td data-num="736"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="737"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="738"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">" 1. 安装"</span></pre></td></tr><tr><td data-num="739"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="740"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">" 2. 显示信息"</span></pre></td></tr><tr><td data-num="741"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="742"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">" 3. 修改端口"</span></pre></td></tr><tr><td data-num="743"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="744"></td><td><pre>    <span class="token builtin class-name">echo</span> <span class="token string">" 4. 停止"</span></pre></td></tr><tr><td data-num="745"></td><td><pre>    <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="746"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$local_install</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="747"></td><td><pre>        <span class="token builtin class-name">echo</span> -e <span class="token string">"<span class="token variable">$yellow</span> 温馨提示.. 本地安装已启用 ..<span class="token variable">$none</span>"</span></pre></td></tr><tr><td data-num="748"></td><td><pre>        <span class="token builtin class-name">echo</span></pre></td></tr><tr><td data-num="749"></td><td><pre>    <span class="token keyword">fi</span></pre></td></tr><tr><td data-num="750"></td><td><pre>    <span class="token builtin class-name">read</span> -p <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> -e <span class="token string">"请选择 [<span class="token variable">$&#123;magenta&#125;</span>1-4<span class="token variable">$none</span>]:"</span><span class="token variable">)</span></span>"</span> choose</pre></td></tr><tr><td data-num="751"></td><td><pre>    <span class="token keyword">case</span> <span class="token variable">$choose</span> <span class="token keyword">in</span></pre></td></tr><tr><td data-num="752"></td><td><pre>    <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="753"></td><td><pre>        <span class="token function">install</span></pre></td></tr><tr><td data-num="754"></td><td><pre>        <span class="token builtin class-name">break</span></pre></td></tr><tr><td data-num="755"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="756"></td><td><pre>    <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="757"></td><td><pre>        show_config</pre></td></tr><tr><td data-num="758"></td><td><pre>        <span class="token builtin class-name">break</span></pre></td></tr><tr><td data-num="759"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="760"></td><td><pre>    <span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="761"></td><td><pre>        edit_port</pre></td></tr><tr><td data-num="762"></td><td><pre>        <span class="token builtin class-name">break</span></pre></td></tr><tr><td data-num="763"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="764"></td><td><pre>    <span class="token number">4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="765"></td><td><pre>        uninstall</pre></td></tr><tr><td data-num="766"></td><td><pre>        <span class="token builtin class-name">break</span></pre></td></tr><tr><td data-num="767"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="768"></td><td><pre>    *<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="769"></td><td><pre>        error</pre></td></tr><tr><td data-num="770"></td><td><pre>        <span class="token punctuation">;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="771"></td><td><pre>    <span class="token keyword">esac</span></pre></td></tr><tr><td data-num="772"></td><td><pre><span class="token keyword">done</span></pre></td></tr></table></figure><p>一键安装</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>yum <span class="token function">install</span> -y <span class="token function">wget</span><span class="token operator">&amp;&amp;</span><span class="token function">wget</span> https://raw.githubusercontent.com/imajeason/nas_tools/main/NaiveProxy/install.sh<span class="token operator">&amp;&amp;</span><span class="token function">bash</span> install.sh</pre></td></tr></table></figure><p>已测试可用系统 <code>debian10</code> / <code>debian11</code> / <code>centos7</code><br>关于 3 个月证书到期更新问题，我加了定时任务，但是不确定都能正常，如果证书到期需要手动执行 certbot renew 然后 systemctl restart naive 重启服务即可。</p><h2 id="2023年3月23日更新"><a class="anchor" href="#2023年3月23日更新">#</a> 2023 年 3 月 23 日更新</h2><p>naiveproxy 一键脚本发布（无须编译 caddy，支持多端口复用，自定义伪装网页），演示甲骨文纯 IPV4（mack-a）+ 纯 IPV6 (X-UI) 与 naiveproxy 共存方式的教程：<span class="exturl" data-url="aHR0cHM6Ly95Z2tray5ibG9nc3BvdC5jb20vMjAyMi8xMS9uYWl2ZXByb3h5LXlnLXlvdXR1YmUuaHRtbA==">https://ygkkk.blogspot.com/2022/11/naiveproxy-yg-youtube.html</span><br><span class="exturl" data-url="aHR0cHM6Ly9naXRsYWIuY29tL3J3a2d5Zy9uYWl2ZXByb3h5LXln">https://gitlab.com/rwkgyg/naiveproxy-yg</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tsemdyYWQvbmFpdmVwcm94eS9yZWxlYXNlcw==">https://github.com/klzgrad/naiveproxy/releases</span><br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3YyZmx5L3YycmF5LWNvcmU=">https://github.com/v2fly/v2ray-core</span><br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1F2MnJheS9RdjJyYXkvcmVsZWFzZXM=">https://github.com/Qv2ray/Qv2ray/releases</span></p></div><footer><div class="meta"></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>黑麋鹿 <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://sirliu.github.io/2022/10/NaiveProxy%E6%90%AD%E5%BB%BA/" title="NaiveProxy搭建">https://sirliu.github.io/2022/10/NaiveProxy搭建/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/10/trojan%E6%90%AD%E5%BB%BA/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;dd-static.jd.com&#x2F;ddimg&#x2F;jfs&#x2F;t1&#x2F;203525&#x2F;18&#x2F;8134&#x2F;2076164&#x2F;614f37fcE3cbe6345&#x2F;3b7a9eb068e913f1.jpg" title="trojan搭建"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>trojan搭建</h3></a></div><div class="item right"><a href="/2022/10/%E6%A0%B9%E6%8D%AEexcel%E8%A1%A8%E6%A0%BC%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%9B%BA%E5%AE%9A%E6%A0%BC%E5%BC%8Fword%E6%96%87%E6%A1%A3/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;dd-static.jd.com&#x2F;ddimg&#x2F;jfs&#x2F;t1&#x2F;200558&#x2F;33&#x2F;9936&#x2F;1109109&#x2F;614f378aE06b30bdb&#x2F;93f8391d9f8bb10d.jpg" title="根据excel表格自动生成固定格式word文档"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> word</span><h3>根据excel表格自动生成固定格式word文档</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2023%E5%B9%B43%E6%9C%8823%E6%97%A5%E6%9B%B4%E6%96%B0"><span class="toc-number">1.</span> <span class="toc-text">2023 年 3 月 23 日更新</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="黑麋鹿" data-src="/images/avatar.jpg"><p class="name" itemprop="name">黑麋鹿</p><div class="description" itemprop="description">折腾之路</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">198</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">48</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">110</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/10/trojan%E6%90%AD%E5%BB%BA/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/10/%E6%A0%B9%E6%8D%AEexcel%E8%A1%A8%E6%A0%BC%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%9B%BA%E5%AE%9A%E6%A0%BC%E5%BC%8Fword%E6%96%87%E6%A1%A3/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">黑麋鹿 @ Black Elk</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">820k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">12:26</span></div><div class="powered-by">基于 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & Theme.<a href="https://github.com/amehime/hexo-theme-shoka" rel="noopener" target="_blank">Shoka</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/10/NaiveProxy搭建/",favicon:{show:"BlackELK",hide:"看看再走吧"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->