<!-- build time:Fri Mar 01 2024 12:44:59 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://coloraven.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://coloraven.github.io/atom.xml"><link rel="alternate" type="application/json" href="https://coloraven.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CMicrosoft%20YaHei:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Python,Pandas"><link rel="canonical" href="https://coloraven.github.io/2023/4/pandas%E4%B8%80%E5%88%97%E5%88%86%E5%A4%9A%E5%88%97%EF%BC%8C%E4%B8%80%E8%A1%8C%E5%88%86%E5%A4%9A%E8%A1%8C%E7%9A%84%E5%AE%9E%E7%8E%B0/"><title>Pandas 一列分多列，一行分多行，提取列中的要素，实现vlookup功能等 - Pandas | Black Elk = = 潛龍勿用</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Pandas 一列分多列，一行分多行，提取列中的要素，实现vlookup功能等</h1><div class="meta"><span class="item" title="创建时间：2023-04-18 14:18:50"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-04-18T14:18:50+08:00">2023-04-18</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>9k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>8 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Black Elk</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/204792/12/8149/3437232/614f2ef6E396fc55a/59230b4999b45027.jpg"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/210159/9/2162/2176257/614f2794Ee73cd20b/70e1c3e81b78451c.png"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/108686/33/18722/1731859/614f30aaE6dc81108/c0bb6ea9cfd1e422.jpg"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/88551/40/18217/1443745/614f28eeEf5194d4b/e3596850e3ced6c7.jpg"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/211565/24/2112/853775/614f2f6bE323daee0/6ee70e5cd4e92b3d.jpg"></li><li class="item" data-background-image="https://dd-static.jd.com/ddimg/jfs/t1/197203/3/10015/56462/614f2297E3e08eef3/ba92e3e5447c6265.png"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Pandas/" itemprop="item" rel="index" title="分类于 Pandas"><span itemprop="name">Pandas</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://coloraven.github.io/2023/4/pandas%E4%B8%80%E5%88%97%E5%88%86%E5%A4%9A%E5%88%97%EF%BC%8C%E4%B8%80%E8%A1%8C%E5%88%86%E5%A4%9A%E8%A1%8C%E7%9A%84%E5%AE%9E%E7%8E%B0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="黑麋鹿"><meta itemprop="description" content="潛龍勿用, 折腾之路"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><p>转载自 https://blog.csdn.net/Asher117/article/details/84346073</p><h1 id="摘要"><a class="anchor" href="#摘要">#</a> 摘要</h1><p>在进行数据分析时，我们经常需要把 DataFrame 的一列拆成多列或者根据某列把一行拆成多行，这篇文章主要讲解这两个目标的实现。<br>读取数据<br><img data-src="2023-04-18T142044.png" alt="读取数据"></p><h2 id="一列分多列"><a class="anchor" href="#一列分多列">#</a> 一列分多列</h2><p>将 <code>City</code> 列转成多列（以 <code>|</code> 为分隔符）, 这里使用匿名函数 <code>lambda</code> 来将 <code>City</code> 列拆成两列。<br><img data-src="2023-04-18T142140.png" alt="2023-04-18T142140"></p><h2 id="一行分多行"><a class="anchor" href="#一行分多行">#</a> 一行分多行</h2><p>将 <code>DataFrame</code> 一行拆成多行（以 <code>|</code> 为分隔符）</p><h3 id="方法一"><a class="anchor" href="#方法一">#</a> 方法一</h3><p>在刚刚得到的 DataFrame 基础上操作，如下图所以，可以明显看到我们按照 City 列将 DataFrame 拆成了多行。主要是先将 DataFrame 拆成多列，然后拆成多个 DataFrame 再使用 concat 组合。但是这种方法碰到 City 列切割不均匀的时候可能会麻烦一点，因此，这个时候你可以使用万能方法二。<br><img data-src="2023-04-18T142230.png" alt="2023-04-18T142230"></p><h3 id="方法二"><a class="anchor" href="#方法二">#</a> 方法二</h3><p>这个方法的主要思想是，首先将 DataFrame 中需要拆分的列进行拆分，再使用 stack（）进行轴变换，然后通过 index 来 join 即可，如下所示。<br>首先，将刚刚的 df 还原成原始形式：<br><img data-src="2023-04-18T142307.png" alt="2023-04-18T142307"><br>接下来取出其 City 列，并切分成多列之后轴转换，之后重新设置索引，并且重命名为 Company<br><img data-src="2023-04-18T142324.png" alt="2023-04-18T142324"><br>最后删除 df 里面的 Country 列，并将 DataFrame-df1 使用 join 到 df 里面得到最后的结果。<br><img data-src="2023-04-18T142338.png" alt="2023-04-18T142338"></p><h1 id="正则提取某列的要素并按要素分列"><a class="anchor" href="#正则提取某列的要素并按要素分列">#</a> 正则提取某列的要素并按要素分列</h1><p>有个 csv 表格（以逗号 <code>,</code> 作为分隔符），数据样本如下，其中 <code>电话号码</code> 列中电话号码的个数不确定：</p><table><thead><tr><th>姓名</th><th>性别</th><th>电话号码</th></tr></thead><tbody><tr><td>张三</td><td>男</td><td>电话号码：13788881111;+86-18911112222; 其码：86-17722221111; 其号码:+86 13565459999;86 15366558877</td></tr><tr><td>王五</td><td>女</td><td>16535468764;+77-16888779512;+86 13565457898; 其他 + 87-13544569871</td></tr></tbody></table><p>使用 pandas 库结合正则表达式将第三列中的手机号码提取后每个号码单独成列，与原来的数据一起形成新的行。<br>预期结果：</p><table><thead><tr><th>姓名</th><th>性别</th><th>电话号码</th><th>(0, 0)</th><th>(0, 1)</th><th>(0, 2)</th><th>(0, 3)</th><th>(0, 4)</th></tr></thead><tbody><tr><td>张三</td><td>男</td><td>电话号码：13788881111;+86-18911112222; 其码：86-17722221111; 其号码:+86 13565459999;86 15366558877</td><td>13788881111</td><td>18911112222</td><td>17722221111</td><td>13565459999</td><td>15366558877</td></tr><tr><td>王五</td><td>女</td><td>16535468764;+77-16888779512;+86 13565457898; 其他 + 87-13544569871</td><td>16535468764</td><td>16888779512</td><td>13565457898</td><td>13544569871</td></tr></tbody></table><h2 id="实现代码一"><a class="anchor" href="#实现代码一">#</a> 实现代码一</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 使用简单的正则表达式提取所有的手机号码</span></pre></td></tr><tr><td data-num="6"></td><td><pre>phones <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>extractall<span class="token punctuation">(</span><span class="token string">r'([1][345678][0-9]&#123;9&#125;)'</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 将提取出的 Series 展开为多列</span></pre></td></tr><tr><td data-num="9"></td><td><pre>phones <span class="token operator">=</span> phones<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 将原 df 和 phones 拼接  </span></pre></td></tr><tr><td data-num="12"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df<span class="token punctuation">,</span> phones<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">"abc.xlsx"</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="实现代码二"><a class="anchor" href="#实现代码二">#</a> 实现代码二</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data.csv'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">find_phone_number</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    ph_no <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"[1][345678][0-9]&#123;9&#125;"</span><span class="token punctuation">,</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>ph_no<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>df_phones<span class="token operator">=</span>df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> find_phone_number<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># 将原 df 和 phones 拼接  </span></pre></td></tr><tr><td data-num="11"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df<span class="token punctuation">,</span> df_phones<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">"abc2.xlsx"</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="其他正则表达式"><a class="anchor" href="#其他正则表达式">#</a> 其他正则表达式</h2><p>卡号：</p><pre><code class="language-re">[4][6][0][0-9]\&#123;12\&#125;
</code></pre><p>机身：</p><pre><code class="language-re">[0-9]\&#123;14\&#125;\|[0-9]\&#123;15\&#125;
</code></pre><p>提取 <code>[]</code> 内字符</p><pre><code class="language-re">(?&lt;=\[)[^\[\]]*(?=\])
</code></pre><h1 id="实现vlookup功能"><a class="anchor" href="#实现vlookup功能">#</a> 实现 vlookup 功能</h1><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token string">'Address'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">,</span> <span class="token string">'Sydney'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>df1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Ja1ck'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token string">'Phone'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1234567890'</span><span class="token punctuation">,</span> <span class="token string">'0987654321'</span><span class="token punctuation">,</span> <span class="token string">'0123456789'</span><span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>df2<span class="token punctuation">)</span></pre></td></tr></table></figure><p>输出：</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>Name  Age   Address</pre></td></tr><tr><td data-num="2"></td><td><pre>0  John   30  New York</pre></td></tr><tr><td data-num="3"></td><td><pre>1  Jane   25    London</pre></td></tr><tr><td data-num="4"></td><td><pre>2  Jack   50    Sydney</pre></td></tr><tr><td data-num="5"></td><td><pre>----------------------------------------------------------------------------------------------------</pre></td></tr><tr><td data-num="6"></td><td><pre>    Name       Phone</pre></td></tr><tr><td data-num="7"></td><td><pre>0   John  1234567890</pre></td></tr><tr><td data-num="8"></td><td><pre>1  Ja1ck  0987654321</pre></td></tr><tr><td data-num="9"></td><td><pre>2   Jane  0123456789</pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>result <span class="token operator">=</span> df1<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span> <span class="token comment"># left：保留 df1 的所有行，right：保留 df2 的所有行</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr></table></figure><p>输出:</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>Name  Age   Address       Phone</pre></td></tr><tr><td data-num="2"></td><td><pre>0  John   30  New York  1234567890</pre></td></tr><tr><td data-num="3"></td><td><pre>1  Jane   25    London  0123456789</pre></td></tr><tr><td data-num="4"></td><td><pre>2  Jack   50    Sydney         NaN</pre></td></tr></table></figure><h2 id="pandas的merge知识扩展"><a class="anchor" href="#pandas的merge知识扩展">#</a> pandas 的 merge 知识扩展</h2><p>在 <code>pandas</code> 的 <code>.merge()</code> 方法中， <code>how</code> 参数有几种 <code>JOIN</code> 方法:</p><ol><li>inner - 内连接。默认方法，只保留两个表共有的行。</li><li>outer - 外连接。保留两个表所有行，无匹配的用 NaN 填充。</li><li>left - 左连接。以左表为基准，保留左表所有行，右表无匹配的用 NaN 填充。</li><li>right - 右连接。以右表为基准，保留右表所有行，左表无匹配的用 NaN 填充。</li><li>cross - 笛卡尔乘积。每一个左表行与右表的每一行组合。<br>示例代码:</li></ol><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Jane'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"df1"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>df1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'John'</span><span class="token punctuation">,</span> <span class="token string">'Jack'</span><span class="token punctuation">,</span> <span class="token string">'Mike'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>   <span class="token string">'Address'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'New York'</span><span class="token punctuation">,</span> <span class="token string">'Sydney'</span><span class="token punctuation">,</span> <span class="token string">'London'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"df2"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>df2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># inner join</span></pre></td></tr><tr><td data-num="12"></td><td><pre>result <span class="token operator">=</span> df1<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"inner join"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># outer join  </span></pre></td></tr><tr><td data-num="16"></td><td><pre>result <span class="token operator">=</span> df1<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"outer join"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment"># left join</span></pre></td></tr><tr><td data-num="20"></td><td><pre>result <span class="token operator">=</span> df1<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"left join"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment"># right join</span></pre></td></tr><tr><td data-num="24"></td><td><pre>result <span class="token operator">=</span> df1<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df2<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token string">'Name'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"right join"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment"># cross join  </span></pre></td></tr><tr><td data-num="28"></td><td><pre>result <span class="token operator">=</span> df1<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df2<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'cross'</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">"cross join"</span><span class="token punctuation">,</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">,</span>result<span class="token punctuation">)</span></pre></td></tr></table></figure><p>输出：</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>-------------------------------------------------- df1 -------------------------------------------------- </pre></td></tr><tr><td data-num="2"></td><td><pre>    Name  Age</pre></td></tr><tr><td data-num="3"></td><td><pre>0  John   30</pre></td></tr><tr><td data-num="4"></td><td><pre>1  Jane   25</pre></td></tr><tr><td data-num="5"></td><td><pre>2  Jack   50</pre></td></tr><tr><td data-num="6"></td><td><pre>-------------------------------------------------- df2 -------------------------------------------------- </pre></td></tr><tr><td data-num="7"></td><td><pre>    Name   Address</pre></td></tr><tr><td data-num="8"></td><td><pre>0  John  New York</pre></td></tr><tr><td data-num="9"></td><td><pre>1  Jack    Sydney</pre></td></tr><tr><td data-num="10"></td><td><pre>2  Mike    London</pre></td></tr><tr><td data-num="11"></td><td><pre>-------------------------------------------------- inner join -------------------------------------------------- </pre></td></tr><tr><td data-num="12"></td><td><pre>    Name  Age   Address</pre></td></tr><tr><td data-num="13"></td><td><pre>0  John   30  New York</pre></td></tr><tr><td data-num="14"></td><td><pre>1  Jack   50    Sydney</pre></td></tr><tr><td data-num="15"></td><td><pre>-------------------------------------------------- outer join -------------------------------------------------- </pre></td></tr><tr><td data-num="16"></td><td><pre>    Name   Age   Address</pre></td></tr><tr><td data-num="17"></td><td><pre>0  John  30.0  New York</pre></td></tr><tr><td data-num="18"></td><td><pre>1  Jane  25.0       NaN</pre></td></tr><tr><td data-num="19"></td><td><pre>2  Jack  50.0    Sydney</pre></td></tr><tr><td data-num="20"></td><td><pre>3  Mike   NaN    London</pre></td></tr><tr><td data-num="21"></td><td><pre>-------------------------------------------------- left join -------------------------------------------------- </pre></td></tr><tr><td data-num="22"></td><td><pre>    Name  Age   Address</pre></td></tr><tr><td data-num="23"></td><td><pre>0  John   30  New York</pre></td></tr><tr><td data-num="24"></td><td><pre>1  Jane   25       NaN</pre></td></tr><tr><td data-num="25"></td><td><pre>2  Jack   50    Sydney</pre></td></tr><tr><td data-num="26"></td><td><pre>-------------------------------------------------- right join -------------------------------------------------- </pre></td></tr><tr><td data-num="27"></td><td><pre>    Name   Age   Address</pre></td></tr><tr><td data-num="28"></td><td><pre>0  John  30.0  New York</pre></td></tr><tr><td data-num="29"></td><td><pre>1  Jack  50.0    Sydney</pre></td></tr><tr><td data-num="30"></td><td><pre>2  Mike   NaN    London</pre></td></tr><tr><td data-num="31"></td><td><pre>-------------------------------------------------- cross join -------------------------------------------------- </pre></td></tr><tr><td data-num="32"></td><td><pre>   Name_x  Age Name_y   Address</pre></td></tr><tr><td data-num="33"></td><td><pre>0   John   30   John  New York</pre></td></tr><tr><td data-num="34"></td><td><pre>1   John   30   Jack    Sydney</pre></td></tr><tr><td data-num="35"></td><td><pre>2   John   30   Mike    London</pre></td></tr><tr><td data-num="36"></td><td><pre>3   Jane   25   John  New York</pre></td></tr><tr><td data-num="37"></td><td><pre>4   Jane   25   Jack    Sydney</pre></td></tr><tr><td data-num="38"></td><td><pre>5   Jane   25   Mike    London</pre></td></tr><tr><td data-num="39"></td><td><pre>6   Jack   50   John  New York</pre></td></tr><tr><td data-num="40"></td><td><pre>7   Jack   50   Jack    Sydney</pre></td></tr><tr><td data-num="41"></td><td><pre>8   Jack   50   Mike    London</pre></td></tr></table></figure><h2 id="多行合并一行"><a class="anchor" href="#多行合并一行">#</a> 多行合并一行</h2><p>现有数据如下：</p><table><thead><tr><th>登录 IP</th><th>用户 ID</th><th>登录时间</th><th>操作记录</th></tr></thead><tbody><tr><td>11.1.11.1</td><td>738322</td><td>2022/5/17 11:25</td><td>ABC</td></tr><tr><td>11.1.11.1</td><td>738322</td><td>2022/5/17 11:25</td><td>DEF</td></tr><tr><td>154.2.15.1</td><td>738765</td><td>2022/5/17 11:25</td><td>大大</td></tr><tr><td>11.1.11.3</td><td>738322</td><td>2022/5/17 11:25</td><td>GHI</td></tr></tbody></table><p>使用 pandas 根据条件进行合并，条件是：登录 IP、用户 ID、登录时间三个字段的值都相同的情况下，将操作记录的值从上往下进行合并。<br>预期结果如下表：</p><table><thead><tr><th>登录 IP</th><th>用户 ID</th><th>登录时间</th><th>操作记录</th></tr></thead><tbody><tr><td>11.1.11.1</td><td>738322</td><td>2022/5/17 11:25</td><td>ABCDEF</td></tr><tr><td>154.2.15.1</td><td>738765</td><td>2022/5/17 11:25</td><td>大大</td></tr><tr><td>11.1.11.3</td><td>738322</td><td>2022/5/17 11:25</td><td>GHI</td></tr></tbody></table><p>实现代码：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token string">'登录IP'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'11.1.11.1'</span><span class="token punctuation">,</span> <span class="token string">'11.1.11.1'</span><span class="token punctuation">,</span> <span class="token string">'154.2.15.1'</span><span class="token punctuation">,</span> <span class="token string">'11.1.11.3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token string">'用户ID'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">738322</span><span class="token punctuation">,</span> <span class="token number">738322</span><span class="token punctuation">,</span> <span class="token number">738765</span><span class="token punctuation">,</span> <span class="token number">738322</span><span class="token punctuation">]</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token string">'登录时间'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'2022/5/17 11:25'</span><span class="token punctuation">,</span> <span class="token string">'2022/5/17 11:25'</span><span class="token punctuation">,</span> <span class="token string">'2022/5/17 11:25'</span><span class="token punctuation">,</span> <span class="token string">'2022/5/17 11:25'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token string">'操作记录'</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'ABC'</span><span class="token punctuation">,</span> <span class="token string">'DEF'</span><span class="token punctuation">,</span>  <span class="token string">'大大'</span><span class="token punctuation">,</span> <span class="token string">'GHI'</span><span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>grouped <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'登录IP'</span><span class="token punctuation">,</span> <span class="token string">'用户ID'</span><span class="token punctuation">,</span> <span class="token string">'登录时间'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>result <span class="token operator">=</span> grouped<span class="token punctuation">[</span><span class="token string">'操作记录'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr></table></figure><p>代码解析：</p><ol><li>使用 <code>.groupby()</code> 按照三个字段进行分组</li><li>调用 <code>.agg()</code> , 传入 <code>lambda x: ''.join(x)</code> 对 <code>操作记录</code> 列进行字符串合并</li><li>最终实现了根据条件对指定列合并后的结果表<br>所以，掌握 .groupby () 和 <code>.agg()</code> 这两个方法，可以轻松实现根据条件对指定列 (特别是字符串列) 进行各种统计和处理。<br>在实际工作中，这两个方法可以应用到大量数据处理的场景中，是数据分析和挖掘中的重要工具，熟练运用可以大大提高工作效率和质量。<br>见：<span class="exturl" data-url="aHR0cHM6Ly9zZWdtZW50ZmF1bHQuY29tL3EvMTAxMDAwMDA0MTg1NTYxMi9hLTEwMjAwMDAwNDE4NTU4MzY/X2VhPTIzNjg5NjQ2NA==">https://segmentfault.com/q/1010000041855612/a-1020000041855836?_ea=236896464</span></li></ol><h1 id="qq群成员分析"><a class="anchor" href="#qq群成员分析">#</a> QQ 群成员分析</h1><p>数据样本如下</p><figure class="highlight text"><figcaption data-lang="text"><span>QQ.xlsx</span></figcaption><table><tr><td data-num="1"></td><td><pre>QQ群号	群成员</pre></td></tr><tr><td data-num="2"></td><td><pre>群聊1	9758430</pre></td></tr><tr><td data-num="3"></td><td><pre>群聊1	4559318</pre></td></tr><tr><td data-num="4"></td><td><pre>群聊1	6962205</pre></td></tr><tr><td data-num="5"></td><td><pre>群聊1	4613618</pre></td></tr><tr><td data-num="6"></td><td><pre>群聊1	5734685</pre></td></tr><tr><td data-num="7"></td><td><pre>群聊1	6141414</pre></td></tr><tr><td data-num="8"></td><td><pre>群聊1	323030</pre></td></tr><tr><td data-num="9"></td><td><pre>群聊1	2344021</pre></td></tr><tr><td data-num="10"></td><td><pre>群聊1	7121977</pre></td></tr><tr><td data-num="11"></td><td><pre>群聊1	5081996</pre></td></tr><tr><td data-num="12"></td><td><pre>群聊1	8926421</pre></td></tr><tr><td data-num="13"></td><td><pre>群聊1	6745628</pre></td></tr><tr><td data-num="14"></td><td><pre>群聊1	3863137</pre></td></tr><tr><td data-num="15"></td><td><pre>群聊2	7676445</pre></td></tr><tr><td data-num="16"></td><td><pre>群聊2	6089608</pre></td></tr><tr><td data-num="17"></td><td><pre>群聊2	2995915</pre></td></tr><tr><td data-num="18"></td><td><pre>群聊2	482082</pre></td></tr><tr><td data-num="19"></td><td><pre>群聊2	531802</pre></td></tr><tr><td data-num="20"></td><td><pre>群聊2	4834330</pre></td></tr><tr><td data-num="21"></td><td><pre>群聊2	7692453</pre></td></tr><tr><td data-num="22"></td><td><pre>群聊2	2258744</pre></td></tr><tr><td data-num="23"></td><td><pre>群聊2	1026183</pre></td></tr><tr><td data-num="24"></td><td><pre>群聊2	225674</pre></td></tr><tr><td data-num="25"></td><td><pre>群聊2	7121977</pre></td></tr><tr><td data-num="26"></td><td><pre>群聊2	9926942</pre></td></tr><tr><td data-num="27"></td><td><pre>群聊2	5222292</pre></td></tr><tr><td data-num="28"></td><td><pre>群聊2	7436960</pre></td></tr><tr><td data-num="29"></td><td><pre>群聊2	8227345</pre></td></tr><tr><td data-num="30"></td><td><pre>群聊2	6992045</pre></td></tr><tr><td data-num="31"></td><td><pre>群聊2	8742475</pre></td></tr><tr><td data-num="32"></td><td><pre>群聊3	24016256</pre></td></tr><tr><td data-num="33"></td><td><pre>群聊3	90206526</pre></td></tr><tr><td data-num="34"></td><td><pre>群聊3	48341462</pre></td></tr><tr><td data-num="35"></td><td><pre>群聊3	24684071</pre></td></tr><tr><td data-num="36"></td><td><pre>群聊3	29748179</pre></td></tr><tr><td data-num="37"></td><td><pre>群聊3	6089608</pre></td></tr><tr><td data-num="38"></td><td><pre>群聊3	41037056</pre></td></tr><tr><td data-num="39"></td><td><pre>群聊3	90788423</pre></td></tr><tr><td data-num="40"></td><td><pre>群聊4	437351868</pre></td></tr><tr><td data-num="41"></td><td><pre>群聊4	207182601</pre></td></tr><tr><td data-num="42"></td><td><pre>群聊4	32875139</pre></td></tr><tr><td data-num="43"></td><td><pre>群聊4	371786257</pre></td></tr><tr><td data-num="44"></td><td><pre>群聊4	314738440</pre></td></tr><tr><td data-num="45"></td><td><pre>群聊4	469359518</pre></td></tr><tr><td data-num="46"></td><td><pre>群聊4	915810745</pre></td></tr><tr><td data-num="47"></td><td><pre>群聊4	593472861</pre></td></tr><tr><td data-num="48"></td><td><pre>群聊4	4613618</pre></td></tr><tr><td data-num="49"></td><td><pre>群聊4	90788423</pre></td></tr><tr><td data-num="50"></td><td><pre>群聊4	365482277</pre></td></tr><tr><td data-num="51"></td><td><pre>群聊4	656786903</pre></td></tr><tr><td data-num="52"></td><td><pre>群聊4	826146966</pre></td></tr></table></figure><p>将重复出现在多个群的成员 number 及其所在群展示出来。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"QQ.xlsx"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 找出出现在多个群的成员</span></pre></td></tr><tr><td data-num="6"></td><td><pre>duplicate_members <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'群成员'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token string">'QQ群号'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'群成员'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 展示重复出现的成员及所在的群</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">for</span> member<span class="token punctuation">,</span> groups <span class="token keyword">in</span> duplicate_members<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'成员</span><span class="token interpolation"><span class="token punctuation">&#123;</span>member<span class="token punctuation">&#125;</span></span><span class="token string">在以下群出现: '</span></span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    group_list <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'群成员'</span><span class="token punctuation">]</span> <span class="token operator">==</span> member<span class="token punctuation">,</span> <span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token operator">*</span>group_list<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">', '</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>输出</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>成员90788423在以下群出现: 群聊3, 群聊4</pre></td></tr><tr><td data-num="2"></td><td><pre>成员7121977在以下群出现: 群聊1, 群聊2</pre></td></tr><tr><td data-num="3"></td><td><pre>成员4613618在以下群出现: 群聊1, 群聊4</pre></td></tr><tr><td data-num="4"></td><td><pre>成员6089608在以下群出现: 群聊2, 群聊3</pre></td></tr></table></figure><h2 id="找出只出现在一个群的成员"><a class="anchor" href="#找出只出现在一个群的成员">#</a> 找出只出现在一个群的成员</h2><figure class="highlight py"><figcaption data-lang="Python"></figcaption><table><tr><td data-num="1"></td><td><pre>single_group_members <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token operator">~</span>df<span class="token punctuation">[</span><span class="token string">'群成员'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>duplicate_members<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'只出现在一个群的成员:'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span> member <span class="token keyword">in</span> single_group_members<span class="token punctuation">[</span><span class="token string">'群成员'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span></pre></td></tr></table></figure><p>输出</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>只出现在一个群的成员:</pre></td></tr><tr><td data-num="2"></td><td><pre>9758430</pre></td></tr><tr><td data-num="3"></td><td><pre>4559318</pre></td></tr><tr><td data-num="4"></td><td><pre>6962205</pre></td></tr><tr><td data-num="5"></td><td><pre>5734685</pre></td></tr><tr><td data-num="6"></td><td><pre>6141414</pre></td></tr></table></figure><h2 id="给定另一个群成员number列表查找其是否在前面的群成员列表中"><a class="anchor" href="#给定另一个群成员number列表查找其是否在前面的群成员列表中">#</a> 给定另一个群成员 number 列表，查找其是否在前面的群成员列表中</h2><figure class="highlight py"><figcaption data-lang="Python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"John"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token string">"Jane"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token string">"target"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>readytocompare <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>isin_series <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">"target"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span>readytocompare<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>isin_series</pre></td></tr></table></figure><p>输出：</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>name	target</pre></td></tr><tr><td data-num="2"></td><td><pre>0	John	1</pre></td></tr><tr><td data-num="3"></td><td><pre>1	Alice	2</pre></td></tr></table></figure><h2 id="关系可视化"><a class="anchor" href="#关系可视化">#</a> 关系可视化</h2><figure class="highlight py"><figcaption data-lang="Python"><span>连线完美</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Graph</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>utils <span class="token keyword">import</span> JsCode</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 读取表格数据</span></pre></td></tr><tr><td data-num="7"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"QQ.xlsx"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 创建节点和边的列表</span></pre></td></tr><tr><td data-num="10"></td><td><pre>nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>links <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">for</span> group <span class="token keyword">in</span> df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> group<span class="token punctuation">,</span> <span class="token string">"symbolSize"</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    members <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token operator">==</span>group<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'群成员'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">for</span> other_group <span class="token keyword">in</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token operator">!=</span>group<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        other_members <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token operator">==</span>other_group<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'群成员'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        common_members <span class="token operator">=</span> members <span class="token operator">&amp;</span> other_members</pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">if</span> common_members<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            links<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                <span class="token string">"source"</span><span class="token punctuation">:</span> group<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="21"></td><td><pre>                <span class="token string">"target"</span><span class="token punctuation">:</span> other_group<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="22"></td><td><pre>                <span class="token string">"value"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>common_members<span class="token punctuation">)</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="23"></td><td><pre>                <span class="token string">"common_members"</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">(</span>common_members<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment"># 绘制关系图</span></pre></td></tr><tr><td data-num="27"></td><td><pre>graph <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    Graph<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token punctuation">.</span>add<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token string">""</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        nodes<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        links<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        repulsion<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        edge_label<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="35"></td><td><pre>            position<span class="token operator">=</span><span class="token string">"middle"</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span>JsCode<span class="token punctuation">(</span><span class="token string">"function (params) &#123;return params.data.common_members.join('&lt;br/>')&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> font_size<span class="token operator">=</span><span class="token number">10</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        label_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span>is_show<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"Group Relations"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        tooltip_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TooltipOpts<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            formatter<span class="token operator">=</span>JsCode<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="43"></td><td><pre>                <span class="token string">"function (params) &#123;return 'Group: ' + params.data.name + '&lt;br/>Members: ' + params.data.value.join('&lt;br/>')&#125;"</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>graph<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"group_relations.html"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><figure class="highlight py"><figcaption data-lang="Python"><span>连线不完美</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> pyecharts <span class="token keyword">import</span> options <span class="token keyword">as</span> opts</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> pyecharts<span class="token punctuation">.</span>charts <span class="token keyword">import</span> Graph</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 读取表格数据</span></pre></td></tr><tr><td data-num="6"></td><td><pre>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">"QQ.xlsx"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 创建节点和边的列表</span></pre></td></tr><tr><td data-num="9"></td><td><pre>nodes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>links <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">for</span> group <span class="token keyword">in</span> df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    nodes<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> group<span class="token punctuation">,</span> <span class="token string">"symbolSize"</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    members <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token operator">==</span>group<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'群成员'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">for</span> other_group <span class="token keyword">in</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token operator">!=</span>group<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        other_members <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'QQ群号'</span><span class="token punctuation">]</span><span class="token operator">==</span>other_group<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'群成员'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        common_members <span class="token operator">=</span> members <span class="token operator">&amp;</span> other_members</pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">if</span> common_members<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            links<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                <span class="token string">"source"</span><span class="token punctuation">:</span> group<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="20"></td><td><pre>                <span class="token string">"target"</span><span class="token punctuation">:</span> other_group<span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="21"></td><td><pre>                <span class="token string">"value"</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>common_members<span class="token punctuation">)</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="22"></td><td><pre>                <span class="token string">"common_members"</span><span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">(</span>common_members<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment"># 绘制关系图</span></pre></td></tr><tr><td data-num="26"></td><td><pre>graph <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    Graph<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> nodes<span class="token punctuation">,</span> links<span class="token punctuation">,</span> repulsion<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">,</span> edge_label<span class="token operator">=</span>opts<span class="token punctuation">.</span>LabelOpts<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        position<span class="token operator">=</span><span class="token string">"middle"</span><span class="token punctuation">,</span> formatter<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>common_members<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">,</span> font_size<span class="token operator">=</span><span class="token number">10</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">.</span>set_global_opts<span class="token punctuation">(</span>title_opts<span class="token operator">=</span>opts<span class="token punctuation">.</span>TitleOpts<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"Group Relations"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>graph<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token string">"group_relations.html"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/Python/" rel="tag"><i class="ic i-tag"></i> Python</a> <a href="/tags/Pandas/" rel="tag"><i class="ic i-tag"></i> Pandas</a></div></div><footer><div class="meta"></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2023/4/%E8%A7%A3%E5%86%B3%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E4%B8%8Bgo%E8%AF%AD%E8%A8%80%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96%E9%97%AE%E9%A2%98/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;dd-static.jd.com&#x2F;ddimg&#x2F;jfs&#x2F;t1&#x2F;137825&#x2F;14&#x2F;20589&#x2F;1070350&#x2F;614f313dEb024374b&#x2F;22e215af6b60f493.jpg" title="解决离线环境下go语言项目依赖问题"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Go</span><h3>解决离线环境下go语言项目依赖问题</h3></a></div><div class="item right"><a href="/2023/4/Go%E8%AF%AD%E8%A8%80%E5%B0%86Map%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5EXCEL%E6%96%87%E4%BB%B6/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;dd-static.jd.com&#x2F;ddimg&#x2F;jfs&#x2F;t1&#x2F;91433&#x2F;1&#x2F;18405&#x2F;1805804&#x2F;614f209bE16e73d55&#x2F;fe2c1f0b151036fd.jpg" title="Go语言将Map数据写入EXCEL文件"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Go</span><h3>Go语言将Map数据写入EXCEL文件</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-number">1.</span> <span class="toc-text">摘要</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E5%88%97%E5%88%86%E5%A4%9A%E5%88%97"><span class="toc-number">1.1.</span> <span class="toc-text">一列分多列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E8%A1%8C%E5%88%86%E5%A4%9A%E8%A1%8C"><span class="toc-number">1.2.</span> <span class="toc-text">一行分多行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="toc-number">1.2.1.</span> <span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="toc-number">1.2.2.</span> <span class="toc-text">方法二</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E6%8F%90%E5%8F%96%E6%9F%90%E5%88%97%E7%9A%84%E8%A6%81%E7%B4%A0%E5%B9%B6%E6%8C%89%E8%A6%81%E7%B4%A0%E5%88%86%E5%88%97"><span class="toc-number">2.</span> <span class="toc-text">正则提取某列的要素并按要素分列</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81%E4%B8%80"><span class="toc-number">2.1.</span> <span class="toc-text">实现代码一</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81%E4%BA%8C"><span class="toc-number">2.2.</span> <span class="toc-text">实现代码二</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.3.</span> <span class="toc-text">其他正则表达式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0vlookup%E5%8A%9F%E8%83%BD"><span class="toc-number">3.</span> <span class="toc-text">实现 vlookup 功能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pandas%E7%9A%84merge%E7%9F%A5%E8%AF%86%E6%89%A9%E5%B1%95"><span class="toc-number">3.1.</span> <span class="toc-text">pandas 的 merge 知识扩展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%90%88%E5%B9%B6%E4%B8%80%E8%A1%8C"><span class="toc-number">3.2.</span> <span class="toc-text">多行合并一行</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#qq%E7%BE%A4%E6%88%90%E5%91%98%E5%88%86%E6%9E%90"><span class="toc-number">4.</span> <span class="toc-text">QQ 群成员分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%87%BA%E5%8F%AA%E5%87%BA%E7%8E%B0%E5%9C%A8%E4%B8%80%E4%B8%AA%E7%BE%A4%E7%9A%84%E6%88%90%E5%91%98"><span class="toc-number">4.1.</span> <span class="toc-text">找出只出现在一个群的成员</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%99%E5%AE%9A%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%BE%A4%E6%88%90%E5%91%98number%E5%88%97%E8%A1%A8%E6%9F%A5%E6%89%BE%E5%85%B6%E6%98%AF%E5%90%A6%E5%9C%A8%E5%89%8D%E9%9D%A2%E7%9A%84%E7%BE%A4%E6%88%90%E5%91%98%E5%88%97%E8%A1%A8%E4%B8%AD"><span class="toc-number">4.2.</span> <span class="toc-text">给定另一个群成员 number 列表，查找其是否在前面的群成员列表中</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">4.3.</span> <span class="toc-text">关系可视化</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/12/Pandas%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="bookmark" title="Pandas学习笔记">Pandas学习笔记</a></li><li class="active"><a href="/2023/4/pandas%E4%B8%80%E5%88%97%E5%88%86%E5%A4%9A%E5%88%97%EF%BC%8C%E4%B8%80%E8%A1%8C%E5%88%86%E5%A4%9A%E8%A1%8C%E7%9A%84%E5%AE%9E%E7%8E%B0/" rel="bookmark" title="Pandas 一列分多列，一行分多行，提取列中的要素，实现vlookup功能等">Pandas 一列分多列，一行分多行，提取列中的要素，实现vlookup功能等</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="黑麋鹿" data-src="/images/avatar.jpg"><p class="name" itemprop="name">黑麋鹿</p><div class="description" itemprop="description">折腾之路</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">227</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">47</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">142</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2023/4/%E8%A7%A3%E5%86%B3%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E4%B8%8Bgo%E8%AF%AD%E8%A8%80%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96%E9%97%AE%E9%A2%98/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2023/4/Go%E8%AF%AD%E8%A8%80%E5%B0%86Map%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5EXCEL%E6%96%87%E4%BB%B6/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">918k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">13:55</span></div><div class="powered-by">基于 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & Theme.<a href="https://github.com/amehime/hexo-theme-shoka" rel="noopener" target="_blank">Shoka</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/4/pandas一列分多列，一行分多行的实现/",favicon:{show:"BlackELK",hide:"看看再走吧"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->