<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>转载-Kali Linux科学上网 - 我的全新 Hugo 网站</title><meta name="Description" content="这是我的全新 Hugo 网站"><meta property="og:title" content="转载-Kali Linux科学上网" />
<meta property="og:description" content="转载自：https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux科学上网/ 用于备份该文章，以免源博客文章突然消失后找不到。 本文只讲解 Kali Linux 下针对SS和 SSR的客户端配置。由于 Kali 基于 Debian，所以其它基于 Debian 的 Linux 类似，例如Ubuntu。
关于科学上网的具体介绍请参见我的另一篇博客 科学上网。本文是它的子集
温馨提示：如果你的 Kali Linux 在虚拟机中且主机已经实现了科学上网，那么你没必要再折腾，直接使用通过已经可以科学上网的电脑实现科学上网这个方法即可
SS 本部分最后更新时间：2018-04-08。
shadowsocks-qt5 2019-07-02更新： 客户端选择shadowsocks-qt5是因为它简单，界面友好（好吧，是因为当初只听说过它）。现在的我更倾向于使用shadowsocks-libev作为客户端，因为它最近一次更新在 2019 年 7 月，而 shadowsocks（即原始的 Python 版）最后更新时间是 2018 年 10 月，shadowsocks-qt5 最近一次更新则是在 2018 年 8 月
具体环境说明：
客户端操作系统：Kali-Linux
使用的 shadowsocks 实现（客户端）：shadowsocks-qt5 使用的用户：root 另外，对于其它的 shadowsocks 实现，参考相应的官网文档操作即可。它们的官网链接在Shadowsocks - Implementations页面中
简介 Shadowsocks-Qt5 is a native and cross-platform shadowsocks GUI client with advanced features.
Features Shadowsocks-Qt5 is written in C&#43;&#43; with Qt 5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-27T09:29:58+00:00" />
<meta property="article:modified_time" content="2021-08-27T09:29:58+00:00" /><meta property="og:site_name" content="我的网站" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="转载-Kali Linux科学上网"/>
<meta name="twitter:description" content="转载自：https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux科学上网/ 用于备份该文章，以免源博客文章突然消失后找不到。 本文只讲解 Kali Linux 下针对SS和 SSR的客户端配置。由于 Kali 基于 Debian，所以其它基于 Debian 的 Linux 类似，例如Ubuntu。
关于科学上网的具体介绍请参见我的另一篇博客 科学上网。本文是它的子集
温馨提示：如果你的 Kali Linux 在虚拟机中且主机已经实现了科学上网，那么你没必要再折腾，直接使用通过已经可以科学上网的电脑实现科学上网这个方法即可
SS 本部分最后更新时间：2018-04-08。
shadowsocks-qt5 2019-07-02更新： 客户端选择shadowsocks-qt5是因为它简单，界面友好（好吧，是因为当初只听说过它）。现在的我更倾向于使用shadowsocks-libev作为客户端，因为它最近一次更新在 2019 年 7 月，而 shadowsocks（即原始的 Python 版）最后更新时间是 2018 年 10 月，shadowsocks-qt5 最近一次更新则是在 2018 年 8 月
具体环境说明：
客户端操作系统：Kali-Linux
使用的 shadowsocks 实现（客户端）：shadowsocks-qt5 使用的用户：root 另外，对于其它的 shadowsocks 实现，参考相应的官网文档操作即可。它们的官网链接在Shadowsocks - Implementations页面中
简介 Shadowsocks-Qt5 is a native and cross-platform shadowsocks GUI client with advanced features.
Features Shadowsocks-Qt5 is written in C&#43;&#43; with Qt 5."/>
<meta name="application-name" content="我的网站">
<meta name="apple-mobile-web-app-title" content="我的网站"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://example.org/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" /><link rel="prev" href="http://example.org/panda%E6%A0%B8%E5%BF%83%E7%A8%8B%E5%BA%8F%E8%AE%BE%E7%BD%AE%E6%88%90%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/" /><link rel="next" href="http://example.org/%E5%8D%8E%E4%B8%BAhisuite%E5%A4%87%E4%BB%BD%E8%A7%A3%E5%AF%86/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "转载-Kali Linux科学上网",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/example.org\/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91\/"
        },"genre": "posts","wordcount":  1651 ,
        "url": "http:\/\/example.org\/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91\/","datePublished": "2021-08-27T09:29:58+00:00","dateModified": "2021-08-27T09:29:58+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "五彩斑斓的黑"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="我的全新 Hugo 网站"></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="我的全新 Hugo 网站"></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">转载-Kali Linux科学上网</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>五彩斑斓的黑</a></span>&nbsp;<span class="post-category">included in <a href="/categories/vpn/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>VPN</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2021-08-27">2021-08-27</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1651 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;8 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ss">SS</a>
      <ul>
        <li><a href="#shadowsocks-qt5httpswsxq255555ioblog20181020kali-linux科学上网使用-shadowsocks-qt5">shadowsocks-qt5<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E4%BD%BF%E7%94%A8-shadowsocks-qt5"></a></a>
          <ul>
            <li><a href="#简介httpswsxq255555ioblog20181020kali-linux科学上网简介">简介<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E7%AE%80%E4%BB%8B"></a></a></li>
          </ul>
        </li>
        <li><a href="#features">Features</a>
          <ul>
            <li><a href="#安装httpswsxq255555ioblog20181020kali-linux科学上网安装">安装<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E5%AE%89%E8%A3%85"></a></a></li>
            <li><a href="#配置httpswsxq255555ioblog20181020kali-linux科学上网配置">配置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E9%85%8D%E7%BD%AE"></a></a></li>
            <li><a href="#设置">设置</a></li>
            <li><a href="#优化httpswsxq255555ioblog20181020kali-linux科学上网优化">优化<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E4%BC%98%E5%8C%96"></a></a></li>
          </ul>
        </li>
        <li><a href="#shadowsocks-libevhttpswsxq255555ioblog20181020kali-linux科学上网使用-shadowsocks-libev">shadowsocks-libev<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E4%BD%BF%E7%94%A8-shadowsocks-libev"></a></a>
          <ul>
            <li><a href="#简介httpswsxq255555ioblog20181020kali-linux科学上网简介-1">简介<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E7%AE%80%E4%BB%8B-1"></a></a></li>
            <li><a href="#安装httpswsxq255555ioblog20181020kali-linux科学上网安装-1">安装<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E5%AE%89%E8%A3%85-1"></a></a></li>
            <li><a href="#配置httpswsxq255555ioblog20181020kali-linux科学上网配置-1">配置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E9%85%8D%E7%BD%AE-1"></a></a></li>
            <li><a href="#控制httpswsxq255555ioblog20181020kali-linux科学上网控制">控制<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E6%8E%A7%E5%88%B6"></a></a></li>
            <li><a href="#查看日志httpswsxq255555ioblog20181020kali-linux科学上网查看日志">查看日志<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97"></a></a></li>
            <li><a href="#后续步骤httpswsxq255555ioblog20181020kali-linux科学上网后续步骤">后续步骤<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E5%90%8E%E7%BB%AD%E6%AD%A5%E9%AA%A4"></a></a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#ssrhttpswsxq255555ioblog20181020kali-linux科学上网ssr">SSR<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#ssr"></a></a>
      <ul>
        <li><a href="#shadowsocksrpython-版">shadowsocksr（Python 版）（</a>
          <ul>
            <li><a href="#安装httpswsxq255555ioblog20181020kali-linux科学上网安装-2">安装<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E5%AE%89%E8%A3%85-2"></a></a></li>
            <li><a href="#配置httpswsxq255555ioblog20181020kali-linux科学上网配置-2">配置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E9%85%8D%E7%BD%AE-2"></a></a></li>
            <li><a href="#启动httpswsxq255555ioblog20181020kali-linux科学上网启动">启动<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E5%90%AF%E5%8A%A8"></a></a></li>
            <li><a href="#测试httpswsxq255555ioblog20181020kali-linux科学上网测试">测试<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E6%B5%8B%E8%AF%95"></a></a></li>
            <li><a href="#自动化httpswsxq255555ioblog20181020kali-linux科学上网自动化">自动化<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E8%87%AA%E5%8A%A8%E5%8C%96"></a></a></li>
            <li><a href="#后续步骤httpswsxq255555ioblog20181020kali-linux科学上网后续步骤-1">后续步骤<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E5%90%8E%E7%BB%AD%E6%AD%A5%E9%AA%A4-1"></a></a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#pc-连接到ssr-localhttpswsxq255555ioblog20181020kali-linux科学上网pc-连接到-ssr-local">PC 连接到SSR Local<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#pc-%E8%BF%9E%E6%8E%A5%E5%88%B0-ssr-local"></a></a>
      <ul>
        <li><a href="#浏览器全局代理httpswsxq255555ioblog20181020kali-linux科学上网浏览器全局代理">浏览器全局代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86"></a></a></li>
        <li><a href="#系统全局代理httpswsxq255555ioblog20181020kali-linux科学上网系统全局代理">系统全局代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E7%B3%BB%E7%BB%9F%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86"></a></a></li>
        <li><a href="#真系统全局代理透明代理httpswsxq255555ioblog20181020kali-linux科学上网真系统全局代理透明代理">真·系统全局代理（透明代理）<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E7%9C%9F%E7%B3%BB%E7%BB%9F%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86"></a></a></li>
        <li><a href="#通过-socks-代理进行-dns-查询httpswsxq255555ioblog20181020kali-linux科学上网通过-socks-代理进行-dns-查询">通过 SOCKS 代理进行 DNS 查询<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E9%80%9A%E8%BF%87-socks-%E4%BB%A3%E7%90%86%E8%BF%9B%E8%A1%8C-dns-%E6%9F%A5%E8%AF%A2"></a></a></li>
        <li><a href="#转换-socks-代理为-http-代理httpswsxq255555ioblog20181020kali-linux科学上网转换-socks-代理为-http-代理">转换 SOCKS 代理为 HTTP 代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E8%BD%AC%E6%8D%A2-socks-%E4%BB%A3%E7%90%86%E4%B8%BA-http-%E4%BB%A3%E7%90%86"></a></a></li>
        <li><a href="#浏览器自动代理httpswsxq255555ioblog20181020kali-linux科学上网浏览器自动代理">浏览器自动代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E4%BB%A3%E7%90%86"></a></a></li>
        <li><a href="#pac代理自动配置httpswsxq255555ioblog20181020kali-linux科学上网pac代理自动配置">PAC（代理自动配置）<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#pac%E4%BB%A3%E7%90%86%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE"></a></a></li>
        <li><a href="#关于终端下的代理设置httpswsxq255555ioblog20181020kali-linux科学上网关于终端下的代理设置">关于终端下的代理设置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E5%85%B3%E4%BA%8E%E7%BB%88%E7%AB%AF%E4%B8%8B%E7%9A%84%E4%BB%A3%E7%90%86%E8%AE%BE%E7%BD%AE"></a></a>
          <ul>
            <li><a href="#终端代理环境变量httpswsxq255555ioblog20181020kali-linux科学上网终端代理环境变量">终端代理环境变量<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"></a></a></li>
            <li><a href="#使用程序的代理相关参数httpswsxq255555ioblog20181020kali-linux科学上网使用程序的代理相关参数">使用程序的代理相关参数<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E4%BD%BF%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%BB%A3%E7%90%86%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0"></a></a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#通过已经可以科学上网的电脑实现科学上网httpswsxq255555ioblog20181020kali-linux科学上网通过已经可以科学上网的电脑实现科学上网">通过已经可以科学上网的电脑实现科学上网<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E9%80%9A%E8%BF%87%E5%B7%B2%E7%BB%8F%E5%8F%AF%E4%BB%A5%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E7%9A%84%E7%94%B5%E8%84%91%E5%AE%9E%E7%8E%B0%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91"></a></a></li>
    <li><a href="#链接httpswsxq255555ioblog20181020kali-linux科学上网链接">链接<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E9%93%BE%E6%8E%A5"></a></a></li>
    <li><a href="#缩略语httpswsxq255555ioblog20181020kali-linux科学上网缩略语">缩略语<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#%E7%BC%A9%E7%95%A5%E8%AF%AD"></a></a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>转载自：https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux科学上网/
用于备份该文章，以免源博客文章突然消失后找不到。
本文只讲解 Kali Linux 下针对<code>SS</code>和 <code>SSR</code>的客户端配置。由于 Kali 基于 Debian，所以其它基于 Debian 的 Linux 类似，例如Ubuntu。</p>
<p>关于科学上网的具体介绍请参见我的另一篇博客 <a href="https://wsxq2.55555.io/blog/2019/07/07/%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91" target="_blank" rel="noopener noreffer ">科学上网</a>。本文是它的子集</p>
<p><strong>温馨提示</strong>：如果你的 Kali Linux 在虚拟机中且主机已经实现了科学上网，那么你没必要再折腾，直接使用<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e9%80%9a%e8%bf%87%e5%b7%b2%e7%bb%8f%e5%8f%af%e4%bb%a5%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91%e7%9a%84%e7%94%b5%e8%84%91%e5%ae%9e%e7%8e%b0%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91" target="_blank" rel="noopener noreffer ">通过已经可以科学上网的电脑实现科学上网</a>这个方法即可</p>
<h2 id="ss">SS</h2>
<p>本部分最后更新时间：2018-04-08。</p>
<h3 id="shadowsocks-qt5httpswsxq255555ioblog20181020kali-linux科学上网使用-shadowsocks-qt5">shadowsocks-qt5<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e4%bd%bf%e7%94%a8-shadowsocks-qt5" target="_blank" rel="noopener noreffer "></a></h3>
<p>2019-07-02更新： 客户端选择<code>shadowsocks-qt5</code>是因为它简单，界面友好（好吧，是因为当初只听说过它）。现在的我更倾向于使用<code>shadowsocks-libev</code>作为客户端，因为它最近一次更新在 2019 年 7 月，而 shadowsocks（即原始的 Python 版）最后更新时间是 2018 年 10 月，shadowsocks-qt5 最近一次更新则是在 2018 年 8 月</p>
<p>具体环境说明：</p>
<ul>
<li>
<p>客户端操作系统：Kali-Linux</p>
<ul>
<li>使用的 shadowsocks 实现（客户端）：<a href="https://github.com/shadowsocks/shadowsocks-qt5" target="_blank" rel="noopener noreffer ">shadowsocks-qt5</a></li>
<li>使用的用户：root</li>
</ul>
</li>
</ul>
<p>另外，对于其它的 shadowsocks 实现，参考相应的官网文档操作即可。它们的官网链接在<a href="https://shadowsocks.org/en/spec/Implementations.html" target="_blank" rel="noopener noreffer ">Shadowsocks - Implementations</a>页面中</p>
<h4 id="简介httpswsxq255555ioblog20181020kali-linux科学上网简介">简介<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e7%ae%80%e4%bb%8b" target="_blank" rel="noopener noreffer "></a></h4>
<blockquote>
<p>Shadowsocks-Qt5 is a native and cross-platform shadowsocks GUI client with advanced features.</p>
<h3 id="features">Features</h3>
<ul>
<li>Shadowsocks-Qt5 is written in C++ with Qt 5.</li>
<li>Support traffic statistics</li>
<li>Support server latency (lag) test</li>
<li>Use multiple profiles simultaneously</li>
<li>config.ini is located under ~/.config/shadowsocks-qt5/ on *nix platforms, or under the application’s directory on Windows.</li>
</ul>
<p>——引用自<a href="https://github.com/shadowsocks/shadowsocks-qt5" target="_blank" rel="noopener noreffer ">shadowsocks/shadowsocks-qt5: A cross-platform shadowsocks GUI client</a></p>
</blockquote>
<h4 id="安装httpswsxq255555ioblog20181020kali-linux科学上网安装">安装<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e5%ae%89%e8%a3%85" target="_blank" rel="noopener noreffer "></a></h4>
<ol>
<li>在<code>/etc/apt/sources.list</code>文件末尾添加: <code>deb http://ppa.launchpad.net/hzwhuang/ss-qt5/ubuntu devel main</code></li>
<li>更新 apt 软件列表：</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">    apt update <span class="c1">#这里会提示错误，以下两步解决该错误</span>
</span></span><span class="line"><span class="cl">     gpg --keyserver keyserver.ubuntu.com --recv 6DA746A05F00FA99
</span></span><span class="line"><span class="cl">     gpg --export --armor 6DA746A05F00FA99 <span class="p">|</span> sudo apt-key add -
</span></span><span class="line"><span class="cl">     apt update <span class="c1">#这一步成功后便可安装shadowsocks-qt5了</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>安装shadowsocks-qt5: <code>apt install shadowsocks-qt5 </code>。</li>
</ol>
<h4 id="配置httpswsxq255555ioblog20181020kali-linux科学上网配置">配置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e9%85%8d%e7%bd%ae" target="_blank" rel="noopener noreffer "></a></h4>
<ol>
<li>
<p>安装后在<code>bash</code>中输入<code>ss-qt5</code>, 完成配置, 配置好后的图如下：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/ss-qt5%e4%b8%bb%e7%95%8c%e9%9d%a2.png"
        data-srcset="http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/ss-qt5%e4%b8%bb%e7%95%8c%e9%9d%a2.png, http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/ss-qt5%e4%b8%bb%e7%95%8c%e9%9d%a2.png 1.5x, http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/ss-qt5%e4%b8%bb%e7%95%8c%e9%9d%a2.png 2x"
        data-sizes="auto"
        alt="http://wsxq12.55555.io/Kali-Linux科学上网/ss-qt5主界面.png"
        title="ss-qt5" /></p>
<p>图中使用的服务器账号是我花<strong>180元/年</strong>租用的搬瓦工的
VPS (见下图)（大家也可以搭建一个属于自己的
SS 服务器，可以学到不少东西）</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/bwg%e4%b8%bb%e6%9c%ba%e4%bf%a1%e6%81%af%e7%95%8c%e9%9d%a2.png"
        data-srcset="http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/bwg%e4%b8%bb%e6%9c%ba%e4%bf%a1%e6%81%af%e7%95%8c%e9%9d%a2.png, http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/bwg%e4%b8%bb%e6%9c%ba%e4%bf%a1%e6%81%af%e7%95%8c%e9%9d%a2.png 1.5x, http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/bwg%e4%b8%bb%e6%9c%ba%e4%bf%a1%e6%81%af%e7%95%8c%e9%9d%a2.png 2x"
        data-sizes="auto"
        alt="http://wsxq12.55555.io/Kali-Linux科学上网/bwg主机信息界面.png"
        title="bwg" /></p>
</li>
</ol>
<h4 id="设置">设置</h4>
<p>PAC<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e8%ae%be%e7%bd%ae-pac" target="_blank" rel="noopener noreffer "></a></p>
<ol>
<li>
<p>获得 pac 文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">  pip install genpac
</span></span><span class="line"><span class="cl">  pip install --upgrade genpac
</span></span><span class="line"><span class="cl">  mkdir ~/vpnPAC
</span></span><span class="line"><span class="cl">  <span class="nb">cd</span> ~/vpnPAC
</span></span><span class="line"><span class="cl">  touch user-rules.txt
</span></span><span class="line"><span class="cl">  genpac -p <span class="s2">&#34;SOCKS5 127.0.0.1:1080&#34;</span> --gfwlist-proxy<span class="o">=</span><span class="s2">&#34;SOCKS5 127.0.0.1:1080&#34;</span> --output<span class="o">=</span><span class="s2">&#34;autoproxy.pac&#34;</span> --gfwlist-url<span class="o">=</span><span class="s2">&#34;https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt&#34;</span> --user-rule-from<span class="o">=</span><span class="s2">&#34;user-rules.txt&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>系统设置自动代理: <strong>设置-&gt;网络-&gt;网络代理</strong>，<strong>方式</strong>改为<strong>自动</strong>，<strong>配置
URL</strong>改为：<code>file://root/vpnPAC/autoproxy.pac</code></p>
</li>
</ol>
<h4 id="优化httpswsxq255555ioblog20181020kali-linux科学上网优化">优化<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e4%bc%98%e5%8c%96" target="_blank" rel="noopener noreffer "></a></h4>
<ol>
<li>设置开机启动：通过<code>kali linux</code>自带的优化工具实现: <code>Win+a</code>, 直接输入优化工具，出现优化工具图标（当然你也可以自己找），双击，找到开机启动程序，添加<code>shadowsock-qt5</code></li>
<li>自动连接某个节点：打开<code>bash</code>，输入<code>ss-qt5</code>，<strong>右键某个节点-&gt;编辑-&gt;程序启动时自动连接</strong></li>
<li>通过快捷键开启或关闭shadowsocks-qt5: <strong>设置-&gt;键盘-&gt;添加自定义快捷键</strong>（滑到最下面你会看到一个<code>+</code>）， <strong>名字</strong>可以随意，<strong>命令</strong>输入<code>ss-qt5</code>（关闭时输入<code>pkill ss-qt5</code>），<strong>按键</strong>设置成你喜欢的即可。</li>
</ol>
<h3 id="shadowsocks-libevhttpswsxq255555ioblog20181020kali-linux科学上网使用-shadowsocks-libev">shadowsocks-libev<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e4%bd%bf%e7%94%a8-shadowsocks-libev" target="_blank" rel="noopener noreffer "></a></h3>
<h4 id="简介httpswsxq255555ioblog20181020kali-linux科学上网简介-1">简介<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e7%ae%80%e4%bb%8b-1" target="_blank" rel="noopener noreffer "></a></h4>
<blockquote>
<p>shadowsocks-libev 是一个 shadowsocks 协议的轻量级实现，是 shadowsocks-android, shadowsocks-ios 以及 shadowsocks-openwrt 的上游项目。其具有以下特点：</p>
<ul>
<li>
<p>体积小巧，静态编译并打包后只有 100 KB。</p>
</li>
<li>
<p>高并发，基于 libev 实现的异步 I/O，以及基于线程池的异步 DNS，同时连接数可上万。</p>
</li>
<li>
<p>低资源占用，几乎不占用 CPU 资源，服务器端内存占用一般在 3MB 左右。</p>
</li>
<li>
<p>跨平台，适用于所有常见硬件平台，已测试通过的包括 x86 ARM 和 MIPS。也适用于大部分 POSIX 的操作系统或平台，包括 Linux，OS X 和 gwin 等。</p>
</li>
<li>
<p>协议及配置兼容，完全兼容 shadowsocks 协议，且兼容标准实现中的 JSON 风格配置文件，可与任意实现的 shadowsocks 端或服务端搭配使用。</p>
</li>
</ul>
<p>——引用自<a href="https://roxhaiy.wordpress.com/2017/08/04/430/" target="_blank" rel="noopener noreffer ">CentOS 7 配置 shadowsocks-libev 服务器端进行科学上网 | 鸣沙山侧 月牙泉畔</a></p>
</blockquote>
<h4 id="安装httpswsxq255555ioblog20181020kali-linux科学上网安装-1">安装<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e5%ae%89%e8%a3%85-1" target="_blank" rel="noopener noreffer "></a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install shadowsocks-libev
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看该软件包中有哪些文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">dpkg -l shadowsocks-libev
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="配置httpswsxq255555ioblog20181020kali-linux科学上网配置-1">配置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e9%85%8d%e7%bd%ae-1" target="_blank" rel="noopener noreffer "></a></h4>
<p>修改配置文件<code>/etc/shadowsocks-libev/config.json</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;server&#34;</span><span class="p">:</span><span class="s2">&#34;serverip&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;server_port&#34;</span><span class="p">:</span><span class="mi">1234</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;local_address&#34;</span><span class="p">:</span> <span class="s2">&#34;0.0.0.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;local_port&#34;</span><span class="p">:</span><span class="mi">1080</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;shadowsocks&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;timeout&#34;</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;method&#34;</span><span class="p">:</span><span class="s2">&#34;aes-256-cfb&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="控制httpswsxq255555ioblog20181020kali-linux科学上网控制">控制<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e6%8e%a7%e5%88%b6" target="_blank" rel="noopener noreffer "></a></h4>
<p>使用如下命令启动：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl start shadowsocks-libev-local@config
</span></span></code></pre></td></tr></table>
</div>
</div><p>其中<code>config</code>是你的配置文件的名字（<code>config.json</code>），如果变了，则这里也需要变</p>
<p>使用如下命令设置开机自启：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl <span class="nb">enable</span> shadowsocks-libev-local@config
</span></span></code></pre></td></tr></table>
</div>
</div><p>……</p>
<h4 id="查看日志httpswsxq255555ioblog20181020kali-linux科学上网查看日志">查看日志<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e6%9f%a5%e7%9c%8b%e6%97%a5%e5%bf%97" target="_blank" rel="noopener noreffer "></a></h4>
<ul>
<li><code>/var/log/syslog</code></li>
<li><code>journalctl -u shadowsocks-libev-local@config</code></li>
</ul>
<h4 id="后续步骤httpswsxq255555ioblog20181020kali-linux科学上网后续步骤">后续步骤<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e5%90%8e%e7%bb%ad%e6%ad%a5%e9%aa%a4" target="_blank" rel="noopener noreffer "></a></h4>
<p>参见 <a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#pc-%e8%bf%9e%e6%8e%a5%e5%88%b0-ssr-local" target="_blank" rel="noopener noreffer ">PC 连接到 SSR Local</a></p>
<h2 id="ssrhttpswsxq255555ioblog20181020kali-linux科学上网ssr">SSR<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#ssr" target="_blank" rel="noopener noreffer "></a></h2>
<p>SSR 的诸多实现如下（和
SS 类似）：</p>
<table>
<thead>
<tr>
<th>实现</th>
<th>编程语言</th>
<th>适用平台</th>
<th>最近一次更新</th>
<th>服务器 or 客户端</th>
</tr>
</thead>
<tbody>
<tr>
<td>shadowsocksr</td>
<td>Python</td>
<td>Linux, OSX</td>
<td>2018-05</td>
<td>both</td>
</tr>
<tr>
<td>shadowsocksr-libev</td>
<td>C</td>
<td>Linux, OSX, openwrt</td>
<td>2018-03</td>
<td>both</td>
</tr>
<tr>
<td>shadowsocksr-android</td>
<td>Java,Go</td>
<td>Android</td>
<td>2018-03</td>
<td>client</td>
</tr>
<tr>
<td>shadowsocks-csharp</td>
<td>C#</td>
<td>Windows</td>
<td>2018-04</td>
<td>client</td>
</tr>
<tr>
<td>electron-ssr</td>
<td>JavaScript, Vue</td>
<td>Linux, OSX, Windows</td>
<td>2019-05</td>
<td>client</td>
</tr>
</tbody>
</table>
<h3 id="shadowsocksrpython-版">shadowsocksr（Python 版）（</h3>
<p>SSR Local 连接到</p>
<p>SSR Server<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#shadowsocksrpython-%e7%89%88ssr-local-%e8%bf%9e%e6%8e%a5%e5%88%b0-ssr-server" target="_blank" rel="noopener noreffer "></a></p>
<ul>
<li>
<p>操作系统：Kali Linux。实际上只要是 Linux 将本文内容稍加修改也适用。毕竟核心的东西是不变的</p>
<ul>
<li>
<p>使用的</p>
<p>SSR 客户端：shadowsocksr（Python 版）。</p>
</li>
</ul>
</li>
</ul>
<p>2019-07-05 更新： 该部分阐述了如何让
SSR Local 连接到
SSR Server。在
SSR Local 和
SSR Server 通信的过程中使用的协议为
SSR</p>
<p>之所以使用 Python 版，是因为我只找到 Python 版的，/笑哭。 这一步是最重要的，后面的方法都建立在这个基础之上</p>
<p>2019-07-03 更新：事实上，
SSR 现在可用的 Linux 客户端有三个，shadowsocksr, shadowsocksr-libev, electron-ssr，参见前文的表格</p>
<h4 id="安装httpswsxq255555ioblog20181020kali-linux科学上网安装-2">安装<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e5%ae%89%e8%a3%85-2" target="_blank" rel="noopener noreffer "></a></h4>
<p>获得 Python 版
SSR 的相关文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/
</span></span><span class="line"><span class="cl">git clone https://github.com/shadowsocksrr/shadowsocksr
</span></span></code></pre></td></tr></table>
</div>
</div><p>经测试，其实只有 shadowsocksr 下的 shadowsocks 目录是必须的</p>
<h4 id="配置httpswsxq255555ioblog20181020kali-linux科学上网配置-2">配置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e9%85%8d%e7%bd%ae-2" target="_blank" rel="noopener noreffer "></a></h4>
<p>根据你的服务器配置修改配置文件<code>~/shadowsocksr/config.json</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;server&#34;</span><span class="p">:</span> <span class="s2">&#34;&lt;ip address&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;server_ipv6&#34;</span><span class="p">:</span> <span class="s2">&#34;::&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;server_port&#34;</span><span class="p">:</span> <span class="mi">8388</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;local_address&#34;</span><span class="p">:</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;local_port&#34;</span><span class="p">:</span> <span class="mi">1080</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;password&#34;</span><span class="p">:</span> <span class="s2">&#34;password&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;method&#34;</span><span class="p">:</span> <span class="s2">&#34;none&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;protocol&#34;</span><span class="p">:</span> <span class="s2">&#34;auth_chain_a&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;protocol_param&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;obfs&#34;</span><span class="p">:</span> <span class="s2">&#34;plain&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;obfs_param&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;speed_limit_per_con&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;speed_limit_per_user&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;additional_ports&#34;</span> <span class="p">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;additional_ports_only&#34;</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;timeout&#34;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;udp_timeout&#34;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;dns_ipv6&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;connect_verbose_info&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;redirect&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fast_open&#34;</span><span class="p">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="启动httpswsxq255555ioblog20181020kali-linux科学上网启动">启动<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e5%90%af%e5%8a%a8" target="_blank" rel="noopener noreffer "></a></h4>
<p>启动
SSR客户端：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/shadowsocksr/shadowsocks
</span></span><span class="line"><span class="cl">python2 local.py -c ~/shadowsocksr/config.json
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="测试httpswsxq255555ioblog20181020kali-linux科学上网测试">测试<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e6%b5%8b%e8%af%95" target="_blank" rel="noopener noreffer "></a></h4>
<p>下面的每个步骤都建立在前一个步骤成功的基础上：</p>
<ol>
<li>
<p>使用命令<code>ss -ltn | grep 1080</code>，其输出应当如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">LISTEN     <span class="m">0</span>      <span class="m">128</span>          127.0.0.1:1080                     *:*
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果失败，说明启动失败，可能是配置文件错误导致的</p>
</li>
<li>
<p>使用浏览器进行测试，即选择 <a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e6%b5%8f%e8%a7%88%e5%99%a8%e5%85%a8%e5%b1%80%e4%bb%a3%e7%90%86" target="_blank" rel="noopener noreffer ">浏览器全局代理</a> 这部分的方法进行测试</p>
<p>如果失败，则可能是服务器连不上导致的</p>
</li>
</ol>
<h4 id="自动化httpswsxq255555ioblog20181020kali-linux科学上网自动化">自动化<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e8%87%aa%e5%8a%a8%e5%8c%96" target="_blank" rel="noopener noreffer "></a></h4>
<p>每次手动启动实在太麻烦，可以写个脚本让它在打开终端时自动启动，也可以让它开机自启。对于前者，可将如下bash脚本添加到<code>~/.bashrc</code>文件中（我自己写的，欢迎提建议）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> pg<span class="o">(){</span>
</span></span><span class="line"><span class="cl">  ps aux <span class="p">|</span> grep -v <span class="s2">&#34;grep&#34;</span> <span class="p">|</span>grep <span class="nv">$1</span> 
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> ssr<span class="o">(){</span>
</span></span><span class="line"><span class="cl">	ps aux <span class="p">|</span>grep <span class="s2">&#34;[l]ocal\.py&#34;</span> &gt; /dev/null
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> -eq <span class="m">1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">		python ~/shadowsocksr/shadowsocks/local.py -c ~/shadowsocksr/config.json -d start
</span></span><span class="line"><span class="cl">	<span class="k">else</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">			<span class="nb">kill</span> <span class="sb">`</span>pg <span class="s2">&#34;local\.py&#34;</span> <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span></span><span class="line"><span class="cl">		<span class="k">else</span>
</span></span><span class="line"><span class="cl">			<span class="nb">echo</span> <span class="s2">&#34;ssr has been run!&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="k">fi</span>
</span></span><span class="line"><span class="cl">	<span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">ssr
</span></span></code></pre></td></tr></table>
</div>
</div><p>简要说一下上面那个函数<code>ssr</code>的用法：直接在 bash 中输入<code>ssr</code>后回车则后台启动（关闭终端也能继续运行）ssr客户端，输入<code>ssr &lt;任意字符&gt;</code>则关闭已启动的ssr客户端。</p>
<h4 id="后续步骤httpswsxq255555ioblog20181020kali-linux科学上网后续步骤-1">后续步骤<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e5%90%8e%e7%bb%ad%e6%ad%a5%e9%aa%a4-1" target="_blank" rel="noopener noreffer "></a></h4>
<p>参见 <a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#pc-%e8%bf%9e%e6%8e%a5%e5%88%b0-ssr-local" target="_blank" rel="noopener noreffer ">PC 连接到
SSR Local</a></p>
<h2 id="pc-连接到ssr-localhttpswsxq255555ioblog20181020kali-linux科学上网pc-连接到-ssr-local">PC 连接到SSR Local<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#pc-%e8%bf%9e%e6%8e%a5%e5%88%b0-ssr-local" target="_blank" rel="noopener noreffer "></a></h2>
<p>2019-07-03 更新： 该部分阐述了如何让
SSR Local 监听到数据，即如何让应用程序走本地代理。本地代理使用的协议为 socks5。</p>
<h3 id="浏览器全局代理httpswsxq255555ioblog20181020kali-linux科学上网浏览器全局代理">浏览器全局代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e6%b5%8f%e8%a7%88%e5%99%a8%e5%85%a8%e5%b1%80%e4%bb%a3%e7%90%86" target="_blank" rel="noopener noreffer "></a></h3>
<p>2019-07-04 更新：本部分的目标在于让浏览器浏览所有网页时都走代理。只需在浏览器中设置手动代理即可</p>
<p>以 FireFox 为例：</p>
<ol>
<li>
<p>找到浏览器中的手动代理设置的位置：点击右上角的菜单，选择<strong>Preferences</strong>，选择<strong>General</strong>，滑到最下面，选择<strong>Network Proxy</strong>标签下的<strong>Settings</strong>，选择<strong>Manual proxy configuration</strong></p>
</li>
<li>
<p>配置：找到<strong>SOCKS Host</strong>一栏，填入<code>127.0.0.1</code>和<code>1080</code>，在下面选择<strong>SOCKS v5</strong>，其它栏留空（如<strong>HTTP Proxy</strong>）。并在之后的<strong>No Proxy for</strong>中填入不需要代理的网址或
IP 地址或网段（例如 127.0.0.1、192.168.0.0/16等）。</p>
<p>2019-07-04 更新：记得勾选下方的<strong>Proxy
DNS when using
SOCKS v5</strong>以防止
GFW 的
DNS 污染。此外，对第 2 步的手动配置代理中的说明如下：</p>
<ul>
<li>
<p><strong>HTTP Proxy</strong>：</p>
<p>HTTP 代理服务器地址。须知，使用前面的方法在<code>127.0.0.1 1080</code>处搭建的代理服务器是</p>
<p>SOCKS 代理服务器（不是</p>
<p>HTTP 代理服务器），且使用的是 socks5 协议（不是 socks4/socks4a 协议）。所以在这里填写<code>127.0.0.1 1080</code>将无法访问（即必须留空）</p>
</li>
<li>
<p><strong>SSL Proxy</strong>：访问</p>
<p>HTTPS 站点时使用的代理服务器地址，其实就是</p>
<p>HTTP 代理服务器地址。留空原因同上</p>
</li>
<li>
<p><strong>FTP Proxy</strong>：访问</p>
<p>FTP 站点时使用的代理服务器地址，其实就是</p>
<p>HTTP 代理服务器地址（不过需要注意的是</p>
<p>FTP 代理是存在的，例如使用工具<code>ftp.proxy</code>）。留空原因同上</p>
</li>
<li>
<p><strong>SOCKS Host</strong>：访问任意站点时使用的代理服务器地址。</p>
</li>
</ul>
</li>
</ol>
<p>完！</p>
<p>这时便可以访问<a href="https://www.google.com/" target="_blank" rel="noopener noreffer ">https://www.google.com</a>了，简单吧？</p>
<h3 id="系统全局代理httpswsxq255555ioblog20181020kali-linux科学上网系统全局代理">系统全局代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e7%b3%bb%e7%bb%9f%e5%85%a8%e5%b1%80%e4%bb%a3%e7%90%86" target="_blank" rel="noopener noreffer "></a></h3>
<p>在系统设置中的网络代理方式设为<strong>手动</strong>，并将相应的<strong>Socks Host</strong>改为<code>127.0.0.1 1080</code>即可。具体步骤如下：</p>
<ol>
<li>
<p>设置系统手动代理：设置-&gt;网络-&gt;网络代理，方式改为<strong>手动</strong>，<strong>SOCKS Host</strong>改为<code>127.0.0.1 1080</code>，其它留空（留空的理由和前文类似）</p>
<p><strong>温馨提示</strong>：该处的设置依赖于<code>network-manager</code>服务，应确保其正在运行。（有的人因为<code>network-manager.service</code>和<code>networking.service</code>冲突所以采取网上的建议将<code>network-manager.service</code>给禁用了，结果导致系统设置中和网络相关的设置均不可用。好吧，说的就是我自己<code>-_-</code>）可以使用<code>systemctl</code>命令查看<code>network-manager.service</code>的状态，如下所示：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@kali:~# systemctl status network-manager.service 
</span></span><span class="line"><span class="cl">● NetworkManager.service - Network Manager
</span></span><span class="line"><span class="cl">   Loaded: loaded <span class="o">(</span>/lib/systemd/system/NetworkManager.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
</span></span><span class="line"><span class="cl">   Active: active <span class="o">(</span>running<span class="o">)</span> since Thu 2019-07-04 23:30:33 CST<span class="p">;</span> 19h ago
</span></span><span class="line"><span class="cl">     Docs: man:NetworkManager<span class="o">(</span>8<span class="o">)</span>
</span></span><span class="line"><span class="cl"> Main PID: <span class="m">396</span> <span class="o">(</span>NetworkManager<span class="o">)</span>
</span></span><span class="line"><span class="cl">    Tasks: <span class="m">3</span> <span class="o">(</span>limit: 4695<span class="o">)</span>
</span></span><span class="line"><span class="cl">   Memory: 13.8M
</span></span><span class="line"><span class="cl">   CGroup: /system.slice/NetworkManager.service
</span></span><span class="line"><span class="cl">           └─396 /usr/sbin/NetworkManager --no-daemon
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.6270<span class="o">]</span> manager: NetworkManager state is now CONNECTED_GLOBAL
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.7143<span class="o">]</span> modem-manager: ModemManager available
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.7188<span class="o">]</span> device <span class="o">(</span>eth0<span class="o">)</span>: state change: disconnected -&gt; prepare <span class="o">(</span>reason <span class="s1">&#39;none&#39;</span>, sys-iface-state: <span class="s1">&#39;external&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.7203<span class="o">]</span> device <span class="o">(</span>eth0<span class="o">)</span>: state change: prepare -&gt; config <span class="o">(</span>reason <span class="s1">&#39;none&#39;</span>, sys-iface-state: <span class="s1">&#39;external&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.7210<span class="o">]</span> device <span class="o">(</span>eth0<span class="o">)</span>: state change: config -&gt; ip-config <span class="o">(</span>reason <span class="s1">&#39;none&#39;</span>, sys-iface-state: <span class="s1">&#39;external&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.7215<span class="o">]</span> device <span class="o">(</span>eth0<span class="o">)</span>: state change: ip-config -&gt; ip-check <span class="o">(</span>reason <span class="s1">&#39;none&#39;</span>, sys-iface-state: <span class="s1">&#39;external&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.7226<span class="o">]</span> device <span class="o">(</span>eth0<span class="o">)</span>: state change: ip-check -&gt; secondaries <span class="o">(</span>reason <span class="s1">&#39;none&#39;</span>, sys-iface-state: <span class="s1">&#39;external&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.7233<span class="o">]</span> device <span class="o">(</span>eth0<span class="o">)</span>: state change: secondaries -&gt; activated <span class="o">(</span>reason <span class="s1">&#39;none&#39;</span>, sys-iface-state: <span class="s1">&#39;external&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.8065<span class="o">]</span> device <span class="o">(</span>eth0<span class="o">)</span>: Activation: successful, device activated.
</span></span><span class="line"><span class="cl">7月 <span class="m">04</span> 23:30:35 kali.abc.com NetworkManager<span class="o">[</span>396<span class="o">]</span>: &lt;info&gt;  <span class="o">[</span>1562254235.8200<span class="o">]</span> manager: startup <span class="nb">complete</span>
</span></span><span class="line"><span class="cl">root@kali:~#
</span></span></code></pre></td></tr></table>
</div>
</div><p>另外，这一步中的设置完成后，每次打开新终端的时候，检查代理相关的环境变量，你会发现：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@kali:~# env<span class="p">|</span>grep -i proxy
</span></span><span class="line"><span class="cl"><span class="nv">ALL_PROXY</span><span class="o">=</span>socks://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">no_proxy</span><span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="nv">NO_PROXY</span><span class="o">=</span>
</span></span><span class="line"><span class="cl"><span class="nv">all_proxy</span><span class="o">=</span>socks://127.0.0.1:1080/
</span></span><span class="line"><span class="cl">root@kali:~#
</span></span></code></pre></td></tr></table>
</div>
</div><p>所以这个步骤的实质只是设置了下环境变量 <figure><a class="lightgallery" href="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png" title="😂" data-thumbnail="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png" data-sub-html="<h2>😂</h2><p>😂</p>">
        <img
            class="lazyload"
            src="/svg/loading.min.svg"
            data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png"
            data-srcset="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png, https://github.githubassets.com/images/icons/emoji/unicode/1f602.png 1.5x, https://github.githubassets.com/images/icons/emoji/unicode/1f602.png 2x"
            data-sizes="auto"
            alt="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png" />
    </a><figcaption class="image-caption">😂</figcaption>
    </figure></p>
<p>假如你在系统的网络代理设置中将所有代理均设置为<code>127.0.0.1 1080</code>且<strong>Ignore Hosts</strong>设置为<code>127.0.0.1, 192.168.0.0/16</code>，那么在新打开的终端中检查代理相关的环境变量，你会发现：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@kali:~# env<span class="p">|</span>grep -i proxy
</span></span><span class="line"><span class="cl"><span class="nv">HTTP_PROXY</span><span class="o">=</span>http://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">FTP_PROXY</span><span class="o">=</span>http://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">https_proxy</span><span class="o">=</span>http://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">http_proxy</span><span class="o">=</span>http://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">ALL_PROXY</span><span class="o">=</span>socks://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">no_proxy</span><span class="o">=</span>127.0.0.1,192.168.0.0/16
</span></span><span class="line"><span class="cl"><span class="nv">NO_PROXY</span><span class="o">=</span>127.0.0.1,192.168.0.0/16
</span></span><span class="line"><span class="cl"><span class="nv">HTTPS_PROXY</span><span class="o">=</span>http://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">all_proxy</span><span class="o">=</span>socks://127.0.0.1:1080/
</span></span><span class="line"><span class="cl"><span class="nv">ftp_proxy</span><span class="o">=</span>http://127.0.0.1:1080/
</span></span><span class="line"><span class="cl">root@kali:~#
</span></span></code></pre></td></tr></table>
</div>
</div><p>同样印证了上述结论——在 Kali 系统设置中的网络代理设置处进行手动代理设置实质上是修改了代理相关的环境变量</p>
<p>需要注意的是（如前文所述），通用代理只有两种：
HTTP 代理（使用 http 协议）和
SOCKS 代理（使用 socks4/socks4a/socks5 协议）。即代理相关环境变量中，每个变量<code>=</code>后面的协议部分必需是<code>http/socks4/socks4a/socks5</code>之一（对于<code>curl</code>还支持<code>socks5h</code>）</p>
</li>
<li>
<p>测试：打开浏览器，输入网址<code>www.google.com</code>看是否访问成功</p>
<p>2019-07-05 更新：如果使用的浏览器是 FireFox，则还需要将网络代理设置为<strong>Use system proxy settings</strong>。同样要记得勾选下方的<strong>Proxy
DNS when using
SOCKS v5</strong>以防止
GFW 的
DNS 污染</p>
</li>
</ol>
<h3 id="真系统全局代理透明代理httpswsxq255555ioblog20181020kali-linux科学上网真系统全局代理透明代理">真·系统全局代理（透明代理）<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e7%9c%9f%e7%b3%bb%e7%bb%9f%e5%85%a8%e5%b1%80%e4%bb%a3%e7%90%86%e9%80%8f%e6%98%8e%e4%bb%a3%e7%90%86" target="_blank" rel="noopener noreffer "></a></h3>
<p>如前所述，在 Kali 系统设置中的网络代理设置处进行手动代理设置实质上是修改了代理相关的环境变量。对于 linux 下不支持代理的程序而言，前面的设置并没有什么用，即并非真的实现了全局代理。那么如果要实现真正意义上的全局代理，即让所有应用都经过代理服务器该怎么办？答案是使用 tsocks：</p>
<ul>
<li><a href="http://tsocks.sourceforge.net/" target="_blank" rel="noopener noreffer ">tsocks 官网</a></li>
<li><a href="https://sourceforge.net/projects/tsocks/files/tsocks/" target="_blank" rel="noopener noreffer ">tsocks 下载链接</a></li>
<li><a href="https://linux.die.net/man/8/tsocks" target="_blank" rel="noopener noreffer ">tsocks 手册</a></li>
</ul>
<blockquote>
<p>tsocks 利用 LD_PRELOAD 机制，代理程序里的<code>connect</code>函数，然后就可以代理所有的
TCP 请求了。不过对于 dns 请求，默认是通过 udp 来发送的，所以 tsocks 不能代理 dns 请求。</p>
<p>默认情况下，tsocks 会先加载<code>~/.tsocks.conf</code>，如果没有，再加载<code>/etc/tsocks.conf</code>。对于 local ip 不会代理。</p>
<p>使用方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get install tsocks
</span></span><span class="line"><span class="cl"><span class="nv">LD_PRELOAD</span><span class="o">=</span>/usr/lib/libtsocks.so wget http://www.facebook.com
</span></span></code></pre></td></tr></table>
</div>
</div><p>——引用自<a href="http://hengyunabc.github.io/something-about-science-surf-the-internet/" target="_blank" rel="noopener noreffer ">科学上网的一些原理 | 横云断岭的专栏</a></p>
</blockquote>
<h3 id="通过-socks-代理进行-dns-查询httpswsxq255555ioblog20181020kali-linux科学上网通过-socks-代理进行-dns-查询">通过 SOCKS 代理进行 DNS 查询<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e9%80%9a%e8%bf%87-socks-%e4%bb%a3%e7%90%86%e8%bf%9b%e8%a1%8c-dns-%e6%9f%a5%e8%af%a2" target="_blank" rel="noopener noreffer "></a></h3>
<p>使用 <a href="https://sourceforge.net/projects/dns2socks/" target="_blank" rel="noopener noreffer ">dns2socks</a>（Github 上也有其项目地址https://github.com/qiuzi/dns2socks）或 <a href="https://github.com/shawn1m/overture" target="_blank" rel="noopener noreffer ">overture</a></p>
<p>此外，shadowsocks-libev 中的 ss-tunnel 也能实现该功能。和 dns2socks 相比，ss-tunnel 走
TCP（即 socks5），而 dns2socks 走
UDP</p>
<p>具体步骤就不详述了</p>
<p>对了，
HTTP 代理
DNS 的解析必然是通过代理的：</p>
<blockquote>
<p>对于
HTTP/
HTTPS 类型的代理服务器而言，请求的域名会作为
HTTP 协议的一部分直接发往代理服务器，不会在本地进行任何解析操作。也就是说，域名的解析与连接目标服务器，是代理服务器的职责。浏览器本身甚至无须知道最终服务器的
IP 地址。据我所知，此行为无法通过浏览器选项等更改。</p>
<p>也就是说，理论上使用
HTTP/
HTTPS 类型的代理服务器时，本地的
DNS 解析、缓存、 hosts 文件等都不使用，与本地设置的
DNS 服务器地址无关。
DNS 解析完全在代理服务器上进行。</p>
<p>——引用自<a href="https://github.com/FelisCatus/SwitchyOmega/issues/963#issuecomment-270055221" target="_blank" rel="noopener noreffer ">请问在设置http/https代理后DNS的解析还是通过proxy吗?</a></p>
</blockquote>
<h3 id="转换-socks-代理为-http-代理httpswsxq255555ioblog20181020kali-linux科学上网转换-socks-代理为-http-代理">转换 SOCKS 代理为 HTTP 代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e8%bd%ac%e6%8d%a2-socks-%e4%bb%a3%e7%90%86%e4%b8%ba-http-%e4%bb%a3%e7%90%86" target="_blank" rel="noopener noreffer "></a></h3>
<p>2019-07-04 更新：相关的工具有很多，例如 Polipo、privoxy等。这里使用的工具是 Polipo。需要注意的是 Polipo 最后一次更新是在 2014-05-15（参见 <a href="https://en.wikipedia.org/wiki/Polipo" target="_blank" rel="noopener noreffer ">Polipo - Wikipedia</a>）</p>
<p>如前所述，通用代理只有两种：
HTTP 代理（使用
HTTP 协议）和
SOCKS 代理（使用 socks4/socks4a/socks5 协议）。最常见且最普及的是前者，有的应用不支持后者。所以为了让那些不支持
SOCKS 代理的应用程序使用代理，需要将
SOCKS 转换为
HTTP 代理。</p>
<p><code>Polipo</code>可以用来将<code>SOCKS</code>的代理转换为<code>HTTP</code>的代理，从而使那些只支持<code>HTTP</code>代理的软件（如<code>wget</code>，部分浏览器，部分操作系统（如 Windows 就只支持 http 代理和 socks4 代理，这是我通过抓包分析发现的））也可以科学上网</p>
<ol>
<li>
<p>安装<code>polipo</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install polipo
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>修改<code>/etc/polipo/config</code>文件为如下内容：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">logSyslog</span> <span class="o">=</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">logFile</span> <span class="o">=</span> /var/log/polipo/polipo.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">socksParentProxy</span> <span class="o">=</span> <span class="s2">&#34;127.0.0.1:1080&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">socksProxyType</span> <span class="o">=</span> socks5
</span></span><span class="line"><span class="cl"><span class="nv">proxyAddress</span> <span class="o">=</span> <span class="s2">&#34;0.0.0.0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">proxyPort</span> <span class="o">=</span> <span class="m">8123</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>重启<code>polipo</code>（安装后它会自动启动，故这里说重启）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">systemctl restart polipo
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>验证 polipo 是否正常工作：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">http_proxy</span><span class="o">=</span>http://127.0.0.1:8123/
</span></span><span class="line"><span class="cl">curl www.google.com
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果正常，就会返回抓取到的 Google 网页内容。可通过<code>man polipo</code>查看其帮助文档。</p>
</li>
</ol>
<h3 id="浏览器自动代理httpswsxq255555ioblog20181020kali-linux科学上网浏览器自动代理">浏览器自动代理<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e6%b5%8f%e8%a7%88%e5%99%a8%e8%87%aa%e5%8a%a8%e4%bb%a3%e7%90%86" target="_blank" rel="noopener noreffer "></a></h3>
<p>2019-07-04 更新：本部分的目标在于让浏览器根据浏览的网站的不同自动选择是否走代理，例如对于国外网站走代理，对于国内网站不走代理。方法也很简单，使用浏览器插件即可，FireFox 用 FoxyProxy，Chrome 用 SwitchyOmega。</p>
<p>FoxyProxy 是 Firefox 浏览器中的一个非常好用的代理插件。因为有科学上网需求的主要是浏览器，故若只是为了让浏览器科学上网，则可采用此方法。当然，如果用的是 Chrome ，则可采用 Chrome + SwitchyOmega 的方案替代之。</p>
<ol>
<li>
<p>安装<code>FoxyProxy</code>插件：https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/</p>
</li>
<li>
<p>设置<code>FoxyProxy</code>选项：</p>
<ol>
<li><strong>Add Proxy</strong>: <code>Proxy Type</code>选<code>SOCKS5</code>，<code>IP address</code>填<code>127.0.0.1</code>，<code>Port</code>填<code>1080</code>，记得最后点下<code>Save</code></li>
<li>添加<code>Patterns</code>: 在选项主界面，点击刚刚添加的<code>Proxy</code>的<code>Patterns</code>，根据自己的需要添加<code>Patterns</code></li>
</ol>
</li>
<li>
<p>启用<code>FoxyProxy</code>：单击浏览器中右上角相应的图标，选择<code>Use Enabled Proxies By Patterns and Priority</code></p>
</li>
<li>
<p>测试：输入网址<code>www.google.com</code>看是否访问成功</p>
</li>
</ol>
<h3 id="pac代理自动配置httpswsxq255555ioblog20181020kali-linux科学上网pac代理自动配置">PAC（代理自动配置）<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#pac%e4%bb%a3%e7%90%86%e8%87%aa%e5%8a%a8%e9%85%8d%e7%bd%ae" target="_blank" rel="noopener noreffer "></a></h3>
<blockquote>
<p>代理自动配置（英语：Proxy auto-config，简称
PAC）是一种网页浏览器技术，用于定义浏览器该如何自动选择适当的代理服务器来访问一个网址。</p>
<p>一个
PAC文件包含一个JavaScript形式的函数“FindProxyForURL(url, host)”。这个函数返回一个包含一个或多个访问规则的字符串。用户代理根据这些规则适用一个特定的代理器或者直接访问。当一个代理服务器无法响应的时候，多个访问规则提供了其他的后备访问方法。浏览器在访问其他页面以前，首先访问这个
PAC文件。
PAC文件中的
URL可能是手工配置的，也可能是是通过网页的网络代理自动发现协议（
WPAD）自动配置的。</p>
<p>——引用自<a href="https://zh.wikipedia.org/wiki/%e4%bb%a3%e7%90%86%e8%87%aa%e5%8a%a8%e9%85%8d%e7%bd%ae" target="_blank" rel="noopener noreffer ">代理自动配置 - 维基百科，自由的百科全书</a></p>
</blockquote>
<p>2019-07-06 更新：另外还可参见 <a href="https://github.com/breakwa11/gfw_whitelist" target="_blank" rel="noopener noreffer ">breakwa11/gfw_whitelist: gfw_whitelist</a> 了解关于
PAC 的更多信息</p>
<p>此方法主要使用了<code>genpac</code>（GENerate
PAC file）生成
PAC 文件，并将系统设置中的网络代理方式改为自动，将其<code>Configuration URL</code>指向相应的
PAC 文件位置。具体过程如下：</p>
<ol>
<li>
<p>安装<code>genpac</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#安装</span>
</span></span><span class="line"><span class="cl">pip install genpac
</span></span><span class="line"><span class="cl"><span class="c1">#更新</span>
</span></span><span class="line"><span class="cl">pip install --upgrade genpac
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>生成</p>
<p>PAC文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir ~/.pac
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ~/.pac
</span></span><span class="line"><span class="cl">touch user-rules.txt <span class="c1">#可在此文件中添加用户自定义规则，此处省略</span>
</span></span><span class="line"><span class="cl">genpac --pac-proxy <span class="s2">&#34;SOCKS5 127.0.0.1:1080&#34;</span> --output<span class="o">=</span><span class="s2">&#34;ProxyAutoConfig.pac&#34;</span> --user-rule-from<span class="o">=</span><span class="s2">&#34;user-rules.txt&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>设置系统自动代理：<strong>设置-&gt;网络-&gt;网络代理</strong>，方式改为<strong>自动</strong>，<code>Configuration URL</code>改为<code>file:///root/.pac/ProxyAutoConfig.pac</code>（注意我用的是root用户，如果非root用户请将<code>/root</code>改为<code>/home/&lt;your username&gt;</code>）</p>
</li>
<li>
<p>测试：打开浏览器，输入网址<code>www.google.com</code>看是否访问成功</p>
</li>
</ol>
<p>2019-07-03 更新：该方法存在的问题是如果你的
PAC 文件失效了，可能需要重新下载
PAC 文件，即重新执行第 2 步中的<code>genpac</code>步骤。</p>
<h3 id="关于终端下的代理设置httpswsxq255555ioblog20181020kali-linux科学上网关于终端下的代理设置">关于终端下的代理设置<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e5%85%b3%e4%ba%8e%e7%bb%88%e7%ab%af%e4%b8%8b%e7%9a%84%e4%bb%a3%e7%90%86%e8%ae%be%e7%bd%ae" target="_blank" rel="noopener noreffer "></a></h3>
<h4 id="终端代理环境变量httpswsxq255555ioblog20181020kali-linux科学上网终端代理环境变量">终端代理环境变量<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e7%bb%88%e7%ab%af%e4%bb%a3%e7%90%86%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f" target="_blank" rel="noopener noreffer "></a></h4>
<p>如前文所述，通用代理只有两种：
HTTP 代理（使用 http 协议）和
SOCKS 代理（使用 socks4/socks4a/socks5 协议）。即代理相关环境变量中，每个变量<code>=</code>后面的协议部分必需是<code>http/socks4/socks4a/socks5</code>之一（对于<code>curl</code>还支持<code>socks5h</code>）。如下所示则全将其设置为了<code>socks5</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Set Proxy</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> sp<span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">all_proxy</span><span class="o">=</span>socks5://127.0.0.1:1080/
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">ALL_PROXY</span><span class="o">=</span>socks5://127.0.0.1:1080/ <span class="c1">#有的命令行工具使用大写的变量名，如 curl</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">http_proxy</span><span class="o">=</span>socks5://127.0.0.1:1080/ <span class="c1">#有的命令行工具使用小写的变量名，如 curl、wget</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">ftp_proxy</span><span class="o">=</span>socks5://127.0.0.1:1080/ <span class="c1">#有的命令行工具使用小写的变量名，如 wget</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">FTP_PROXY</span><span class="o">=</span>socks5://127.0.0.1:1080/ <span class="c1">#有的命令行工具使用大写的变量名，如 curl</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">https_proxy</span><span class="o">=</span>socks5://127.0.0.1:1080/ <span class="c1">#有的命令行工具使用小写的变量名，如 wget</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">HTTPS_PROXY</span><span class="o">=</span>socks5://127.0.0.1:1080/ <span class="c1">#有的命令行工具使用大写的变量名，如 curl</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">no_proxy</span><span class="o">=</span>localhost,127.0.0.1,192.168.0.0 <span class="c1">#有的命令行工具使用小写的变量名，如 wget</span>
</span></span><span class="line"><span class="cl">    <span class="nb">export</span> <span class="nv">NO_PROXY</span><span class="o">=</span>localhost,127.0.0.1,192.168.0.0 <span class="c1">#有的命令行工具使用大写的变量名，如 curl</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Unset Proxy</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> up<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">unset</span> all_proxy ALL_PROXY http_proxy ftp_proxy FTP_PROXY https_proxy HTTPS_PROXY no_proxy NO_PROXY
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>其中的<code>http_proxy</code>表示访问<code>http</code>协议站点使用的代理，而不是使用<code>http</code>代理访问<code>http</code>协议站点。同理<code>ftp_proxy</code>表示访问<code>ftp</code>站点时使用的代理</p>
<h4 id="使用程序的代理相关参数httpswsxq255555ioblog20181020kali-linux科学上网使用程序的代理相关参数">使用程序的代理相关参数<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e4%bd%bf%e7%94%a8%e7%a8%8b%e5%ba%8f%e7%9a%84%e4%bb%a3%e7%90%86%e7%9b%b8%e5%85%b3%e5%8f%82%e6%95%b0" target="_blank" rel="noopener noreffer "></a></h4>
<ol>
<li>
<p><code>git</code>：已知（亲测）支持<code>socks5</code>、<code>http</code>这两种代理方式，支持上述的终端代理环境变量。也可单独设置代理以覆盖全局设置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 设置`socks5`代理</span>
</span></span><span class="line"><span class="cl">git config --global http.proxy <span class="s1">&#39;socks5://127.0.0.1:1080&#39;</span>
</span></span><span class="line"><span class="cl">git config --global https.proxy <span class="s1">&#39;socks5://127.0.0.1:1080&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 设置`http`代理</span>
</span></span><span class="line"><span class="cl">git config --global https.proxy http://127.0.0.1:1080
</span></span><span class="line"><span class="cl">git config --global https.proxy https://127.0.0.1:1080
</span></span><span class="line"><span class="cl"><span class="c1"># 取消代理</span>
</span></span><span class="line"><span class="cl">git config --global --unset http.proxy
</span></span><span class="line"><span class="cl">git config --global --unset https.proxy
</span></span></code></pre></td></tr></table>
</div>
</div><p>对应的<code>.gitconfig</code>配置文件内容如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">[http]
</span></span><span class="line"><span class="cl">    proxy = socks5://127.0.0.1:1080
</span></span><span class="line"><span class="cl">[https]
</span></span><span class="line"><span class="cl">    proxy = socks5://127.0.0.1:1080
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><code>curl</code>：支持<code>socks4</code>、<code>socks4a</code>、<code>socks5</code>、<code>http</code>这几种代理方式，支持上述的终端代理环境变量。也可单独设置代理以覆盖全局设置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl -i4 -m3 -x socks5://192.168.56.11:1080 https://www.google.com
</span></span><span class="line"><span class="cl">curl -i4 -m3 -x socks5h://192.168.56.11:1080 https://www.google.com
</span></span></code></pre></td></tr></table>
</div>
</div><p>注意<code>socks5</code>和<code>socks5h</code>的区别，前者解析域名时不使用代理，后者解析域名时要使用代理，由于国内
DNS 可能被污染，故建议使用<code>socks5h</code>。详情参见<code>man curl</code>：</p>
<blockquote>
<p>–socks5-hostname &lt;host[:port]&gt;</p>
<p>Use the specified SOCKS5 proxy (and let the proxy resolve the host name). If the port number is not specified, it is assumed at port 1080. (Added in 7.18.0)</p>
<p>–socks5 &lt;host[:port]&gt;</p>
<p>Use the specified SOCKS5 proxy - but resolve the host name locally. If the port number is not specified, it is assumed at port 1080.</p>
</blockquote>
</li>
<li>
<p><code>wget</code>: 似乎只支持<code>http</code>协议代理，支持上述的终端代理环境变量。不可单独设置代理以覆盖全局变量</p>
</li>
</ol>
<h2 id="通过已经可以科学上网的电脑实现科学上网httpswsxq255555ioblog20181020kali-linux科学上网通过已经可以科学上网的电脑实现科学上网">通过已经可以科学上网的电脑实现科学上网<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e9%80%9a%e8%bf%87%e5%b7%b2%e7%bb%8f%e5%8f%af%e4%bb%a5%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91%e7%9a%84%e7%94%b5%e8%84%91%e5%ae%9e%e7%8e%b0%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91" target="_blank" rel="noopener noreffer "></a></h2>
<p>也就是说，如果你有一台设备通过上述的方法之一实现了科学上网，那么你就可以借助那台设备轻松地让其它和那台设备<strong>属于同一局域网的设备</strong>实现科学上网。比如你的实体机（如 Windows）实现了科学上网，那么对于你的 kali 虚拟机你就没必要想尽各种办法让它与你的实体机进行类似的配置以实现科学上网。具体方法如下：</p>
<p>前提条件：和可以科学上网的主机处于<strong>同一局域网</strong></p>
<p>实验环境：主机 Windows10 （已实现科学上网），虚拟机 Kali Linux（需要实现科学上网），对于虚拟机 Kali，我使用了两个网卡，<strong>网络地址转换</strong>和<strong>仅主机网络</strong>，前者保证能连上 Internet，后者保证让 主机和虚拟机处于同一局域网（网段为 192.168.56.0/24）</p>
<p>实现步骤（以
SSR 为例）：</p>
<ol>
<li>
<p>配置主机的</p>
<p>SSR 客户端，使其<strong>允许来自局域网的连接</strong>。于我而言，我是这么设置的：<strong>右键小飞机-&gt;选项设置-&gt;勾选来自局域网的连接</strong></p>
</li>
<li>
<p>在虚拟机中，配置 FireFox 浏览器中的网络代理或系统代理，选择手动代理，在所有代理中填入主机的</p>
<p>IP 地址和其默认的端口（我的是<code>192.168.56.100</code>和<code>1080</code>）</p>
</li>
<li>
<p>完成</p>
</li>
</ol>
<h2 id="链接httpswsxq255555ioblog20181020kali-linux科学上网链接">链接<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e9%93%be%e6%8e%a5" target="_blank" rel="noopener noreffer "></a></h2>
<p>下面总结了本文中使用的所有链接：</p>
<ul>
<li><a href="https://roxhaiy.wordpress.com/2017/08/04/430/" target="_blank" rel="noopener noreffer ">CentOS 7 配置 shadowsocks-libev 服务器端进行科学上网 | 鸣沙山侧 月牙泉畔</a></li>
<li><a href="https://en.wikipedia.org/wiki/Polipo" target="_blank" rel="noopener noreffer ">Polipo - Wikipedia</a></li>
<li><a href="https://shadowsocks.org/en/spec/Implementations.html" target="_blank" rel="noopener noreffer ">Shadowsocks - Implementations</a></li>
<li><a href="https://github.com/breakwa11/gfw_whitelist" target="_blank" rel="noopener noreffer ">breakwa11/gfw_whitelist: gfw_whitelist</a></li>
<li><a href="http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/bwg%e4%b8%bb%e6%9c%ba%e4%bf%a1%e6%81%af%e7%95%8c%e9%9d%a2.png" target="_blank" rel="noopener noreffer ">bwg</a></li>
<li><a href="https://sourceforge.net/projects/dns2socks/" target="_blank" rel="noopener noreffer ">dns2socks</a></li>
<li><a href="https://github.com/shawn1m/overture" target="_blank" rel="noopener noreffer ">overture</a></li>
<li><a href="https://github.com/shadowsocks/shadowsocks-qt5" target="_blank" rel="noopener noreffer ">shadowsocks-qt5</a></li>
<li><a href="http://wsxq12.55555.io/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/ss-qt5%e4%b8%bb%e7%95%8c%e9%9d%a2.png" target="_blank" rel="noopener noreffer ">ss-qt5</a></li>
<li><a href="https://sourceforge.net/projects/tsocks/files/tsocks/" target="_blank" rel="noopener noreffer ">tsocks 下载链接</a></li>
<li><a href="http://tsocks.sourceforge.net/" target="_blank" rel="noopener noreffer ">tsocks 官网</a></li>
<li><a href="https://linux.die.net/man/8/tsocks" target="_blank" rel="noopener noreffer ">tsocks 手册</a></li>
<li><a href="https://zh.wikipedia.org/wiki/%e4%bb%a3%e7%90%86%e8%87%aa%e5%8a%a8%e9%85%8d%e7%bd%ae" target="_blank" rel="noopener noreffer ">代理自动配置 - 维基百科，自由的百科全书</a></li>
<li><a href="https://wsxq2.55555.io/blog/2019/07/07/%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91" target="_blank" rel="noopener noreffer ">科学上网</a></li>
<li><a href="http://hengyunabc.github.io/something-about-science-surf-the-internet/" target="_blank" rel="noopener noreffer ">科学上网的一些原理 | 横云断岭的专栏</a></li>
<li><a href="https://github.com/FelisCatus/SwitchyOmega/issues/963#issuecomment-270055221" target="_blank" rel="noopener noreffer ">请问在设置http/https代理后DNS的解析还是通过proxy吗?</a></li>
</ul>
<h2 id="缩略语httpswsxq255555ioblog20181020kali-linux科学上网缩略语">缩略语<a href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/#%e7%bc%a9%e7%95%a5%e8%af%ad" target="_blank" rel="noopener noreffer "></a></h2>
<ul>
<li><strong>ARM</strong>: Advanced RISC Machines</li>
<li><strong>CPU</strong>: Central Processing Unit</li>
<li><strong>CST</strong>: China Standard Time</li>
<li><strong>DNS</strong>: Domain Name System</li>
<li><strong>FTP</strong>: File Transfer Protocol</li>
<li><strong>GFW</strong>: Great Firewall</li>
<li><strong>HTTP</strong>: Hypertext Transfer Protocol</li>
<li><strong>HTTPS</strong>: HTTP Secure</li>
<li><strong>IP</strong>: Internet Protocol</li>
<li><strong>JSON</strong>: JavaScript Object Notation</li>
<li><strong>KB</strong>: Kilobyte</li>
<li><strong>MB</strong>: Megabyte</li>
<li><strong>MIPS</strong>: Microprocessor without Interlocked Pipeline Stages</li>
<li><strong>OS</strong>: Operating System</li>
<li><strong>PAC</strong>: Proxy auto-config</li>
<li><strong>PC</strong>: Personal Computer</li>
<li><strong>PID</strong>: Process ID</li>
<li><strong>POSIX</strong>: Portable Operating System Interface, formerly IEEE-IX</li>
<li><strong>SOCKS</strong>: SOCKetS</li>
<li><strong>SS</strong>: shadowsocks</li>
<li><strong>SSL</strong>: Secure Socket Layer</li>
<li><strong>SSR</strong>: shadowsocksr</li>
<li><strong>TCP</strong>: Transmission Control Protocol</li>
<li><strong>UDP</strong>: User Datagram Protocol</li>
<li><strong>URL</strong>: Uniform Resource Locator</li>
<li><strong>VPS</strong>: Virtual Processing System</li>
<li><strong>WPAD</strong>: Web Proxy Autodiscovery Protocol</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-08-27</span>
            </div><div class="post-info-license">
                <span>false</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="http://example.org/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" data-title="转载-Kali Linux科学上网"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://example.org/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://example.org/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" data-title="转载-Kali Linux科学上网"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://example.org/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" data-title="转载-Kali Linux科学上网"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://example.org/kali-linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" data-title="转载-Kali Linux科学上网"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/panda%E6%A0%B8%E5%BF%83%E7%A8%8B%E5%BA%8F%E8%AE%BE%E7%BD%AE%E6%88%90%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/" class="prev" rel="prev" title="Panda核心程序设置成开机自动运行"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Panda核心程序设置成开机自动运行</a>
            <a href="/%E5%8D%8E%E4%B8%BAhisuite%E5%A4%87%E4%BB%BD%E8%A7%A3%E5%AF%86/" class="next" rel="next" title="华为Hisuite备份解密">华为Hisuite备份解密<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.116.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":30},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
