<!-- build time:Wed Oct 05 2022 23:05:48 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://sirliu.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://sirliu.github.io/atom.xml"><link rel="alternate" type="application/json" href="https://sirliu.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CMicrosoft%20YaHei:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://sirliu.github.io/2021/8/Kali%20Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"><title>转载-Kali Linux科学上网 - VPN | Black Elk = = 潛龍勿用</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">转载-Kali Linux科学上网</h1><div class="meta"><span class="item" title="创建时间：2021-08-27 09:29:58"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-08-27T09:29:58+08:00">2021-08-27</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>16k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>14 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Black Elk</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://pics.sirliu.top:4433/?id=354527"></li><li class="item" data-background-image="https://pics.sirliu.top:4433/?id=934701"></li><li class="item" data-background-image="https://pics.sirliu.top:4433/?id=755974"></li><li class="item" data-background-image="https://pics.sirliu.top:4433/?id=531405"></li><li class="item" data-background-image="https://pics.sirliu.top:4433/?id=228705"></li><li class="item" data-background-image="https://pics.sirliu.top:4433/?id=249336"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/VPN/" itemprop="item" rel="index" title="分类于 VPN"><span itemprop="name">VPN</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://sirliu.github.io/2021/8/Kali%20Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="黑麋鹿"><meta itemprop="description" content="潛龍勿用, 折腾之路"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><p>转载自：<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8=">https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux 科学上网 /</span><br>用于备份该文章，以免源博客文章突然消失后找不到。<br>本文只讲解 Kali Linux 下针对 <code>SS</code> 和 <code>SSR</code> 的客户端配置。由于 Kali 基于 Debian，所以其它基于 Debian 的 Linux 类似，例如 Ubuntu。</p><p>关于科学上网的具体介绍请参见我的另一篇博客 <span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTkvMDcvMDcvJUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkx">科学上网</span>。本文是它的子集</p><p><strong>温馨提示</strong>：如果你的 Kali Linux 在虚拟机中且主机已经实现了科学上网，那么你没必要再折腾，直接使用<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU5JTgwJTlBJUU4JUJGJTg3JUU1JUI3JUIyJUU3JUJCJThGJUU1JThGJUFGJUU0JUJCJUE1JUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkxJUU3JTlBJTg0JUU3JTk0JUI1JUU4JTg0JTkxJUU1JUFFJTlFJUU3JThFJUIwJUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkx">通过已经可以科学上网的电脑实现科学上网</span>这个方法即可</p><h1 id="ss"><a class="anchor" href="#ss">#</a> SS</h1><p>本部分最后更新时间：2018-04-08。</p><h2 id="shadowsocks-qt5"><a class="anchor" href="#shadowsocks-qt5">#</a> shadowsocks-qt5<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU0JUJEJUJGJUU3JTk0JUE4LXNoYWRvd3NvY2tzLXF0NQ=="></span></h2><p>2019-07-02 更新： 客户端选择 <code>shadowsocks-qt5</code> 是因为它简单，界面友好（好吧，是因为当初只听说过它）。现在的我更倾向于使用 <code>shadowsocks-libev</code> 作为客户端，因为它最近一次更新在 2019 年 7 月，而 shadowsocks（即原始的 Python 版）最后更新时间是 2018 年 10 月，shadowsocks-qt5 最近一次更新则是在 2018 年 8 月</p><p>具体环境说明：</p><ul><li><p>客户端操作系统：Kali-Linux</p><ul><li>使用的 shadowsocks 实现（客户端）：<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYWRvd3NvY2tzL3NoYWRvd3NvY2tzLXF0NQ==">shadowsocks-qt5</span></li><li>使用的用户：root</li></ul></li></ul><p>另外，对于其它的 shadowsocks 实现，参考相应的官网文档操作即可。它们的官网链接在<span class="exturl" data-url="aHR0cHM6Ly9zaGFkb3dzb2Nrcy5vcmcvZW4vc3BlYy9JbXBsZW1lbnRhdGlvbnMuaHRtbA=="> Shadowsocks - Implementations</span> 页面中</p><h3 id="简介"><a class="anchor" href="#简介">#</a> 简介<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU3JUFFJTgwJUU0JUJCJThC"></span></h3><blockquote><p>Shadowsocks-Qt5 is a native and cross-platform shadowsocks GUI client with advanced features.</p><h3 id="features"><a class="anchor" href="#features">#</a> Features</h3><ul><li>Shadowsocks-Qt5 is written in C++ with Qt 5.</li><li>Support traffic statistics</li><li>Support server latency (lag) test</li><li>Use multiple profiles simultaneously</li><li>config.ini is located under ~/.config/shadowsocks-qt5/ on *nix platforms, or under the application’s directory on Windows.</li></ul><p>—— 引用自<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYWRvd3NvY2tzL3NoYWRvd3NvY2tzLXF0NQ=="> shadowsocks/shadowsocks-qt5: A cross-platform shadowsocks GUI client</span></p></blockquote><h3 id="安装"><a class="anchor" href="#安装">#</a> 安装<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU1JUFFJTg5JUU4JUEzJTg1"></span></h3><ol><li>在 <code>/etc/apt/sources.list</code> 文件末尾添加: <code>deb http://ppa.launchpad.net/hzwhuang/ss-qt5/ubuntu devel main</code></li><li>更新 apt 软件列表：</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">apt</span> update <span class="token comment">#这里会提示错误，以下两步解决该错误</span></pre></td></tr><tr><td data-num="2"></td><td><pre>     gpg --keyserver keyserver.ubuntu.com --recv 6DA746A05F00FA99</pre></td></tr><tr><td data-num="3"></td><td><pre>     gpg --export --armor 6DA746A05F00FA99 <span class="token operator">|</span> <span class="token function">sudo</span> apt-key <span class="token function">add</span> -</pre></td></tr><tr><td data-num="4"></td><td><pre>     <span class="token function">apt</span> update <span class="token comment">#这一步成功后便可安装 shadowsocks-qt5 了</span></pre></td></tr></table></figure><ol start="3"><li>安装 shadowsocks-qt5: <code>apt install shadowsocks-qt5</code> 。</li></ol><h3 id="配置"><a class="anchor" href="#配置">#</a> 配置<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU5JTg1JThEJUU3JUJEJUFF"></span></h3><ol><li><p>安装后在 <code>bash</code> 中输入 <code>ss-qt5</code> , 完成配置，配置好后的图如下：</p><p><img data-src="http://wsxq12.55555.io/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/ss-qt5%E4%B8%BB%E7%95%8C%E9%9D%A2.png" alt="ss-qt5"></p><p>图中使用的服务器账号是我花<strong> 180 元 / 年</strong>租用的搬瓦工的<br>VPS (见下图)（大家也可以搭建一个属于自己的<br>SS 服务器，可以学到不少东西）</p><p><img data-src="http://wsxq12.55555.io/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/bwg%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E7%95%8C%E9%9D%A2.png" alt="bwg"></p></li></ol><h3 id="设置"><a class="anchor" href="#设置">#</a> 设置</h3><p>PAC<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU4JUFFJUJFJUU3JUJEJUFFLXBhYw=="></span></p><ol><li><p>获得 pac 文件：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>pip <span class="token function">install</span> genpac</pre></td></tr><tr><td data-num="2"></td><td><pre>  pip <span class="token function">install</span> --upgrade genpac</pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token function">mkdir</span> ~/vpnPAC</pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token builtin class-name">cd</span> ~/vpnPAC</pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function">touch</span> user-rules.txt</pre></td></tr><tr><td data-num="6"></td><td><pre>  genpac -p <span class="token string">"SOCKS5 127.0.0.1:1080"</span> --gfwlist-proxy<span class="token operator">=</span><span class="token string">"SOCKS5 127.0.0.1:1080"</span> --output<span class="token operator">=</span><span class="token string">"autoproxy.pac"</span> --gfwlist-url<span class="token operator">=</span><span class="token string">"https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt"</span> --user-rule-from<span class="token operator">=</span><span class="token string">"user-rules.txt"</span></pre></td></tr></table></figure></li><li><p>系统设置自动代理: <strong>设置 -&gt; 网络 -&gt; 网络代理</strong>，<strong>方式</strong>改为<strong>自动</strong>，<strong>配置<br>URL</strong> 改为： <code>file://root/vpnPAC/autoproxy.pac</code></p></li></ol><h3 id="优化"><a class="anchor" href="#优化">#</a> 优化<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU0JUJDJTk4JUU1JThDJTk2"></span></h3><ol><li>设置开机启动：通过 <code>kali linux</code> 自带的优化工具实现: <code>Win+a</code> , 直接输入优化工具，出现优化工具图标（当然你也可以自己找），双击，找到开机启动程序，添加 <code>shadowsock-qt5</code></li><li>自动连接某个节点：打开 <code>bash</code> ，输入 <code>ss-qt5</code> ，<strong>右键某个节点 -&gt; 编辑 -&gt; 程序启动时自动连接</strong></li><li>通过快捷键开启或关闭 shadowsocks-qt5: <strong>设置 -&gt; 键盘 -&gt; 添加自定义快捷键</strong>（滑到最下面你会看到一个 <code>+</code> ）， <strong>名字</strong>可以随意，<strong>命令</strong>输入 <code>ss-qt5</code> （关闭时输入 <code>pkill ss-qt5</code> ），<strong>按键</strong>设置成你喜欢的即可。</li></ol><h2 id="shadowsocks-libev"><a class="anchor" href="#shadowsocks-libev">#</a> shadowsocks-libev<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU0JUJEJUJGJUU3JTk0JUE4LXNoYWRvd3NvY2tzLWxpYmV2"></span></h2><h3 id="简介-2"><a class="anchor" href="#简介-2">#</a> 简介<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU3JUFFJTgwJUU0JUJCJThCLTE="></span></h3><blockquote><p>shadowsocks-libev 是一个 shadowsocks 协议的轻量级实现，是 shadowsocks-android, shadowsocks-ios 以及 shadowsocks-openwrt 的上游项目。其具有以下特点：</p><ul><li><p>体积小巧，静态编译并打包后只有 100 KB。</p></li><li><p>高并发，基于 libev 实现的异步 I/O，以及基于线程池的异步 DNS，同时连接数可上万。</p></li><li><p>低资源占用，几乎不占用 CPU 资源，服务器端内存占用一般在 3MB 左右。</p></li><li><p>跨平台，适用于所有常见硬件平台，已测试通过的包括 x86 ARM 和 MIPS。也适用于大部分 POSIX 的操作系统或平台，包括 Linux，OS X 和 gwin 等。</p></li><li><p>协议及配置兼容，完全兼容 shadowsocks 协议，且兼容标准实现中的 JSON 风格配置文件，可与任意实现的 shadowsocks 端或服务端搭配使用。</p></li></ul><p>—— 引用自<span class="exturl" data-url="aHR0cHM6Ly9yb3hoYWl5LndvcmRwcmVzcy5jb20vMjAxNy8wOC8wNC80MzAv"> CentOS 7 配置 shadowsocks-libev 服务器端进行科学上网 | 鸣沙山侧 月牙泉畔</span></p></blockquote><h3 id="安装-2"><a class="anchor" href="#安装-2">#</a> 安装<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU1JUFFJTg5JUU4JUEzJTg1LTE="></span></h3><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">apt</span> <span class="token function">install</span> shadowsocks-libev</pre></td></tr></table></figure><p>查看该软件包中有哪些文件：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>dpkg -l shadowsocks-libev</pre></td></tr></table></figure><h3 id="配置-2"><a class="anchor" href="#配置-2">#</a> 配置<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU5JTg1JThEJUU3JUJEJUFFLTE="></span></h3><p>修改配置文件 <code>/etc/shadowsocks-libev/config.json</code> ：</p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">"server"</span><span class="token operator">:</span><span class="token string">"serverip"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">"server_port"</span><span class="token operator">:</span><span class="token number">1234</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token property">"local_address"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token property">"local_port"</span><span class="token operator">:</span><span class="token number">1080</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"shadowsocks"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token property">"timeout"</span><span class="token operator">:</span><span class="token number">60</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token property">"method"</span><span class="token operator">:</span><span class="token string">"aes-256-cfb"</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="控制"><a class="anchor" href="#控制">#</a> 控制<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU2JThFJUE3JUU1JTg4JUI2"></span></h3><p>使用如下命令启动：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>systemctl start shadowsocks-libev-local@config</pre></td></tr></table></figure><p>其中 <code>config</code> 是你的配置文件的名字（ <code>config.json</code> ），如果变了，则这里也需要变</p><p>使用如下命令设置开机自启：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>systemctl <span class="token builtin class-name">enable</span> shadowsocks-libev-local@config</pre></td></tr></table></figure><p>……</p><h3 id="查看日志"><a class="anchor" href="#查看日志">#</a> 查看日志<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU2JTlGJUE1JUU3JTlDJThCJUU2JTk3JUE1JUU1JUJGJTk3"></span></h3><ul><li><code>/var/log/syslog</code></li><li><code>journalctl -u shadowsocks-libev-local@config</code></li></ul><h3 id="后续步骤"><a class="anchor" href="#后续步骤">#</a> 后续步骤<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU1JTkwJThFJUU3JUJCJUFEJUU2JUFEJUE1JUU5JUFBJUE0"></span></h3><p>参见 <span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jcGMtJUU4JUJGJTlFJUU2JThFJUE1JUU1JTg4JUIwLXNzci1sb2NhbA==">PC 连接到 SSR Local</span></p><h1 id="ssr"><a class="anchor" href="#ssr">#</a> SSR<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jc3Ny"></span></h1><p>SSR 的诸多实现如下（和<br>SS 类似）：</p><table><thead><tr><th>实现</th><th>编程语言</th><th>适用平台</th><th>最近一次更新</th><th>服务器 or 客户端</th></tr></thead><tbody><tr><td>shadowsocksr</td><td>Python</td><td>Linux, OSX</td><td>2018-05</td><td>both</td></tr><tr><td>shadowsocksr-libev</td><td>C</td><td>Linux, OSX, openwrt</td><td>2018-03</td><td>both</td></tr><tr><td>shadowsocksr-android</td><td>Java,Go</td><td>Android</td><td>2018-03</td><td>client</td></tr><tr><td>shadowsocks-csharp</td><td>C#</td><td>Windows</td><td>2018-04</td><td>client</td></tr><tr><td>electron-ssr</td><td>JavaScript, Vue</td><td>Linux, OSX, Windows</td><td>2019-05</td><td>client</td></tr></tbody></table><h2 id="shadowsocksrpython-版"><a class="anchor" href="#shadowsocksrpython-版">#</a> shadowsocksr（Python 版）（</h2><p>SSR Local 连接到</p><p>SSR Server<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jc2hhZG93c29ja3NycHl0aG9uLSVFNyU4OSU4OHNzci1sb2NhbC0lRTglQkYlOUUlRTYlOEUlQTUlRTUlODglQjAtc3NyLXNlcnZlcg=="></span></p><ul><li><p>操作系统：Kali Linux。实际上只要是 Linux 将本文内容稍加修改也适用。毕竟核心的东西是不变的</p><ul><li><p>使用的</p><p>SSR 客户端：shadowsocksr（Python 版）。</p></li></ul></li></ul><p>2019-07-05 更新： 该部分阐述了如何让<br>SSR Local 连接到<br>SSR Server。在<br>SSR Local 和<br>SSR Server 通信的过程中使用的协议为<br>SSR</p><p>之所以使用 Python 版，是因为我只找到 Python 版的，/ 笑哭。 这一步是最重要的，后面的方法都建立在这个基础之上</p><p>2019-07-03 更新：事实上，<br>SSR 现在可用的 Linux 客户端有三个，shadowsocksr, shadowsocksr-libev, electron-ssr，参见前文的表格</p><h3 id="安装-3"><a class="anchor" href="#安装-3">#</a> 安装<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU1JUFFJTg5JUU4JUEzJTg1LTI="></span></h3><p>获得 Python 版<br>SSR 的相关文件：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">cd</span> ~/</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">git</span> clone https://github.com/shadowsocksrr/shadowsocksr</pre></td></tr></table></figure><p>经测试，其实只有 shadowsocksr 下的 shadowsocks 目录是必须的</p><h3 id="配置-3"><a class="anchor" href="#配置-3">#</a> 配置<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU5JTg1JThEJUU3JUJEJUFFLTI="></span></h3><p>根据你的服务器配置修改配置文件 <code>~/shadowsocksr/config.json</code> :</p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token property">"server"</span><span class="token operator">:</span> <span class="token string">"&lt;ip address>"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token property">"server_ipv6"</span><span class="token operator">:</span> <span class="token string">"::"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token property">"server_port"</span><span class="token operator">:</span> <span class="token number">8388</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token property">"local_address"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token property">"local_port"</span><span class="token operator">:</span> <span class="token number">1080</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"password"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token property">"method"</span><span class="token operator">:</span> <span class="token string">"none"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token property">"protocol"</span><span class="token operator">:</span> <span class="token string">"auth_chain_a"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token property">"protocol_param"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token property">"obfs"</span><span class="token operator">:</span> <span class="token string">"plain"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token property">"obfs_param"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token property">"speed_limit_per_con"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token property">"speed_limit_per_user"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token property">"additional_ports"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token property">"additional_ports_only"</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token property">"timeout"</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token property">"udp_timeout"</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token property">"dns_ipv6"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token property">"connect_verbose_info"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token property">"redirect"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token property">"fast_open"</span><span class="token operator">:</span> <span class="token boolean">false</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="启动"><a class="anchor" href="#启动">#</a> 启动<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU1JTkwJUFGJUU1JThBJUE4"></span></h3><p>启动<br>SSR 客户端：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">cd</span> ~/shadowsocksr/shadowsocks</pre></td></tr><tr><td data-num="2"></td><td><pre>python2 local.py -c ~/shadowsocksr/config.json</pre></td></tr></table></figure><h3 id="测试"><a class="anchor" href="#测试">#</a> 测试<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU2JUI1JThCJUU4JUFGJTk1"></span></h3><p>下面的每个步骤都建立在前一个步骤成功的基础上：</p><ol><li><p>使用命令 <code>ss -ltn | grep 1080</code> ，其输出应当如下：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>LISTEN     <span class="token number">0</span>      <span class="token number">128</span>          <span class="token number">127.0</span>.0.1:1080                     *:*</pre></td></tr></table></figure><p>如果失败，说明启动失败，可能是配置文件错误导致的</p></li><li><p>使用浏览器进行测试，即选择 <span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU2JUI1JThGJUU4JUE3JTg4JUU1JTk5JUE4JUU1JTg1JUE4JUU1JUIxJTgwJUU0JUJCJUEzJUU3JTkwJTg2">浏览器全局代理</span> 这部分的方法进行测试</p><p>如果失败，则可能是服务器连不上导致的</p></li></ol><h3 id="自动化"><a class="anchor" href="#自动化">#</a> 自动化<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU4JTg3JUFBJUU1JThBJUE4JUU1JThDJTk2"></span></h3><p>每次手动启动实在太麻烦，可以写个脚本让它在打开终端时自动启动，也可以让它开机自启。对于前者，可将如下 bash 脚本添加到 <code>~/.bashrc</code> 文件中（我自己写的，欢迎提建议）：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">function</span> <span class="token function-name function">pg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> -v <span class="token string">"grep"</span> <span class="token operator">|</span><span class="token function">grep</span> <span class="token variable">$1</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">function</span> <span class="token function-name function">ssr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token function">ps</span> aux <span class="token operator">|</span><span class="token function">grep</span> <span class="token string">"[l]ocal\.py"</span> <span class="token operator">></span> /dev/null</pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> -eq <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="7"></td><td><pre>		python ~/shadowsocksr/shadowsocks/local.py -c ~/shadowsocksr/config.json -d start</pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">else</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">[</span> -n <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span></pre></td></tr><tr><td data-num="10"></td><td><pre>			<span class="token function">kill</span> <span class="token variable"><span class="token variable">`</span>pg <span class="token string">"local\.py"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token variable">`</span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token keyword">else</span></pre></td></tr><tr><td data-num="12"></td><td><pre>			<span class="token builtin class-name">echo</span> <span class="token string">"ssr has been run!"</span></pre></td></tr><tr><td data-num="13"></td><td><pre>		<span class="token keyword">fi</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">fi</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>ssr</pre></td></tr></table></figure><p>简要说一下上面那个函数 <code>ssr</code> 的用法：直接在 bash 中输入 <code>ssr</code> 后回车则后台启动（关闭终端也能继续运行）ssr 客户端，输入 <code>ssr &lt;任意字符&gt;</code> 则关闭已启动的 ssr 客户端。</p><h3 id="后续步骤-2"><a class="anchor" href="#后续步骤-2">#</a> 后续步骤<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU1JTkwJThFJUU3JUJCJUFEJUU2JUFEJUE1JUU5JUFBJUE0LTE="></span></h3><p>参见 <a target="_blank" rel="noopener" href="https://wsxq2.55555.io/blog/2018/10/20/Kali-Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/#pc-%E8%BF%9E%E6%8E%A5%E5%88%B0-ssr-local">PC 连接到<br>SSR Local</a></p><h1 id="pc-连接到ssr-local"><a class="anchor" href="#pc-连接到ssr-local">#</a> PC 连接到 SSR Local<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jcGMtJUU4JUJGJTlFJUU2JThFJUE1JUU1JTg4JUIwLXNzci1sb2NhbA=="></span></h1><p>2019-07-03 更新： 该部分阐述了如何让<br>SSR Local 监听到数据，即如何让应用程序走本地代理。本地代理使用的协议为 socks5。</p><h2 id="浏览器全局代理"><a class="anchor" href="#浏览器全局代理">#</a> 浏览器全局代理<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU2JUI1JThGJUU4JUE3JTg4JUU1JTk5JUE4JUU1JTg1JUE4JUU1JUIxJTgwJUU0JUJCJUEzJUU3JTkwJTg2"></span></h2><p>2019-07-04 更新：本部分的目标在于让浏览器浏览所有网页时都走代理。只需在浏览器中设置手动代理即可</p><p>以 FireFox 为例：</p><ol><li><p>找到浏览器中的手动代理设置的位置：点击右上角的菜单，选择<strong> Preferences</strong>，选择<strong> General</strong>，滑到最下面，选择<strong> Network Proxy</strong> 标签下的<strong> Settings</strong>，选择<strong> Manual proxy configuration</strong></p></li><li><p>配置：找到<strong> SOCKS Host</strong> 一栏，填入 <code>127.0.0.1</code> 和 <code>1080</code> ，在下面选择<strong> SOCKS v5</strong>，其它栏留空（如<strong> HTTP Proxy</strong>）。并在之后的<strong> No Proxy for</strong> 中填入不需要代理的网址或<br>IP 地址或网段（例如 127.0.0.1、192.168.0.0/16 等）。</p><p>2019-07-04 更新：记得勾选下方的<strong> Proxy<br>DNS when using<br>SOCKS v5</strong> 以防止<br>GFW 的<br>DNS 污染。此外，对第 2 步的手动配置代理中的说明如下：</p><ul><li><p><strong>HTTP Proxy</strong>：</p><p>HTTP 代理服务器地址。须知，使用前面的方法在 <code>127.0.0.1 1080</code> 处搭建的代理服务器是</p><p>SOCKS 代理服务器（不是</p><p>HTTP 代理服务器），且使用的是 socks5 协议（不是 socks4/socks4a 协议）。所以在这里填写 <code>127.0.0.1 1080</code> 将无法访问（即必须留空）</p></li><li><p><strong>SSL Proxy</strong>：访问</p><p>HTTPS 站点时使用的代理服务器地址，其实就是</p><p>HTTP 代理服务器地址。留空原因同上</p></li><li><p><strong>FTP Proxy</strong>：访问</p><p>FTP 站点时使用的代理服务器地址，其实就是</p><p>HTTP 代理服务器地址（不过需要注意的是</p><p>FTP 代理是存在的，例如使用工具 <code>ftp.proxy</code> ）。留空原因同上</p></li><li><p><strong>SOCKS Host</strong>：访问任意站点时使用的代理服务器地址。</p></li></ul></li></ol><p>完！</p><p>这时便可以访问<span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8="> https://www.google.com</span> 了，简单吧？</p><h2 id="系统全局代理"><a class="anchor" href="#系统全局代理">#</a> 系统全局代理<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU3JUIzJUJCJUU3JUJCJTlGJUU1JTg1JUE4JUU1JUIxJTgwJUU0JUJCJUEzJUU3JTkwJTg2"></span></h2><p>在系统设置中的网络代理方式设为<strong>手动</strong>，并将相应的<strong> Socks Host</strong> 改为 <code>127.0.0.1 1080</code> 即可。具体步骤如下：</p><ol><li><p>设置系统手动代理：设置 -&gt; 网络 -&gt; 网络代理，方式改为<strong>手动</strong>，<strong>SOCKS Host</strong> 改为 <code>127.0.0.1 1080</code> ，其它留空（留空的理由和前文类似）</p><p><strong>温馨提示</strong>：该处的设置依赖于 <code>network-manager</code> 服务，应确保其正在运行。（有的人因为 <code>network-manager.service</code> 和 <code>networking.service</code> 冲突所以采取网上的建议将 <code>network-manager.service</code> 给禁用了，结果导致系统设置中和网络相关的设置均不可用。好吧，说的就是我自己 <code>-_-</code> ）可以使用 <code>systemctl</code> 命令查看 <code>network-manager.service</code> 的状态，如下所示：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>root@kali:~<span class="token comment"># systemctl status network-manager.service </span></pre></td></tr><tr><td data-num="2"></td><td><pre>● NetworkManager.service - Network Manager</pre></td></tr><tr><td data-num="3"></td><td><pre>   Loaded: loaded <span class="token punctuation">(</span>/lib/systemd/system/NetworkManager.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: enabled<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since Thu <span class="token number">2019</span>-07-04 <span class="token number">23</span>:30:33 CST<span class="token punctuation">;</span> 19h ago</pre></td></tr><tr><td data-num="5"></td><td><pre>     Docs: man:NetworkManager<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre> Main PID: <span class="token number">396</span> <span class="token punctuation">(</span>NetworkManager<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    Tasks: <span class="token number">3</span> <span class="token punctuation">(</span>limit: <span class="token number">4695</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>   Memory: <span class="token number">13</span>.8M</pre></td></tr><tr><td data-num="9"></td><td><pre>   CGroup: /system.slice/NetworkManager.service</pre></td></tr><tr><td data-num="10"></td><td><pre>           └─396 /usr/sbin/NetworkManager --no-daemon</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.6270</span><span class="token punctuation">]</span> manager: NetworkManager state is now CONNECTED_GLOBAL</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.7143</span><span class="token punctuation">]</span> modem-manager: ModemManager available</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.7188</span><span class="token punctuation">]</span> device <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>: state change: disconnected -<span class="token operator">></span> prepare <span class="token punctuation">(</span>reason <span class="token string">'none'</span>, sys-iface-state: <span class="token string">'external'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.7203</span><span class="token punctuation">]</span> device <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>: state change: prepare -<span class="token operator">></span> config <span class="token punctuation">(</span>reason <span class="token string">'none'</span>, sys-iface-state: <span class="token string">'external'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.7210</span><span class="token punctuation">]</span> device <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>: state change: config -<span class="token operator">></span> ip-config <span class="token punctuation">(</span>reason <span class="token string">'none'</span>, sys-iface-state: <span class="token string">'external'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.7215</span><span class="token punctuation">]</span> device <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>: state change: ip-config -<span class="token operator">></span> ip-check <span class="token punctuation">(</span>reason <span class="token string">'none'</span>, sys-iface-state: <span class="token string">'external'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.7226</span><span class="token punctuation">]</span> device <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>: state change: ip-check -<span class="token operator">></span> secondaries <span class="token punctuation">(</span>reason <span class="token string">'none'</span>, sys-iface-state: <span class="token string">'external'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.7233</span><span class="token punctuation">]</span> device <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>: state change: secondaries -<span class="token operator">></span> activated <span class="token punctuation">(</span>reason <span class="token string">'none'</span>, sys-iface-state: <span class="token string">'external'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.8065</span><span class="token punctuation">]</span> device <span class="token punctuation">(</span>eth0<span class="token punctuation">)</span>: Activation: successful, device activated.</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token number">7</span>月 04 <span class="token number">23</span>:30:35 kali.abc.com NetworkManager<span class="token punctuation">[</span><span class="token number">396</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>info<span class="token operator">></span>  <span class="token punctuation">[</span><span class="token number">1562254235.8200</span><span class="token punctuation">]</span> manager: startup complete</pre></td></tr><tr><td data-num="22"></td><td><pre>root@kali:~<span class="token comment">#</span></pre></td></tr></table></figure><p>另外，这一步中的设置完成后，每次打开新终端的时候，检查代理相关的环境变量，你会发现：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>root@kali:~<span class="token comment"># env|grep -i proxy</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">ALL_PROXY</span><span class="token operator">=</span>socks://127.0.0.1:1080/</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">no_proxy</span><span class="token operator">=</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">NO_PROXY</span><span class="token operator">=</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">all_proxy</span><span class="token operator">=</span>socks://127.0.0.1:1080/</pre></td></tr><tr><td data-num="6"></td><td><pre>root@kali:~<span class="token comment">#</span></pre></td></tr></table></figure><p>所以这个步骤的实质只是设置了下环境变量 <img data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png" alt=":joy:" title=":joy:"></p><p>假如你在系统的网络代理设置中将所有代理均设置为 <code>127.0.0.1 1080</code> 且<strong> Ignore Hosts</strong> 设置为 <code>127.0.0.1, 192.168.0.0/16</code> ，那么在新打开的终端中检查代理相关的环境变量，你会发现：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>root@kali:~<span class="token comment"># env|grep -i proxy</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">HTTP_PROXY</span><span class="token operator">=</span>http://127.0.0.1:1080/</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">FTP_PROXY</span><span class="token operator">=</span>http://127.0.0.1:1080/</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">https_proxy</span><span class="token operator">=</span>http://127.0.0.1:1080/</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">http_proxy</span><span class="token operator">=</span>http://127.0.0.1:1080/</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token assign-left variable">ALL_PROXY</span><span class="token operator">=</span>socks://127.0.0.1:1080/</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token assign-left variable">no_proxy</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1,192.168.0.0/16</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token assign-left variable">NO_PROXY</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1,192.168.0.0/16</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token assign-left variable">HTTPS_PROXY</span><span class="token operator">=</span>http://127.0.0.1:1080/</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token assign-left variable">all_proxy</span><span class="token operator">=</span>socks://127.0.0.1:1080/</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token assign-left variable">ftp_proxy</span><span class="token operator">=</span>http://127.0.0.1:1080/</pre></td></tr><tr><td data-num="12"></td><td><pre>root@kali:~<span class="token comment">#</span></pre></td></tr></table></figure><p>同样印证了上述结论 —— 在 Kali 系统设置中的网络代理设置处进行手动代理设置实质上是修改了代理相关的环境变量</p><p>需要注意的是（如前文所述），通用代理只有两种：<br>HTTP 代理（使用 http 协议）和<br>SOCKS 代理（使用 socks4/socks4a/socks5 协议）。即代理相关环境变量中，每个变量 <code>=</code> 后面的协议部分必需是 <code>http/socks4/socks4a/socks5</code> 之一（对于 <code>curl</code> 还支持 <code>socks5h</code> ）</p></li><li><p>测试：打开浏览器，输入网址 <code>www.google.com</code> 看是否访问成功</p><p>2019-07-05 更新：如果使用的浏览器是 FireFox，则还需要将网络代理设置为<strong> Use system proxy settings</strong>。同样要记得勾选下方的<strong> Proxy<br>DNS when using<br>SOCKS v5</strong> 以防止<br>GFW 的<br>DNS 污染</p></li></ol><h2 id="真系统全局代理透明代理"><a class="anchor" href="#真系统全局代理透明代理">#</a> 真・系统全局代理（透明代理）<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU3JTlDJTlGJUU3JUIzJUJCJUU3JUJCJTlGJUU1JTg1JUE4JUU1JUIxJTgwJUU0JUJCJUEzJUU3JTkwJTg2JUU5JTgwJThGJUU2JTk4JThFJUU0JUJCJUEzJUU3JTkwJTg2"></span></h2><p>如前所述，在 Kali 系统设置中的网络代理设置处进行手动代理设置实质上是修改了代理相关的环境变量。对于 linux 下不支持代理的程序而言，前面的设置并没有什么用，即并非真的实现了全局代理。那么如果要实现真正意义上的全局代理，即让所有应用都经过代理服务器该怎么办？答案是使用 tsocks：</p><ul><li><span class="exturl" data-url="aHR0cDovL3Rzb2Nrcy5zb3VyY2Vmb3JnZS5uZXQv">tsocks 官网</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvdHNvY2tzL2ZpbGVzL3Rzb2Nrcy8=">tsocks 下载链接</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9saW51eC5kaWUubmV0L21hbi84L3Rzb2Nrcw==">tsocks 手册</span></li></ul><blockquote><p>tsocks 利用 LD_PRELOAD 机制，代理程序里的 <code>connect</code> 函数，然后就可以代理所有的<br>TCP 请求了。不过对于 dns 请求，默认是通过 udp 来发送的，所以 tsocks 不能代理 dns 请求。</p><p>默认情况下，tsocks 会先加载 <code>~/.tsocks.conf</code> ，如果没有，再加载 <code>/etc/tsocks.conf</code> 。对于 local ip 不会代理。</p><p>使用方法：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> tsocks</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">LD_PRELOAD</span><span class="token operator">=</span>/usr/lib/libtsocks.so <span class="token function">wget</span> http://www.facebook.com</pre></td></tr></table></figure><p>—— 引用自<span class="exturl" data-url="aHR0cDovL2hlbmd5dW5hYmMuZ2l0aHViLmlvL3NvbWV0aGluZy1hYm91dC1zY2llbmNlLXN1cmYtdGhlLWludGVybmV0Lw==">科学上网的一些原理 | 横云断岭的专栏</span></p></blockquote><h2 id="通过-socks-代理进行-dns-查询"><a class="anchor" href="#通过-socks-代理进行-dns-查询">#</a> 通过 SOCKS 代理进行 DNS 查询<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU5JTgwJTlBJUU4JUJGJTg3LXNvY2tzLSVFNCVCQiVBMyVFNyU5MCU4NiVFOCVCRiU5QiVFOCVBMSU4Qy1kbnMtJUU2JTlGJUE1JUU4JUFGJUEy"></span></h2><p>使用 <span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvZG5zMnNvY2tzLw==">dns2socks</span>（Github 上也有其项目地址 https://github.com/qiuzi/dns2socks）或 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYXduMW0vb3ZlcnR1cmU=">overture</span></p><p>此外，shadowsocks-libev 中的 ss-tunnel 也能实现该功能。和 dns2socks 相比，ss-tunnel 走<br>TCP（即 socks5），而 dns2socks 走<br>UDP</p><p>具体步骤就不详述了</p><p>对了，<br>HTTP 代理<br>DNS 的解析必然是通过代理的：</p><blockquote><p>对于<br>HTTP/<br>HTTPS 类型的代理服务器而言，请求的域名会作为<br>HTTP 协议的一部分直接发往代理服务器，不会在本地进行任何解析操作。也就是说，域名的解析与连接目标服务器，是代理服务器的职责。浏览器本身甚至无须知道最终服务器的<br>IP 地址。据我所知，此行为无法通过浏览器选项等更改。</p><p>也就是说，理论上使用<br>HTTP/<br>HTTPS 类型的代理服务器时，本地的<br>DNS 解析、缓存、 hosts 文件等都不使用，与本地设置的<br>DNS 服务器地址无关。<br>DNS 解析完全在代理服务器上进行。</p><p>—— 引用自<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZlbGlzQ2F0dXMvU3dpdGNoeU9tZWdhL2lzc3Vlcy85NjMjaXNzdWVjb21tZW50LTI3MDA1NTIyMQ==">请问在设置 http/https 代理后 DNS 的解析还是通过 proxy 吗？</span></p></blockquote><h2 id="转换-socks-代理为-http-代理"><a class="anchor" href="#转换-socks-代理为-http-代理">#</a> 转换 SOCKS 代理为 HTTP 代理<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU4JUJEJUFDJUU2JThEJUEyLXNvY2tzLSVFNCVCQiVBMyVFNyU5MCU4NiVFNCVCOCVCQS1odHRwLSVFNCVCQiVBMyVFNyU5MCU4Ng=="></span></h2><p>2019-07-04 更新：相关的工具有很多，例如 Polipo、privoxy 等。这里使用的工具是 Polipo。需要注意的是 Polipo 最后一次更新是在 2014-05-15（参见 <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUG9saXBv">Polipo - Wikipedia</span>）</p><p>如前所述，通用代理只有两种：<br>HTTP 代理（使用<br>HTTP 协议）和<br>SOCKS 代理（使用 socks4/socks4a/socks5 协议）。最常见且最普及的是前者，有的应用不支持后者。所以为了让那些不支持<br>SOCKS 代理的应用程序使用代理，需要将<br>SOCKS 转换为<br>HTTP 代理。</p><p><code>Polipo</code> 可以用来将 <code>SOCKS</code> 的代理转换为 <code>HTTP</code> 的代理，从而使那些只支持 <code>HTTP</code> 代理的软件（如 <code>wget</code> ，部分浏览器，部分操作系统（如 Windows 就只支持 http 代理和 socks4 代理，这是我通过抓包分析发现的））也可以科学上网</p><ol><li><p>安装 <code>polipo</code> :</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">apt</span> <span class="token function">install</span> polipo</pre></td></tr></table></figure></li><li><p>修改 <code>/etc/polipo/config</code> 文件为如下内容：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>logSyslog <span class="token operator">=</span> <span class="token boolean">true</span></pre></td></tr><tr><td data-num="2"></td><td><pre>logFile <span class="token operator">=</span> /var/log/polipo/polipo.log</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>socksParentProxy <span class="token operator">=</span> <span class="token string">"127.0.0.1:1080"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>socksProxyType <span class="token operator">=</span> socks5</pre></td></tr><tr><td data-num="6"></td><td><pre>proxyAddress <span class="token operator">=</span> <span class="token string">"0.0.0.0"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>proxyPort <span class="token operator">=</span> <span class="token number">8123</span></pre></td></tr></table></figure></li><li><p>重启 <code>polipo</code> （安装后它会自动启动，故这里说重启）：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>systemctl restart polipo</pre></td></tr></table></figure></li><li><p>验证 polipo 是否正常工作：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">export</span> <span class="token assign-left variable">http_proxy</span><span class="token operator">=</span>http://127.0.0.1:8123/</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">curl</span> www.google.com</pre></td></tr></table></figure><p>如果正常，就会返回抓取到的 Google 网页内容。可通过 <code>man polipo</code> 查看其帮助文档。</p></li></ol><h2 id="浏览器自动代理"><a class="anchor" href="#浏览器自动代理">#</a> 浏览器自动代理<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU2JUI1JThGJUU4JUE3JTg4JUU1JTk5JUE4JUU4JTg3JUFBJUU1JThBJUE4JUU0JUJCJUEzJUU3JTkwJTg2"></span></h2><p>2019-07-04 更新：本部分的目标在于让浏览器根据浏览的网站的不同自动选择是否走代理，例如对于国外网站走代理，对于国内网站不走代理。方法也很简单，使用浏览器插件即可，FireFox 用 FoxyProxy，Chrome 用 SwitchyOmega。</p><p>FoxyProxy 是 Firefox 浏览器中的一个非常好用的代理插件。因为有科学上网需求的主要是浏览器，故若只是为了让浏览器科学上网，则可采用此方法。当然，如果用的是 Chrome ，则可采用 Chrome + SwitchyOmega 的方案替代之。</p><ol><li><p>安装 <code>FoxyProxy</code> 插件：<span class="exturl" data-url="aHR0cHM6Ly9hZGRvbnMubW96aWxsYS5vcmcvZW4tVVMvZmlyZWZveC9hZGRvbi9mb3h5cHJveHktc3RhbmRhcmQv">https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/</span></p></li><li><p>设置 <code>FoxyProxy</code> 选项：</p><ol><li><strong>Add Proxy</strong>: <code>Proxy Type</code> 选 <code>SOCKS5</code> ， <code>IP address</code> 填 <code>127.0.0.1</code> ， <code>Port</code> 填 <code>1080</code> ，记得最后点下 <code>Save</code></li><li>添加 <code>Patterns</code> : 在选项主界面，点击刚刚添加的 <code>Proxy</code> 的 <code>Patterns</code> ，根据自己的需要添加 <code>Patterns</code></li></ol></li><li><p>启用 <code>FoxyProxy</code> ：单击浏览器中右上角相应的图标，选择 <code>Use Enabled Proxies By Patterns and Priority</code></p></li><li><p>测试：输入网址 <code>www.google.com</code> 看是否访问成功</p></li></ol><h2 id="pac代理自动配置"><a class="anchor" href="#pac代理自动配置">#</a> PAC（代理自动配置）<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jcGFjJUU0JUJCJUEzJUU3JTkwJTg2JUU4JTg3JUFBJUU1JThBJUE4JUU5JTg1JThEJUU3JUJEJUFF"></span></h2><blockquote><p>代理自动配置（英语：Proxy auto-config，简称<br>PAC）是一种网页浏览器技术，用于定义浏览器该如何自动选择适当的代理服务器来访问一个网址。</p><p>一个<br>PAC 文件包含一个 JavaScript 形式的函数 “FindProxyForURL (url, host)”。这个函数返回一个包含一个或多个访问规则的字符串。用户代理根据这些规则适用一个特定的代理器或者直接访问。当一个代理服务器无法响应的时候，多个访问规则提供了其他的后备访问方法。浏览器在访问其他页面以前，首先访问这个<br>PAC 文件。<br>PAC 文件中的<br>URL 可能是手工配置的，也可能是是通过网页的网络代理自动发现协议（<br>WPAD）自动配置的。</p><p>—— 引用自<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU0JUJCJUEzJUU3JTkwJTg2JUU4JTg3JUFBJUU1JThBJUE4JUU5JTg1JThEJUU3JUJEJUFF">代理自动配置 - 维基百科，自由的百科全书</span></p></blockquote><p>2019-07-06 更新：另外还可参见 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2JyZWFrd2ExMS9nZndfd2hpdGVsaXN0">breakwa11/gfw_whitelist: gfw_whitelist</span> 了解关于<br>PAC 的更多信息</p><p>此方法主要使用了 <code>genpac</code> （GENerate<br>PAC file）生成<br>PAC 文件，并将系统设置中的网络代理方式改为自动，将其 <code>Configuration URL</code> 指向相应的<br>PAC 文件位置。具体过程如下：</p><ol><li><p>安装 <code>genpac</code> ：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#安装</span></pre></td></tr><tr><td data-num="2"></td><td><pre>pip <span class="token function">install</span> genpac</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#更新</span></pre></td></tr><tr><td data-num="4"></td><td><pre>pip <span class="token function">install</span> --upgrade genpac</pre></td></tr></table></figure></li><li><p>生成</p><p>PAC 文件：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">mkdir</span> ~/.pac</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">cd</span> ~/.pac</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">touch</span> user-rules.txt <span class="token comment">#可在此文件中添加用户自定义规则，此处省略</span></pre></td></tr><tr><td data-num="4"></td><td><pre>genpac --pac-proxy <span class="token string">"SOCKS5 127.0.0.1:1080"</span> --output<span class="token operator">=</span><span class="token string">"ProxyAutoConfig.pac"</span> --user-rule-from<span class="token operator">=</span><span class="token string">"user-rules.txt"</span></pre></td></tr></table></figure></li><li><p>设置系统自动代理：<strong>设置 -&gt; 网络 -&gt; 网络代理</strong>，方式改为<strong>自动</strong>， <code>Configuration URL</code> 改为 <code>file:///root/.pac/ProxyAutoConfig.pac</code> （注意我用的是 root 用户，如果非 root 用户请将 <code>/root</code> 改为 <code>/home/&lt;your username&gt;</code> ）</p></li><li><p>测试：打开浏览器，输入网址 <code>www.google.com</code> 看是否访问成功</p></li></ol><p>2019-07-03 更新：该方法存在的问题是如果你的<br>PAC 文件失效了，可能需要重新下载<br>PAC 文件，即重新执行第 2 步中的 <code>genpac</code> 步骤。</p><h2 id="关于终端下的代理设置"><a class="anchor" href="#关于终端下的代理设置">#</a> 关于终端下的代理设置<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU1JTg1JUIzJUU0JUJBJThFJUU3JUJCJTg4JUU3JUFCJUFGJUU0JUI4JThCJUU3JTlBJTg0JUU0JUJCJUEzJUU3JTkwJTg2JUU4JUFFJUJFJUU3JUJEJUFF"></span></h2><h3 id="终端代理环境变量"><a class="anchor" href="#终端代理环境变量">#</a> 终端代理环境变量<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU3JUJCJTg4JUU3JUFCJUFGJUU0JUJCJUEzJUU3JTkwJTg2JUU3JThFJUFGJUU1JUEyJTgzJUU1JThGJTk4JUU5JTg3JThG"></span></h3><p>如前文所述，通用代理只有两种：<br>HTTP 代理（使用 http 协议）和<br>SOCKS 代理（使用 socks4/socks4a/socks5 协议）。即代理相关环境变量中，每个变量 <code>=</code> 后面的协议部分必需是 <code>http/socks4/socks4a/socks5</code> 之一（对于 <code>curl</code> 还支持 <code>socks5h</code> ）。如下所示则全将其设置为了 <code>socks5</code> ：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># Set Proxy</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">function</span> <span class="token function-name function">sp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">all_proxy</span><span class="token operator">=</span>socks5://127.0.0.1:1080/</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">ALL_PROXY</span><span class="token operator">=</span>socks5://127.0.0.1:1080/ <span class="token comment">#有的命令行工具使用大写的变量名，如 curl</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">http_proxy</span><span class="token operator">=</span>socks5://127.0.0.1:1080/ <span class="token comment">#有的命令行工具使用小写的变量名，如 curl、wget</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">ftp_proxy</span><span class="token operator">=</span>socks5://127.0.0.1:1080/ <span class="token comment">#有的命令行工具使用小写的变量名，如 wget</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">FTP_PROXY</span><span class="token operator">=</span>socks5://127.0.0.1:1080/ <span class="token comment">#有的命令行工具使用大写的变量名，如 curl</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">https_proxy</span><span class="token operator">=</span>socks5://127.0.0.1:1080/ <span class="token comment">#有的命令行工具使用小写的变量名，如 wget</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">HTTPS_PROXY</span><span class="token operator">=</span>socks5://127.0.0.1:1080/ <span class="token comment">#有的命令行工具使用大写的变量名，如 curl</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">no_proxy</span><span class="token operator">=</span>localhost,127.0.0.1,192.168.0.0 <span class="token comment">#有的命令行工具使用小写的变量名，如 wget</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token builtin class-name">export</span> <span class="token assign-left variable">NO_PROXY</span><span class="token operator">=</span>localhost,127.0.0.1,192.168.0.0 <span class="token comment">#有的命令行工具使用大写的变量名，如 curl</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># Unset Proxy</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">function</span> <span class="token function-name function">up</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token builtin class-name">unset</span> all_proxy ALL_PROXY http_proxy ftp_proxy FTP_PROXY https_proxy HTTPS_PROXY no_proxy NO_PROXY</pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>其中的 <code>http_proxy</code> 表示访问 <code>http</code> 协议站点使用的代理，而不是使用 <code>http</code> 代理访问 <code>http</code> 协议站点。同理 <code>ftp_proxy</code> 表示访问 <code>ftp</code> 站点时使用的代理</p><h3 id="使用程序的代理相关参数"><a class="anchor" href="#使用程序的代理相关参数">#</a> 使用程序的代理相关参数<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU0JUJEJUJGJUU3JTk0JUE4JUU3JUE4JThCJUU1JUJBJThGJUU3JTlBJTg0JUU0JUJCJUEzJUU3JTkwJTg2JUU3JTlCJUI4JUU1JTg1JUIzJUU1JThGJTgyJUU2JTk1JUIw"></span></h3><ol><li><p><code>git</code> ：已知（亲测）支持 <code>socks5</code> 、 <code>http</code> 这两种代理方式，支持上述的终端代理环境变量。也可单独设置代理以覆盖全局设置：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 设置 `socks5` 代理</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">git</span> config --global http.proxy <span class="token string">'socks5://127.0.0.1:1080'</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">git</span> config --global https.proxy <span class="token string">'socks5://127.0.0.1:1080'</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 设置 `http` 代理</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">git</span> config --global https.proxy http://127.0.0.1:1080</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">git</span> config --global https.proxy https://127.0.0.1:1080</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 取消代理</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">git</span> config --global --unset http.proxy</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token function">git</span> config --global --unset https.proxy</pre></td></tr></table></figure><p>对应的 <code>.gitconfig</code> 配置文件内容如下：</p><figure class="highlight text"><figcaption data-lang="text"></figcaption><table><tr><td data-num="1"></td><td><pre>[http]</pre></td></tr><tr><td data-num="2"></td><td><pre>    proxy = socks5://127.0.0.1:1080</pre></td></tr><tr><td data-num="3"></td><td><pre>[https]</pre></td></tr><tr><td data-num="4"></td><td><pre>    proxy = socks5://127.0.0.1:1080</pre></td></tr></table></figure></li><li><p><code>curl</code> ：支持 <code>socks4</code> 、 <code>socks4a</code> 、 <code>socks5</code> 、 <code>http</code> 这几种代理方式，支持上述的终端代理环境变量。也可单独设置代理以覆盖全局设置：</p><pre><code>curl -i4 -m3 -x socks5://192.168.56.11:1080 https://www.google.com
curl -i4 -m3 -x socks5h://192.168.56.11:1080 https://www.google.com
</code></pre><p>注意 <code>socks5</code> 和 <code>socks5h</code> 的区别，前者解析域名时不使用代理，后者解析域名时要使用代理，由于国内<br>DNS 可能被污染，故建议使用 <code>socks5h</code> 。详情参见 <code>man curl</code> ：</p><blockquote><p>–socks5-hostname &lt;host[:port]&gt;</p><p>Use the specified SOCKS5 proxy (and let the proxy resolve the host name). If the port number is not specified, it is assumed at port 1080. (Added in 7.18.0)</p><p>–socks5 &lt;host[:port]&gt;</p><p>Use the specified SOCKS5 proxy - but resolve the host name locally. If the port number is not specified, it is assumed at port 1080.</p></blockquote></li><li><p><code>wget</code> : 似乎只支持 <code>http</code> 协议代理，支持上述的终端代理环境变量。不可单独设置代理以覆盖全局变量</p></li></ol><h1 id="通过已经可以科学上网的电脑实现科学上网"><a class="anchor" href="#通过已经可以科学上网的电脑实现科学上网">#</a> 通过已经可以科学上网的电脑实现科学上网<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU5JTgwJTlBJUU4JUJGJTg3JUU1JUI3JUIyJUU3JUJCJThGJUU1JThGJUFGJUU0JUJCJUE1JUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkxJUU3JTlBJTg0JUU3JTk0JUI1JUU4JTg0JTkxJUU1JUFFJTlFJUU3JThFJUIwJUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkx"></span></h1><p>也就是说，如果你有一台设备通过上述的方法之一实现了科学上网，那么你就可以借助那台设备轻松地让其它和那台设备<strong>属于同一局域网的设备</strong>实现科学上网。比如你的实体机（如 Windows）实现了科学上网，那么对于你的 kali 虚拟机你就没必要想尽各种办法让它与你的实体机进行类似的配置以实现科学上网。具体方法如下：</p><p>前提条件：和可以科学上网的主机处于<strong>同一局域网</strong></p><p>实验环境：主机 Windows10 （已实现科学上网），虚拟机 Kali Linux（需要实现科学上网），对于虚拟机 Kali，我使用了两个网卡，<strong>网络地址转换</strong>和<strong>仅主机网络</strong>，前者保证能连上 Internet，后者保证让 主机和虚拟机处于同一局域网（网段为 192.168.56.0/24）</p><p>实现步骤（以<br>SSR 为例）：</p><ol><li><p>配置主机的</p><p>SSR 客户端，使其<strong>允许来自局域网的连接</strong>。于我而言，我是这么设置的：<strong>右键小飞机 -&gt; 选项设置 -&gt; 勾选来自局域网的连接</strong></p></li><li><p>在虚拟机中，配置 FireFox 浏览器中的网络代理或系统代理，选择手动代理，在所有代理中填入主机的</p><p>IP 地址和其默认的端口（我的是 <code>192.168.56.100</code> 和 <code>1080</code> ）</p></li><li><p>完成</p></li></ol><h1 id="链接"><a class="anchor" href="#链接">#</a> 链接<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU5JTkzJUJFJUU2JThFJUE1"></span></h1><p>下面总结了本文中使用的所有链接：</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9yb3hoYWl5LndvcmRwcmVzcy5jb20vMjAxNy8wOC8wNC80MzAv">CentOS 7 配置 shadowsocks-libev 服务器端进行科学上网 | 鸣沙山侧 月牙泉畔</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUG9saXBv">Polipo - Wikipedia</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zaGFkb3dzb2Nrcy5vcmcvZW4vc3BlYy9JbXBsZW1lbnRhdGlvbnMuaHRtbA==">Shadowsocks - Implementations</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2JyZWFrd2ExMS9nZndfd2hpdGVsaXN0">breakwa11/gfw_whitelist: gfw_whitelist</span></li><li><span class="exturl" data-url="aHR0cDovL3dzeHExMi41NTU1NS5pby9LYWxpLUxpbnV4JUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkxL2J3ZyVFNCVCOCVCQiVFNiU5QyVCQSVFNCVCRiVBMSVFNiU4MSVBRiVFNyU5NSU4QyVFOSU5RCVBMi5wbmc=">bwg</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvZG5zMnNvY2tzLw==">dns2socks</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYXduMW0vb3ZlcnR1cmU=">overture</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYWRvd3NvY2tzL3NoYWRvd3NvY2tzLXF0NQ==">shadowsocks-qt5</span></li><li><span class="exturl" data-url="aHR0cDovL3dzeHExMi41NTU1NS5pby9LYWxpLUxpbnV4JUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkxL3NzLXF0NSVFNCVCOCVCQiVFNyU5NSU4QyVFOSU5RCVBMi5wbmc=">ss-qt5</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9zb3VyY2Vmb3JnZS5uZXQvcHJvamVjdHMvdHNvY2tzL2ZpbGVzL3Rzb2Nrcy8=">tsocks 下载链接</span></li><li><span class="exturl" data-url="aHR0cDovL3Rzb2Nrcy5zb3VyY2Vmb3JnZS5uZXQv">tsocks 官网</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9saW51eC5kaWUubmV0L21hbi84L3Rzb2Nrcw==">tsocks 手册</span></li><li><span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvJUU0JUJCJUEzJUU3JTkwJTg2JUU4JTg3JUFBJUU1JThBJUE4JUU5JTg1JThEJUU3JUJEJUFF">代理自动配置 - 维基百科，自由的百科全书</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTkvMDcvMDcvJUU3JUE3JTkxJUU1JUFEJUE2JUU0JUI4JThBJUU3JUJEJTkx">科学上网</span></li><li><span class="exturl" data-url="aHR0cDovL2hlbmd5dW5hYmMuZ2l0aHViLmlvL3NvbWV0aGluZy1hYm91dC1zY2llbmNlLXN1cmYtdGhlLWludGVybmV0Lw==">科学上网的一些原理 | 横云断岭的专栏</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZlbGlzQ2F0dXMvU3dpdGNoeU9tZWdhL2lzc3Vlcy85NjMjaXNzdWVjb21tZW50LTI3MDA1NTIyMQ==">请问在设置 http/https 代理后 DNS 的解析还是通过 proxy 吗？</span></li></ul><h1 id="缩略语"><a class="anchor" href="#缩略语">#</a> 缩略语<span class="exturl" data-url="aHR0cHM6Ly93c3hxMi41NTU1NS5pby9ibG9nLzIwMTgvMTAvMjAvS2FsaS1MaW51eCVFNyVBNyU5MSVFNSVBRCVBNiVFNCVCOCU4QSVFNyVCRCU5MS8jJUU3JUJDJUE5JUU3JTk1JUE1JUU4JUFGJUFE"></span></h1><ul><li><strong>ARM</strong>: Advanced RISC Machines</li><li><strong>CPU</strong>: Central Processing Unit</li><li><strong>CST</strong>: China Standard Time</li><li><strong>DNS</strong>: Domain Name System</li><li><strong>FTP</strong>: File Transfer Protocol</li><li><strong>GFW</strong>: Great Firewall</li><li><strong>HTTP</strong>: Hypertext Transfer Protocol</li><li><strong>HTTPS</strong>: HTTP Secure</li><li><strong>IP</strong>: Internet Protocol</li><li><strong>JSON</strong>: JavaScript Object Notation</li><li><strong>KB</strong>: Kilobyte</li><li><strong>MB</strong>: Megabyte</li><li><strong>MIPS</strong>: Microprocessor without Interlocked Pipeline Stages</li><li><strong>OS</strong>: Operating System</li><li><strong>PAC</strong>: Proxy auto-config</li><li><strong>PC</strong>: Personal Computer</li><li><strong>PID</strong>: Process ID</li><li><strong>POSIX</strong>: Portable Operating System Interface, formerly IEEE-IX</li><li><strong>SOCKS</strong>: SOCKetS</li><li><strong>SS</strong>: shadowsocks</li><li><strong>SSL</strong>: Secure Socket Layer</li><li><strong>SSR</strong>: shadowsocksr</li><li><strong>TCP</strong>: Transmission Control Protocol</li><li><strong>UDP</strong>: User Datagram Protocol</li><li><strong>URL</strong>: Uniform Resource Locator</li><li><strong>VPS</strong>: Virtual Processing System</li><li><strong>WPAD</strong>: Web Proxy Autodiscovery Protocol</li></ul></div><footer><div class="meta"><span id="2021/8/Kali Linux科学上网/" class="item leancloud_visitors" data-flag-title="转载-Kali Linux科学上网" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>黑麋鹿 <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://sirliu.github.io/2021/8/Kali%20Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" title="转载-Kali Linux科学上网">https://sirliu.github.io/2021/8/Kali Linux科学上网/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/8/Panda%E6%A0%B8%E5%BF%83%E7%A8%8B%E5%BA%8F%E8%AE%BE%E7%BD%AE%E6%88%90%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pics.sirliu.top:4433&#x2F;?id&#x3D;949784" title="Panda核心程序设置成开机自动运行"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> VPN</span><h3>Panda核心程序设置成开机自动运行</h3></a></div><div class="item right"><a href="/2021/8/%E5%8D%8E%E4%B8%BAHisuite%E5%A4%87%E4%BB%BD%E8%A7%A3%E5%AF%86/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pics.sirliu.top:4433&#x2F;?id&#x3D;630798" title="华为Hisuite备份解密"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 手机</span><h3>华为Hisuite备份解密</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ss"><span class="toc-number">1.</span> <span class="toc-text">SS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#shadowsocks-qt5"><span class="toc-number">1.1.</span> <span class="toc-text">shadowsocks-qt5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#features"><span class="toc-number">1.1.2.</span> <span class="toc-text">Features</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.3.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.4.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.1.5.</span> <span class="toc-text">设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%96"><span class="toc-number">1.1.6.</span> <span class="toc-text">优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shadowsocks-libev"><span class="toc-number">1.2.</span> <span class="toc-text">shadowsocks-libev</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="toc-number">1.2.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-2"><span class="toc-number">1.2.2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-2"><span class="toc-number">1.2.3.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6"><span class="toc-number">1.2.4.</span> <span class="toc-text">控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97"><span class="toc-number">1.2.5.</span> <span class="toc-text">查看日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%BB%AD%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.2.6.</span> <span class="toc-text">后续步骤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ssr"><span class="toc-number">2.</span> <span class="toc-text">SSR</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#shadowsocksrpython-%E7%89%88"><span class="toc-number">2.1.</span> <span class="toc-text">shadowsocksr（Python 版）（</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-3"><span class="toc-number">2.1.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-3"><span class="toc-number">2.1.2.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8"><span class="toc-number">2.1.3.</span> <span class="toc-text">启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">2.1.4.</span> <span class="toc-text">测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">2.1.5.</span> <span class="toc-text">自动化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%BB%AD%E6%AD%A5%E9%AA%A4-2"><span class="toc-number">2.1.6.</span> <span class="toc-text">后续步骤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pc-%E8%BF%9E%E6%8E%A5%E5%88%B0ssr-local"><span class="toc-number">3.</span> <span class="toc-text">PC 连接到 SSR Local</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86"><span class="toc-number">3.1.</span> <span class="toc-text">浏览器全局代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86"><span class="toc-number">3.2.</span> <span class="toc-text">系统全局代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9C%9F%E7%B3%BB%E7%BB%9F%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86"><span class="toc-number">3.3.</span> <span class="toc-text">真・系统全局代理（透明代理）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87-socks-%E4%BB%A3%E7%90%86%E8%BF%9B%E8%A1%8C-dns-%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.4.</span> <span class="toc-text">通过 SOCKS 代理进行 DNS 查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2-socks-%E4%BB%A3%E7%90%86%E4%B8%BA-http-%E4%BB%A3%E7%90%86"><span class="toc-number">3.5.</span> <span class="toc-text">转换 SOCKS 代理为 HTTP 代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E4%BB%A3%E7%90%86"><span class="toc-number">3.6.</span> <span class="toc-text">浏览器自动代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pac%E4%BB%A3%E7%90%86%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">3.7.</span> <span class="toc-text">PAC（代理自动配置）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E7%BB%88%E7%AB%AF%E4%B8%8B%E7%9A%84%E4%BB%A3%E7%90%86%E8%AE%BE%E7%BD%AE"><span class="toc-number">3.8.</span> <span class="toc-text">关于终端下的代理设置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">3.8.1.</span> <span class="toc-text">终端代理环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%BB%A3%E7%90%86%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0"><span class="toc-number">3.8.2.</span> <span class="toc-text">使用程序的代理相关参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%B7%B2%E7%BB%8F%E5%8F%AF%E4%BB%A5%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E7%9A%84%E7%94%B5%E8%84%91%E5%AE%9E%E7%8E%B0%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91"><span class="toc-number">4.</span> <span class="toc-text">通过已经可以科学上网的电脑实现科学上网</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%93%BE%E6%8E%A5"><span class="toc-number">5.</span> <span class="toc-text">链接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%A9%E7%95%A5%E8%AF%AD"><span class="toc-number">6.</span> <span class="toc-text">缩略语</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2021/8/Linux%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86/" rel="bookmark" title="Linux设置全局代理">Linux设置全局代理</a></li><li><a href="/2021/8/Panda%E6%A0%B8%E5%BF%83%E7%A8%8B%E5%BA%8F%E8%AE%BE%E7%BD%AE%E6%88%90%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/" rel="bookmark" title="Panda核心程序设置成开机自动运行">Panda核心程序设置成开机自动运行</a></li><li class="active"><a href="/2021/8/Kali%20Linux%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" rel="bookmark" title="转载-Kali Linux科学上网">转载-Kali Linux科学上网</a></li><li><a href="/2021/10/PandaVPN%E5%90%8E%E7%AB%AF%E6%9B%BF%E6%8D%A2/" rel="bookmark" title="PandaVPN后端替换与搭建">PandaVPN后端替换与搭建</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="黑麋鹿" data-src="/images/avatar.jpg"><p class="name" itemprop="name">黑麋鹿</p><div class="description" itemprop="description">折腾之路</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">175</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">34</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">86</span> <span class="name">标签</span></a></div></nav><div class="social"><a href="https://github.com/sirliu" title="https:&#x2F;&#x2F;github.com&#x2F;sirliu" class="item github" rel="noopener" target="_blank"><i class="ic i-github"></i></a> <a href="https://twitter.com/" title="https:&#x2F;&#x2F;twitter.com&#x2F;" class="item twitter" rel="noopener" target="_blank"><i class="ic i-twitter"></i></a> <a href="https://www.zhihu.com/" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;" class="item zhihu" rel="noopener" target="_blank"><i class="ic i-zhihu"></i></a> <a href="https://music.163.com/" title="https:&#x2F;&#x2F;music.163.com&#x2F;" class="item music" rel="noopener" target="_blank"><i class="ic i-cloud-music"></i></a> <a href="https://weibo.com/" title="https:&#x2F;&#x2F;weibo.com&#x2F;" class="item weibo" rel="noopener" target="_blank"><i class="ic i-weibo"></i></a> <a href="mailto:yourname@mail.com" title="mailto:yourname@mail.com" class="item email" rel="noopener" target="_blank"><i class="ic i-envelope"></i></a> <a href="https://www.facebook.com/" title="https:&#x2F;&#x2F;www.facebook.com&#x2F;" class="item facebook" rel="noopener" target="_blank"><i class="ic i-facebook"></i></a> <a href="https://stackoverflow.com/" title="https:&#x2F;&#x2F;stackoverflow.com&#x2F;" class="item stackoverflow" rel="noopener" target="_blank"><i class="ic i-stack-overflow"></i></a> <a href="https://www.youtube.com/" title="https:&#x2F;&#x2F;www.youtube.com&#x2F;" class="item youtube" rel="noopener" target="_blank"><i class="ic i-youtube"></i></a> <a href="https://instagram.com/" title="https:&#x2F;&#x2F;instagram.com&#x2F;" class="item instagram" rel="noopener" target="_blank"><i class="ic i-instagram"></i></a> <a href="skype:yourname?call|chat" title="skype:yourname?call|chat" class="item skype" rel="noopener" target="_blank"><i class="ic i-skype"></i></a> <a href="https://www.douban.com/" title="https:&#x2F;&#x2F;www.douban.com&#x2F;" class="item douban" rel="noopener" target="_blank"><i class="ic i-douban"></i></a></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/8/Panda%E6%A0%B8%E5%BF%83%E7%A8%8B%E5%BA%8F%E8%AE%BE%E7%BD%AE%E6%88%90%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/8/%E5%8D%8E%E4%B8%BAHisuite%E5%A4%87%E4%BB%BD%E8%A7%A3%E5%AF%86/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">黑麋鹿 @ Black Elk</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">689k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">10:26</span></div><div class="powered-by">基于 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & Theme.<a href="https://github.com/amehime/hexo-theme-shoka" rel="noopener" target="_blank">Shoka</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/8/Kali Linux科学上网/",favicon:{show:"BlackELK",hide:"看看再走吧"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->